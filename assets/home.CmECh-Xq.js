import"./pixel.PHV1U_RE.js";import{e as y,c as m,z as Y,x as P,v as _,w as Z,b as n,A as J,B as K,u as X,d as ee}from"./scc.CxjgMzkA.js";import{M as f}from"./bootstrap.esm.CkDf0L-y.js";const g=document.getElementById("scc-one-modal");let S={},A=null,q=null;const te=new URLSearchParams(window.location.search),D=te.get("modelName"),V={"Sample DB":"fas fa-database","Supply Planning":"fas fa-database"};function le(t,e){let a=t.replace(/\s/g,"_"),o=n("div","accordion-item border-light mb-0",null,n("h2","accordion-header",a+"_head",n("button","accordion-button collapsed",null,n("span","h6 mb-0 font-weight-bold",null,document.createTextNode(t)))));o.querySelector("button").setAttribute("type","button"),o.querySelector("button").setAttribute("data-bs-toggle","collapse"),o.querySelector("button").setAttribute("aria-expanded","false"),o.querySelector("button").setAttribute("data-bs-target","#"+a),o.querySelector("button").setAttribute("aria-controls",a);let d=n("div","accordion-collapse collapse",a,n("div","accordion-body",null,n("table","table table-hover",null,n("tbody",null,null,null))));d.setAttribute("aria-labelledby",a+"_head"),d.setAttribute("data-bs-parent","#tableGroup");for(let l of e){let i=n("tr",null,null,n("td",null,null,document.createTextNode(l[1])));i.onclick=function(){const c=document.getElementById("availableModal").querySelector("li.selectedValue");window.open(`./tableDisplay.html?tableName=${l[0]}&modelName=${c.innerText}`)},i.setAttribute("tableName",l[0]),d.querySelector("tbody").appendChild(i)}return o.appendChild(d),o}document.addEventListener("DOMContentLoaded",async function(){let t=await y("init");if(!t||t.msg!="Success"){m("Alert!","Some error occured while initializing sqlite.");return}if(D){await Y("/home/get-attached-model",{modelName:D});const o=window.location.origin+window.location.pathname;history.replaceState(null,"",o)}setTimeout(ne,400);const e=document.getElementById("shareBtn");e.classList.add("blink"),document.querySelectorAll(".modal").forEach(o=>{f.getInstance(o)||new f(o)}),document.getElementById("modal-createView").addEventListener("hide.bs.modal",function(){document.getElementById("viewName").value="",document.getElementById("query-input").value=""}),document.getElementById("editorBtn").onclick=async function(){const o=document.getElementById("availableModal").querySelector("li.selectedValue").innerText;if(!o){m("Alert!","Please select a model");return}window.open(`./playground/client.html?modelName=${o}`)},document.getElementById("availInpFiles").onclick=function(){document.getElementById("modal-input-files").querySelector("h2").innerText="Input Files",L()},document.getElementById("availOutFiles").onclick=function(){document.getElementById("modal-input-files").querySelector("h2").innerText="Output Files",_e()},document.getElementById("shareBtn").onclick=function(){const o=document.getElementById("availableModal").querySelector("li.selectedValue");if(!o){m("Alert!","Please select a model");return}const d=o.innerText,l=o.getAttribute("project");window.open(`./editorPage.html?projectName=${l}&modelName=${d}`)},document.getElementById("closeOutput").onclick=function(){document.getElementById("outputDiv").style.display="none"},document.getElementById("ok-view").onclick=fe,document.getElementById("deleteModel").onclick=H.bind(null,!0),document.getElementById("removeModel").onclick=H.bind(null,!1),document.getElementById("addNew").onclick=ae.bind(null,"Add New Model",!1),document.getElementById("downloadAllFiles").onclick=we,document.getElementById("addExisting").onclick=de,document.getElementById("saveAs").onclick=ie,document.getElementById("uploadModel").onclick=ce,document.getElementById("downloadModel").onclick=se,document.getElementById("uploadExcel").onclick=re,document.getElementById("downloadExcel").onclick=me,document.getElementById("vacuum").onclick=pe,document.getElementById("saveFiles").onclick=ge,document.getElementById("uploadPackage").onclick=Te,document.getElementById("downloadOutput").onclick=ve,await P("init","editor"),e.classList.remove("blink")});async function ne(){document.getElementById("tableGroup").innerHTML="";let t=await _("home","getUserModels");if(t.length==0){let e=await Z();e.length>0&&t.push(e)}return oe(t),t}function oe(t){let e=document.getElementById("availableModal");e.innerHTML="";for(let a of t)e.appendChild(N(a));D&&e.lastChild?e.lastChild.click():e.firstChild&&e.firstChild.click()}function N(t){let e=n("li","nav-item mb-0",null,null),a=n("a","nav-link p-2 rounded-0");return a.appendChild(n("span","d-block text-left",null,null)),a.firstChild.appendChild(n("span",`${V[t[1]]} pe-2`)),a.firstChild.appendChild(document.createTextNode(t[0])),e.appendChild(a),e.setAttribute("project",t[2]),e.setAttribute("template",t[1]),e.setAttribute("dbtype",t[3]),e.onclick=async function(o){if(e.getAttribute("project"),document.getElementById("outputTxt").innerHTML="",!this.classList.contains("selectedValue")){await _("home","getVersion",{model_name:this.innerText})!=="1.0.4"&&await _("home","upgradeVersion",{modelName:this.innerText,version:"1.0.4"});for(let l of this.parentNode.querySelectorAll("li.selectedValue"))l.classList.remove("selectedValue");M(this.innerText,t[1]),this.classList.add("selectedValue"),o.preventDefault()}await he(this.innerText)},e}async function M(t,e){document.getElementById("tableGroup").innerHTML="";const a=await _("home","fetchTableGroups",{model_name:t});for(let o in a)document.getElementById("tableGroup").appendChild(le(o,a[o]))}function $(t,e="fa-server",a=null){let o=n("ul","tree");for(let d in t){o.appendChild(document.createElement("li"));let l=R(d,e);o.appendChild(l),l.onclick=function(){let i=l.nextElementSibling;if(l.firstChild.checked){l.firstChild.checked=!1;for(let c of i.childNodes)c.firstChild.checked&&(c.firstChild.checked=!1)}else{l.firstChild.checked=!0;for(let c of i.childNodes)c.firstChild.checked||(c.firstChild.checked=!0)}},o.appendChild(n("ul","childList TreeMembers"));for(let i of t[d]){let c=R(i[0],V[i[1]]);a||(c.onclick=function(s){if(c.firstChild.checked)c.firstChild.checked=!1,l.firstChild.checked&&(l.firstChild.checked=!1);else{c.firstChild.checked=!0,l.firstChild.checked=!0;for(let r of this.parentNode.childNodes)r.firstChild.checked||(l.firstChild.checked=!1)}}),o.lastChild.appendChild(c)}}return n("div","card-body scc-box",null,o)}function R(t,e){let a=n("li",null,null,n("input","inputcheckbox"));a.firstChild.setAttribute("type","checkbox");let o=n("label","checkBox-label",null,n("span",`fas ${e}`));return o.appendChild(document.createTextNode(t)),a.appendChild(o),a}function E(t,e){const a=g.querySelector(".modal-header h2");a.innerHTML="",a.innerText=t;const o=g.querySelector(".modal-body");o.innerHTML="";const d=g.querySelector(".modal-footer");d.innerHTML="";const l=n("button","btn btn-tertiary",null,document.createTextNode("Cancel"));l.setAttribute("type","button"),l.setAttribute("data-bs-dismiss","modal");const i=n("button","btn btn-primary ml-auto",null,document.createTextNode(e));return i.setAttribute("type","button"),d.appendChild(l),d.appendChild(i),[o,i]}function B(t,e,a,o,d=[],l="",i="",c="text"){let s;const r=n("div","row row-header align-items-center mb-4",t);let u=n("div","col-12 col-sm-4 align-self-center",null,n("label","my-2",null,document.createTextNode(e)));if(s=n("div","col-12 col-sm"),o=="select"){const p=n("select","form-select",a);(d.includes("Default")||d.length==0)&&p.appendChild(n("option",null,null,document.createTextNode("Default")));for(let h of d)if(h!="Default"){let b=n("option",null,null,document.createTextNode(h));p.appendChild(b)}p.firstChild&&(p.firstChild.setAttribute("selected",""),s.appendChild(p))}else{const p=n("div","input-group",null,n("input","form-control",a));p.firstChild.setAttribute("type",c),p.firstChild.setAttribute("placeholder",l),i.trim()!=""&&p.appendChild(n("span","input-group-text",null,n("span",i))),s.appendChild(p)}return r.appendChild(u),r.appendChild(s),r}function ae(t,e=!1){const[a,o]=E(t,"Add"),d=n("div","form-group");d.appendChild(B("name_div","Model Name","db_name","normal",[],"","fas fa-database")),e?d.appendChild(B("path_div","Model Path","db_path","normal")):d.appendChild(B("template_div","Model Template","model_template","select",["Sample DB"])),a.appendChild(d),o.onclick=async function(l){const i=document.getElementById("db_name").value;if(i.trim()==""||!W(i)){m("Alert!","Please enter valid model name");return}for(let b of document.getElementById("availableModal").querySelectorAll("li"))if(i.trim()==b.innerText){m("Alert!",`Model already active with same name ${i}`);return}let c=document.getElementById("model_template"),s="Sample DB";c&&(s=c.value);let r="Default";f.getInstance(g).hide();const h=await _("home","addNewModel",{model_name:i,model_template:s,project_name:r,db_user:"",password:"",host:"",port:0,db_type:"SQLITE"});if(h.msg==="Success"){let b=document.getElementById("availableModal");b.appendChild(N([i,s,r,"SQLITE"])),b.lastChild.click(),m("Success!","New Model added")}else m("Alert!",h.msg)}}async function de(){const[t,e]=E("Add Existing Models","Add"),a=new Object,o=await _("home","getExistingModels");let d=new Object;for(let l of o){let i=l[1],c=l[0];a[c]=[i,l[2],l[3]],i in d?d[i].push([c,l[2]]):d[i]=[[c,l[2]]]}t.appendChild($(d)),e.onclick=async function(){let l=[];for(let s of document.getElementById("availableModal").querySelectorAll("li"))l.push(s.innerText);let i={},c=[];for(let s of t.querySelectorAll(".TreeMembers li"))if(s.parentNode.classList.contains("childList")&&s.firstChild.checked){if(l.includes(s.innerText)){m("Alert!",`Model Already Active with name ${s.innerText}`);return}let r=s.parentNode.previousElementSibling.innerText;if(r in i||(i[r]=[]),i[r].push(s.innerText),c.includes(s.innerText)){m("Alert!","You Cannot Add more than one model of same name");return}c.push(s.innerText)}if(Object.keys(i).length>0){f.getInstance(g).hide(),await _("home","addExistingModels",{model_list:c,projects_dict:i});let r=document.getElementById("availableModal");for(let u of c)r.appendChild(N([u,a[u][1],a[u][0],a[u][2]]))}else f.getInstance(g).hide()}}function H(t){let e="Hide",a="Hide Models";t&&(e="Delete",a="Delete Models");const[o,d]=E(a,e);let l=new Object;for(let i of document.getElementById("availableModal").childNodes){let c=i.getAttribute("project"),s=i.getAttribute("template"),r=i.innerText;c in l?l[c].push([r,s]):l[c]=[[r,s]]}o.appendChild($(l)),d.onclick=async function(){let i=[],c={};for(let s of o.querySelectorAll(".TreeMembers li"))if(s.parentNode.classList.contains("childList")&&s.firstChild.checked){i.push(s.innerText);let r=s.parentNode.previousElementSibling.innerText;r in c||(c[r]=[]),c[r].push(s.innerText)}if(Object.keys(c).length>0){f.getInstance(g).hide(),await _("home","deleteModel",{projects_dict:c,del_opt:t});let r=document.getElementById("availableModal");for(let u of r.querySelectorAll("li"))i.indexOf(u.innerText)>-1&&u.remove();r.firstChild?r.firstChild.click():document.getElementById("tableGroup").innerHTML="",m("Success!","Model removed successfully")}else m("Alert!","Please select atleast one model")}}function ie(t){const e=document.getElementById("availableModal").querySelector("li.selectedValue");if(!e){m("Alert!","Please select a model");return}if(e.getAttribute("dbtype")!="SQLITE"){m("Alert!","Method is applicable only for SQLITE type models");return}else{const a=e.innerText,o=e.getAttribute("project"),d=e.getAttribute("template"),l=e.getAttribute("dbtype"),[i,c]=E("Save As","Save"),s=n("div","form-group mb-4");s.appendChild(B("new_modelName_div","New Model Name","new_model_name","normal",[],"","fas fa-database")),i.appendChild(s),c.onclick=async function(r){const u=document.getElementById("new_model_name").value;if(u.trim()==""||!W(u)){m("Alert!","Please enter valid model name");return}for(let I of document.getElementById("availableModal").querySelectorAll("li"))if(u.trim()==I.innerText){m("Alert!",`Model already active with same name ${u}`);return}f.getInstance(g).hide();const h=await _("home","saveAsModel",{new_model_name:u,new_model_template:d,project_name:o,model_name:a});if(h.message.indexOf("Invalid")>-1){m("Alert",h.message);return}let b=document.getElementById("availableModal");b.appendChild(N([u,d,o,l])),b.lastChild.click(),m("Success!","Save As Model added")}}}function ce(t){const e=document.getElementById("availableModal").querySelector("li.selectedValue");if(!e){m("Alert!","Please select a model");return}const a=e.innerText;e.getAttribute("template");const[o,d]=E("Restore Model","Upload"),l=n("input","form-control"),i=n("div","input-group",null,l);l.setAttribute("type","file"),l.setAttribute("accept",".db, .sqlite3"),o.appendChild(i),d.onclick=async function(c){l.files[0]?(d.setAttribute("disabled",""),d.innerHTML='<span class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span>',await J("home","uploadModel",l.files[0],{model_name:a}),l.value=null,d.removeAttribute("disabled",""),d.innerHTML="Upload",f.getInstance(g).hide(),m("Success!","Model uploaded successfully"),M(a)):m("Alert!","Please choose a model")}}async function se(t){let e=document.getElementById("data-loader");const a=document.getElementById("availableModal").querySelector("li.selectedValue");if(!a){m("Alert!","Please select a model");return}const o=a.innerText,d=a.getAttribute("project");e.style.display="",await _("home","downloadModel",{model_name:o,project_name:d}),e.style.display="none"}function re(t){const e=document.getElementById("availableModal").querySelector("li.selectedValue");if(!e){m("Alert!","Please select a model");return}const a=e.innerText,[o,d]=E("Upload Excel","Upload"),l=n("input","form-control"),i=n("div","input-group",null,l);l.setAttribute("type","file"),l.setAttribute("accept","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"),o.appendChild(i),d.onclick=async function(c){A=l.files[0],A?(d.setAttribute("disabled",""),d.innerHTML='<span class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span>',S={},S=await K(a,[],A),f.getInstance(document.getElementById("scc-one-modal")).hide(),new f(document.getElementById("modal-uploadExcel-info")).show(),l.value=null,d.innerHTML="Upload",d.removeAttribute("disabled","")):m("Alert!","Please choose a file")}}document.getElementById("modal-uploadExcel-info").addEventListener("show.bs.modal",function(){const t=this.querySelector(".modal-body");t.innerHTML="";const e=n("tr"),a=n("div","form-group",null,n("table","table table-bordered table-sm",null,n("thead",null,null,e)));a.style.maxHeight="300px",a.style.overflowY="auto",e.appendChild(n("td","text-center",null,n("h6","m-0",null,document.createTextNode("Sheet Name")))),e.appendChild(n("td","text-center",null,n("h6","m-0",null,document.createTextNode("Upload Option"))));const o=n("tbody");a.firstChild.appendChild(o),t.appendChild(a);for(let d in S){let l=n("tr","");l.appendChild(n("td",null,null,document.createTextNode(d)));const i=n("select","form-select");i.style="line-height:1 !important;";const c=[{value:"purgeAndUpload",text:"Purge and Upload"},{value:"createAndUpload",text:"Drop Table and Upload"},{value:"ignore",text:"Ignore"}],s=[{value:"ignore",text:"Ignore"},{value:"createAndUpload",text:"Create and Upload"}];S[d][0]==="New"?s.forEach(u=>{const p=n("option");p.value=u.value,p.textContent=u.text,i.appendChild(p)}):c.forEach(u=>{const p=document.createElement("option");p.value=u.value,p.textContent=u.text,u.value=="ignore"&&S[d][1]!="Input"&&p.setAttribute("Selected",""),i.appendChild(p)});let r=n("td","text-center",null,i);l.appendChild(r),o.appendChild(l)}});document.getElementById("saveFileName").onclick=async function(){this.setAttribute("disabled",""),this.innerHTML='<span class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span>';const t=document.getElementById("availableModal").querySelector("li.selectedValue"),e=t.innerText;t.getAttribute("template");const a=document.getElementById("modal-uploadExcel-info").querySelector("tbody"),o={};for(let l of a.querySelectorAll("tr")){const i=l.firstElementChild.innerText,c=l.querySelector("select").value;o[i]=c}const d=await X(e,Object.keys(o),A,o);f.getInstance(document.getElementById("modal-uploadExcel-info")).hide(),m("Success!","Excel uploaded successfully"),ue(d,o),M(e),this.innerText="Upload",this.removeAttribute("disabled")};function ue(t,e){const[a,o]=E("Status","OK"),d=n("tr",null,null,n("td",null,null,document.createTextNode("SheetName"))),l=n("div","form-group mb-4",null,n("table","table table-bordered table-sm",null,n("thead",null,null,d)));l.style.maxHeight="300px",l.style.overflowY="auto",l.style.overflowX="auto",d.appendChild(n("td",null,null,document.createTextNode("Status"))),d.appendChild(n("td",null,null,document.createTextNode("Msg")));const i=n("tbody");l.firstChild.appendChild(i);for(let c in t){let s=n("tr");s.appendChild(n("td",null,null,document.createTextNode(c)));let r,u;!isNaN(t[c])&&e[c]=="createAndUpload"?(r="Create And Uploaded",u=`${t[c]} rows inserted`):isNaN(t[c]&&e[c]=="purgeAndUpload")?(r="Errored",u=t[c]):(r="Purge And Uploaded",u=`${t[c]} rows inserted`),s.appendChild(n("td",null,null,document.createTextNode(r))),s.appendChild(n("td",null,null,document.createTextNode(u))),i.appendChild(s)}a.appendChild(l),new f(document.getElementById("scc-one-modal")).show(),o.onclick=function(){f.getInstance(g).hide()}}function me(t){const e=document.getElementById("availableModal").querySelector("li.selectedValue");if(!e){m("Alert!","Please select a model");return}const a=[];for(let s of document.getElementById("tableGroup").querySelectorAll("button.accordion-button"))a.push(s.innerText);const o=e.innerText,[d,l]=E("Download Excel","Download"),i=n("input","form-check-input round-check"),c=n("div","form-check",null,i);i.setAttribute("type","checkbox"),i.checked=!0,c.appendChild(n("label","form-check-label",null,document.createTextNode("Input Tables Only")));for(let s of a){let r=c.cloneNode(!0);r.lastChild.innerText=s,d.appendChild(r)}l.onclick=async function(s){let r=[];for(let h of d.querySelectorAll("input:checked"))r.push(h.parentNode.lastChild.innerText);f.getInstance(g).hide();let p=document.getElementById("dl_progress_div");p.querySelector("div").innerText="Downloading",p.style.display="",await ee(o,[],r),p.querySelector("div").innerText="Running",p.style.display="none"}}async function pe(t){let e=document.getElementById("data-loader");const a=document.getElementById("availableModal").querySelector("li.selectedValue");if(!a){m("Alert!","Please select a model");return}const o=a.innerText;e.style.display="",await y("executeQuery",o,"VACUUM"),e.style.display="none",m("Success!","Model vacuumed successfully")}async function fe(){const t=document.getElementById("viewName").value,e=document.getElementById("query-input").value,a=document.getElementById("availableModal").querySelector("li.selectedValue").innerText;if(!a){m("Alert!","Please select a model");return}(t.trim()==""||e.trim()=="")&&m("Alert!","Please make sure that View Name and Query was entered"),await _("home","checkOrCreateView",{view_name:t,view_query:e,model_name:a,isExist:!1}),f.getInstance(document.getElementById("modal-createView")).hide(),m("Success","View created successfully"),M(a)}function W(t){var e=/^[a-zA-Z0-9_]+$/;return e.test(t)}function ye(t){const e=document.getElementById("outputTxt");if(t){const a=document.createElement("div");a.textContent=`Error: ${t}`,a.style.color="red",e.appendChild(a)}}async function he(t){const e=document.getElementById("taskDiv");e.innerHTML="";const o=await y("fetchData",t,"SELECT TaskId,TaskName,TaskDisplayName FROM S_TaskMaster");for(const[d,l,i]of o){const c=n("li",null,null,n("a","dropdown-item",null,document.createTextNode(i)));c.onclick=async function(){const s=document.getElementById("myCanvas");document.getElementById("loadingOverlay").classList.remove("hidden"),document.getElementById("outputDiv").style.display="",document.getElementById("outputTxt").innerHTML="",q=null;const r=document.getElementById("availableModal").querySelector("li.selectedValue"),u=r.getAttribute("project"),h=await y("fetchData",r.innerText,"SELECT FilePath,FileData,FileName FROM S_ExecutionFiles WHERE FileName IS NOT NULL AND Status = 'Active' ");let b=null;h.forEach(x=>{x[0]===l&&(b=x[1])});const C=await y("fetchData",r.innerText,"SELECT FileName,FileBlob FROM S_DataFiles WHERE FileType = 'Input'"),z=await y("fetchData",r.innerText,"SELECT WheelName,WheelBlob FROM S_PackageWheels");await y("updateData",r.innerText,"UPDATE S_Taskmaster SET TaskLastRunDate = ? WHERE TaskId = ? ",[be(),d]);const O=await F(l,"Started",null,null,d);let w=await P("executeScript","editor",b,u,r.innerText,h,null,C,z);if(w.stderr)F(l,"Errored",w.stderr,O);else{if(w.blob){const x=s.getContext("2d");x.clearRect(0,0,s.width,s.height),q=w.blob;const T=await createImageBitmap(w.blob),v=Math.min(s.width/T.width,s.height/T.height),U=(s.width-T.width*v)/2,G=(s.height-T.height*v)/2;x.drawImage(T,U,G,T.width*v,T.height*v),new f(document.getElementById("modal-show-output")).show()}F(l,"Completed",null,O),w.outputFiles&&w.outputFiles.length>0&&(await y("deleteData",r.innerText,"DELETE FROM S_DataFiles WHERE FileType = 'Output'"),w.outputFiles.forEach(async([T,v])=>{await y("insertData",r.innerText,`INSERT INTO S_DataFiles (FileName,FileType,FileBlob) 
                                            VALUES (?, ?, ?) ON CONFLICT (FileName,FileType) DO UPDATE SET FileBlob = ? `,[T,"Output",v,v])}))}document.getElementById("loadingOverlay").classList.add("hidden"),ye(w.stderr)},e.appendChild(c)}}function be(){const t=new Date,e=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0"),d=String(t.getHours()).padStart(2,"0"),l=String(t.getMinutes()).padStart(2,"0"),i=String(t.getSeconds()).padStart(2,"0");return`${e}-${a}-${o} ${d}:${l}:${i}`}async function F(t,e,a=null,o=null,d=null){const l=document.getElementById("availableModal").querySelector("li.selectedValue");if(o)await y("updateData",l.innerText,`UPDATE T_TaskLogs SET TaskStatus = ?,ErrorMsg = ?, EndDate = datetime('now', 'localtime')
                     WHERE TaskName = ? AND Id = ? `,[e,a,t,o]);else return await y("insertData",l.innerText,"INSERT INTO T_TaskLogs (TaskId,TaskName,TaskStatus,EndDate) VALUES (?, ?, ?, datetime('now', 'localtime'))",[d,t,e])}async function ge(){this.setAttribute("disabled",""),this.innerHTML='<span class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span>';const t=document.getElementById("availableModal").querySelector("li.selectedValue"),e=document.getElementById("inpFiles");if(e.files.length>0){await y("executeQuery",t.innerText,"DELETE FROM S_DataFiles;",["script"]);for(const o of e.files){const d=await o.arrayBuffer();await y("insertData",t.innerText,`INSERT INTO S_DataFiles (FileName,FileType,FileBlob) 
                            VALUES (?, ?, ?) ON CONFLICT (FileName,FileType) DO UPDATE SET FileBlob = ? `,[o.name,"Input",new Uint8Array(d),new Uint8Array(d)])}this.removeAttribute("disabled",""),this.innerHTML="Upload",f.getInstance(document.getElementById("modal-upload-files")).hide(),m("Success","Files Upload Successfully.")}e.value=null}async function L(){const t=document.getElementById("modal-input-files").querySelector(".modal-body");t.innerHTML="";const e=document.getElementById("availableModal").querySelector("li.selectedValue"),o=await y("fetchData",e.innerText,"SELECT FileId,FileName FROM S_DataFiles WHERE FileType = 'Input' "),d=n("tr"),l=n("div","form-group",null,n("table","table table-bordered table-sm",null,n("thead",null,null,d)));l.style.maxHeight="300px",l.style.overflowY="auto";const i=n("tbody");l.firstChild.appendChild(i),t.appendChild(l);for(let r of o){const u=n("tr","d-flex align-items-center");u.appendChild(n("td","w-100",null,document.createTextNode(r[1])));const p=n("td","input-file-icon m-0 px-2");let h=n("span","fa fa-trash");h.onclick=Ee.bind(null,r[1],r[0]),p.appendChild(h);const b=n("td","input-file-icon m-0 px-2");let I=n("span","fa fa-download");I.onclick=Q.bind(null,r[1],r[0]),b.appendChild(I);const C=n("td","input-file-icon m-0 px-2");let k=n("span","fa fa-upload");k.onclick=j.bind(null,r[1],r[0]),C.appendChild(k),u.appendChild(p),u.appendChild(C),u.appendChild(b),i.appendChild(u)}const c=n("div","d-flex justify-content-end");let s=n("button","btn btn-primary",null,document.createTextNode("Add File"));c.appendChild(s),t.appendChild(c),s.onclick=j}async function _e(){const t=document.getElementById("modal-input-files").querySelector(".modal-body");t.innerHTML="";const e=document.getElementById("availableModal").querySelector("li.selectedValue"),o=await y("fetchData",e.innerText,"SELECT FileId,FileName FROM S_DataFiles WHERE FileType = 'Output' "),d=n("tr"),l=n("div","form-group",null,n("table","table table-bordered table-sm",null,n("thead",null,null,d)));l.style.maxHeight="300px",l.style.overflowY="auto";const i=n("tbody");l.firstChild.appendChild(i),t.appendChild(l);for(let c of o){const s=n("tr","d-flex align-items-center");s.appendChild(n("td","w-100",null,document.createTextNode(c[1])));const r=n("td","input-file-icon m-0 px-2");let u=n("span","fa fa-download");u.onclick=Q.bind(null,c[1],c[0]),r.appendChild(u),s.appendChild(r),i.appendChild(s)}}async function Ee(t,e){const a=document.getElementById("availableModal").querySelector("li.selectedValue");await y("deleteData",a.innerText,"DELETE FROM S_DataFiles WHERE FileType = 'Input' AND FileId = ? AND FileName = ? ",[e,t]),L()}async function Q(t,e){let a=document.getElementById("modal-input-files").querySelector("h2").innerText.indexOf("Input")>-1?"Input":"Output";const o=document.getElementById("availableModal").querySelector("li.selectedValue"),l=await y("fetchData",o.innerText,"SELECT FileName,FileBlob FROM S_DataFiles WHERE FileType = ? AND FileID = ? AND FileName = ?",[a,e,t]);if(l){const c=new Blob([l[0][1]]);if(window.navigator&&window.navigator.msSaveOrOpenBlob){window.navigator.msSaveOrOpenBlob(c);return}const s=window.URL.createObjectURL(c);var i=document.createElement("a");i.href=s,i.download=t,i.click(),setTimeout(function(){window.URL.revokeObjectURL(s)},1e3)}else m("Alert!","No File Exists")}function j(t=null,e=null){f.getInstance(document.getElementById("modal-input-files")).hide();const a=document.getElementById("availableModal").querySelector("li.selectedValue"),[o,d]=E("Upload Excel","Upload"),l=n("input","form-control"),i=n("div","input-group",null,l);l.setAttribute("type","file"),o.appendChild(i),d.onclick=async function(c){if(l.files[0]){d.setAttribute("disabled",""),d.innerHTML='<span class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span>';const s=await l.files[0].arrayBuffer();t&&e?await y("updateData",a.innerText,"UPDATE S_DataFiles SET FileBlob = ? WHERE FileType = 'Input' AND FileName = ? AND FileId = ? ",[l.files[0].name,new Uint8Array(s),t,e]):await y("insertData",a.innerText,"INSERT INTO S_DataFiles (FileName,FileType,FileBlob) VALUES (?, ?, ?) ON CONFLICT (FileName,FileType) DO UPDATE SET FileBlob = ?",[l.files[0].name,"Input",new Uint8Array(s),new Uint8Array(s)]),f.getInstance(document.getElementById("scc-one-modal")).hide(),new f(document.getElementById("modal-input-files")).show(),l.value=null,d.innerHTML="Upload",d.removeAttribute("disabled",""),L()}else m("Alert!","Please choose a file")},new f(document.getElementById("scc-one-modal")).show()}async function we(){let t=document.getElementById("modal-input-files").querySelector("h2").innerText.indexOf("Input")>-1?"Input":"Output";const e=document.getElementById("availableModal").querySelector("li.selectedValue");try{const o=await y("fetchData",e.innerText,"SELECT FileName,FileBlob FROM S_DataFiles WHERE FileType = ?",[t]);if(!o||o.length===0){m("Alert!","No files found to download.");return}const d=new JSZip;o.forEach(c=>{d.file(c[0],c[1])});const l=await d.generateAsync({type:"blob"}),i=document.createElement("a");i.href=window.URL.createObjectURL(l),i.download="InputFiles.zip",i.click(),setTimeout(function(){window.URL.revokeObjectURL(i.href)},1e3)}catch(a){console.error("Error creating zip file for download:",a)}}async function Te(t){const e=document.getElementById("availableModal").querySelector("li.selectedValue");if(!e){m("Alert!","Please select a model");return}const[a,o]=E("Upload Package","Upload"),d=n("input","form-control"),l=n("div","input-group",null,d);d.setAttribute("type","file"),d.setAttribute("accept",".whl"),a.appendChild(l),o.onclick=async function(i){if(d.files[0]){o.setAttribute("disabled",""),o.innerHTML='<span class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span>';const s=await d.files[0].arrayBuffer();try{await y("insertData",e.innerText,"INSERT INTO S_PackageWheels (WheelName,WheelBlob) VALUES (?, ?) ON CONFLICT (WheelName) DO UPDATE SET WheelBlob = ?",[d.files[0].name,new Uint8Array(s),new Uint8Array(s)]),m("Success","Package uploaded successfully!")}catch(r){console.error("Error saving file:",r)}f.getInstance(document.getElementById("scc-one-modal")).hide(),d.value=null,o.innerHTML="Upload",o.removeAttribute("disabled","")}else m("Alert!","Please choose a file")}}async function ve(){const t=document.createElement("a");t.href=window.URL.createObjectURL(q),t.download="output.jpg",t.click(),setTimeout(function(){window.URL.revokeObjectURL(t.href)},1e3)}document.getElementById("notebookBtn").onclick=function(){const t=document.getElementById("availableModal").querySelector("li.selectedValue");if(!t){m("Alert!","Please select a model");return}const e=t.innerText;window.open(`./S_Notebook.html?modelName=${e}`)};
