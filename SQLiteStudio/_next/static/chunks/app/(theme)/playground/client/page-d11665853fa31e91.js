(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[167],{42634:()=>{},98425:(e,t,a)=>{Promise.resolve().then(a.bind(a,50949)),Promise.resolve().then(a.bind(a,33820)),Promise.resolve().then(a.bind(a,43517))},50949:(e,t,a)=>{"use strict";a.d(t,{default:()=>lU});var n=a(95155),s=a(12115),r=a(19710),l=a(43463),i=a(69795);function o(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,i.QP)((0,l.$)(t))}let d=r.Kq,c=r.bL,u=r.l9,m=s.forwardRef((e,t)=>{let{className:a,sideOffset:s=4,...l}=e;return(0,n.jsx)(r.UC,{ref:t,sideOffset:s,className:o("z-50 overflow-hidden rounded-md shadow-sm bg-white dark:bg-neutral-800 text-black dark:text-neutral-200 px-3 py-1.5 text-xs animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...l})});m.displayName=r.UC.displayName;let h=(0,s.createContext)({databaseDriver:{}});function x(){return(0,s.useContext)(h)}function p(e){let{children:t,driver:a,collaborationDriver:s,docDriver:r}=e;return(0,n.jsx)(h.Provider,{value:{databaseDriver:a,collaborationDriver:s,docDriver:r},children:t})}var f=a(31867),g=a(72904),v=a(49289),y=a(59007);let b=JSON.parse('{"abs":{"syntax":"abs(X)","description":"<p>Returns the absolute value of X. If X is a string or blob, it returns 0.</p>\\n<pre><code>SELECT abs(-5);  --&gt; 5\\nSELECT abs(\\"-3\\");  --&gt; 3\\nSELECT abs(\\"libsql\\");  --&gt; 0\\n</code></pre>"},"avg":{"syntax":"avg(X)","description":"<p>The avg() function returns the average of all non-NULL values in a group, interpreting non-numeric\\nstrings and BLOBs as 0. It always yields a floating point result if there is at least one non-NULL\\ninput and returns NULL if there are no non-NULL inputs.</p>"},"changes":{"syntax":"changes()","description":"<p>The changes() function returns the number of rows altered by the latest INSERT, DELETE, or UPDATE statement, excluding changes from lower-level triggers.</p>"},"char":{"syntax":"char(X1,X2,...,XN)","description":"<p>The char(X1,X2,…,XN) function returns a string composed of characters having the unicode code point values of integers X1 through XN, respectively.</p>\\n<pre><code>SELECT CHAR(65, 66, 67);\\n-&gt; \'ABC\'\\n</code></pre>"},"coalesce":{"syntax":"coalesce(X,Y,...)","description":"<p>The coalesce() function returns a copy of its first non-NULL argument, or NULL if all arguments are NULL. Coalesce() must have at least 2 arguments.</p>\\n<pre><code>select coalesce(null, 50);\\n-&gt; 50\\n</code></pre>"},"concat":{"syntax":"concat(X,...)","description":"<p>The concat function returns a string formed by concatenating all its non-NULL arguments. If all arguments are NULL, it returns an empty string.</p>\\n<pre><code>select concat(\'hello\', \' \', \'world\')\\n-&gt; \'hello world\'\\n</code></pre>"},"concat_ws":{"syntax":"concat_ws(SEP,X,...)","description":"<p>The concat_ws concatenates all non-null arguments beyond the first, using the first argument as a separator. If the first argument is NULL, it returns NULL. If all other arguments are NULL, it returns an empty string.</p>\\n<pre><code>select concat_ws(\', \', \'hello\', \'world\')\\n-&gt; \'hello world\'\\n</code></pre>"},"count":{"syntax":"count(X), count(\\\\*)","description":"<p>The count(X) function returns a count of the number of times that X is not NULL in a group.\\nThe count(*) function (with no arguments) returns the total number of rows in the group.</p>"},"format":{"syntax":"format(FORMAT,...)","description":"<p>The FORMAT() function, similar to C\'s printf(), uses a format string (first argument) to construct the output with values from subsequent arguments.</p>\\n<pre><code>select format(\'i am %d years old\', 50);\\n-&gt; \'i am 50 years old\'\\n</code></pre>"},"fts5":{"syntax":"fts5(...col)","description":"<p>FTS5 is an SQLite virtual table module that provides full-text search functionality to database applications.</p>\\n<pre><code>CREATE VIRTUAL TABLE movie_fts USING fts5(title, summary);\\nCREATE VIRTUAL TABLE name_fts USING fts5(name, tokenize=\'trigram\');\\n</code></pre>\\n<p><strong>External Content Tables</strong></p>\\n<pre><code>CREATE VIRTUAL TABLE student_fts USING fts5(\\n    name,\\n    tokenize=\'trigram\',\\n    content=\'student\',\\n    content_rowid=\'id\'\\n);\\n</code></pre>"},"glob":{"syntax":"glob(X,Y)","description":"<p>The GLOB operator is like LIKE but uses Unix file globbing syntax and is case-sensitive.</p>\\n<pre><code>select glob(\'*hello*\', \'hello world\');\\n-&gt; 1\\n</code></pre>"},"group_concat":{"syntax":"group_concat(X, Y)","description":"<p>The function concatenates all non-NULL values of X into a string, using Y as the separator. If Y is omitted, a comma (\\",\\") is used.</p>"},"hex":{"syntax":"hex(X)","description":"<p>The hex() function converts its BLOB argument into an upper-case hexadecimal string.</p>\\n<pre><code>select hex(x\'ffeeaa\');\\n-&gt; FFEEAA\\n</code></pre>"},"ifnull":{"syntax":"ifnull(X,Y)","description":"<p>The ifnull() function returns the first non-NULL argument, or NULL if both are NULL. It requires exactly 2 arguments and is equivalent to coalesce() with two arguments.</p>\\n<pre><code>select ifnull(null, 5);\\n-&gt; 5\\n</code></pre>"},"iif":{"syntax":"iif(X,Y,Z)","description":"<p>The iif(X,Y,Z) function returns the value Y if X is true, and Z otherwise</p>\\n<pre><code>select iif(age &gt;= 18, \'adult\', \'underage\');\\n-&gt; \'underage\'\\n</code></pre>"},"instr":{"syntax":"instr(X, Y)","description":"<p>The instr(X, Y) function returns the position of the first occurrence of string Y within string X plus 1, or 0 if Y is not found in X.</p>\\n<pre><code>select instr(\'hello world\', \'wo\');\\n-&gt; 7\\n</code></pre>"},"last_insert_rowid":{"syntax":"last_insert_rowid()","description":"<p>The last<em>insert</em>rowid() function returns the ROWID of the last row insert from the database connection which invoked the function.</p>"},"length":{"syntax":"length(X)","description":"<p>The length(X) function returns the character count of string X, excluding any NUL characters for strings (which SQLite typically lacks), or the byte count for blobs. If X is NULL, length(X) is also NULL. For numeric X, it returns the length of its string representation.</p>\\n<pre><code>select length(\'hello\');\\n-&gt; 5\\n\\nselect length(x\'ff00ee\');\\n-&gt; 3\\n\\nselect length(NULL);\\n-&gt; NULL\\n</code></pre>"},"libsql_vector_idx":{"syntax":"libsql_vector_idx(X)","description":"<p>Use the <strong>libsql<em>vector</em>idx</strong> expression in the CREATE INDEX statement to create an ANN index.</p>\\n<pre><code>CREATE INDEX movies_idx ON movies (libsql_vector_idx(embedding));\\n</code></pre>"},"like":{"syntax":"like(X,Y), like(X,Y,Z)","description":"<p>The like() function checks if the string Y matches the pattern X in the \\"Y LIKE X [ESCAPE Z]\\" expression.</p>\\n<pre><code>select like(\'hel%\', \'hello\')\\n-&gt; 1\\n\\nselect like(\'wor%\', \'hello\')\\n-&gt; 0\\n</code></pre>"},"lower":{"syntax":"lower(X)","description":"<p>The lower(X) function converts all ASCII characters in string X to lowercase.</p>\\n<pre><code>select lower(\'Hello World\');\\n-&gt; \'hello world\'\\n</code></pre>"},"ltrim":{"syntax":"ltrim(X,Y)","description":"<p>The ltrim(X, Y) function removes characters specified in Y from the left side of string X. Omitting Y removes spaces from the left side of X.</p>\\n<pre><code>select ltrim(\' hello\');\\n-&gt; \'hello\'\\n\\nselect ltrim(\'0.005\', \'0.\');\\n-&gt; \'5\'\\n</code></pre>"},"max":{"syntax":"max(X,Y,...)","description":"<p>The multi-argument max() function returns the maximum value among its arguments, or NULL if any argument is NULL. It uses the collating function of the first argument for string comparisons, defaulting to the BINARY collating function if none is specified. When given a single argument, max() acts as an aggregate function.</p>\\n<pre><code>select max(5, 6, 1);\\n-&gt; 6\\n\\nselect max(age) from users;\\n</code></pre>"},"min":{"syntax":"max(X,Y,...)","description":"<p>The multi-argument min() function returns the minimum value among its arguments, utilizing the collating function of the first argument for string comparisons or defaulting to BINARY. When given a single argument, min() acts as an aggregate function.</p>\\n<pre><code>select min(5, 6, 1);\\n-&gt; 1\\n\\nselect min(age) from users;\\n</code></pre>"},"nullif":{"syntax":"nullif(X,Y)","description":"<p>The nullif(X, Y) function returns X if X and Y are different, and NULL if they are the same.</p>\\n<pre><code>select nullif(6, 6)\\n-&gt; NULL\\n\\nselect nullif(7, 6)\\n-&gt; 7\\n</code></pre>"},"octet_length":{"syntax":"octet_length(X)","description":"<p>The octet_length(X) function returns the number of bytes in the encoding of text string X. If X is NULL, it returns NULL. For BLOBs, it returns the same as length(X). For numeric values, it returns the byte count of the text representation.</p>\\n<pre><code>select octet_length(\'វិសាល\'); -&gt; 15\\nselect octet_length(\'visal\'); -&gt; 5\\nselect octet_length(x\'ff11ee\');  -&gt; 3\\n</code></pre>"},"printf":{"syntax":"printf(FORMAT,...)","description":"<p>The printf() function, similar to C\'s printf(), uses a format string (first argument) to construct the output with values from subsequent arguments.</p>\\n<pre><code>select printf(\'i am %d years old\', 50);\\n-&gt; \'i am 50 years old\'\\n</code></pre>"},"quote":{"syntax":"quote(X)","description":"<p>The quote(X) function returns the SQL literal for X, suitable for inclusion in an SQL statement. Strings are single-quoted with escaped interior quotes. BLOBs are encoded as hex literals.</p>\\n<pre><code>select quote(\'hello \'\' world\')\\n-&gt; \'hello \'\' world\'\\n\\nselect quote(x\'ffee00\')\\n-&gt; X\'FFEE00\'\\n</code></pre>"},"random":{"syntax":"random()","description":"<p>The random() function returns a pseudo-random integer between -9223372036854775808 and +9223372036854775807.</p>"},"randomblob":{"syntax":"randomblob(N)","description":"<p>The randomblob(N) function returns an N-byte blob of pseudo-random bytes. If N is less than 1, it returns a 1-byte random blob.</p>\\n<pre><code>select hex(randomblob(3))\\n-&gt; 35DD3E\\n</code></pre>"},"replace":{"syntax":"replace(X,Y,Z)","description":"<p>The replace(X, Y, Z) function returns X with every occurrence of Y replaced by Z.</p>\\n<pre><code>select replace(\'hello world\', \'world\', \'planet\')\\n-&gt; \'hello planet\'\\n</code></pre>"},"round":{"syntax":"round(X,Y)","description":"<p>The round(X, Y) function returns X rounded to Y decimal places. If Y is omitted or negative, it defaults to 0.</p>\\n<pre><code>select round(1.6);\\n-&gt; 2\\n\\nselect round(1.665, 2);\\n-&gt; 1.67\\n</code></pre>"},"rtrim":{"syntax":"rtrim(X,Y)","description":"<p>The rtrim(X, Y) function removes all characters in Y from the right side of X. If Y is omitted, it removes spaces.</p>\\n<pre><code>select rtrim(\'hello \');\\n-&gt; \'hello\'\\n\\nselect rtrim(\'5,000\', \'0,\');\\n-&gt; \'5\'\\n</code></pre>"},"sign":{"syntax":"sign(X)","description":"<p>The sign(X) function returns -1, 0, or 1 if X is negative, zero, or positive, respectively. If X is NULL or not a number, it returns NULL.</p>\\n<pre><code>select sign(-5);  -&gt; -1\\nselect sign(0);   -&gt; 0\\nselect sign(5);   -&gt; 1\\n</code></pre>"},"string_agg":{"syntax":"string_agg(X, Y)","description":"<p>The function concatenates all non-NULL values of X into a string, using Y as the separator. If Y is omitted, a comma (\\",\\") is used.</p>"},"sum":{"syntax":"sum(X)","description":"<p>The function returns the sum of all non-NULL values in the group, returning NULL if there are no non-NULL inputs.</p>"},"total":{"syntax":"total(X)","description":"<p>The function returns the sum of all non-NULL values in the group, with a result of 0.0 if there are no non-NULL inputs.\\nThe result of total() is always a floating point value.</p>"},"vector":{"syntax":"vector(X)","description":"<p>Function to convert a vector from string format to binary.</p>\\n<pre><code>INSERT INTO movies (title, year, embedding) VALUES(\'Napoleon\', 2023, vector(\'[1,2,3]\'));\\n</code></pre>"},"vector_distance_cos":{"syntax":"vector_distance_cos(X, Y)","description":"<p>Function to calculate cosine distance between two vectors.\\nIt computes the distance as 1 minus the cosine similarity,\\nmeaning a smaller distance indicates closer vectors.</p>\\n<pre><code>SELECT * FROM movie\\nORDER BY vector_distance_cos(embedding, \'[3,1,2]\')\\n</code></pre>"},"vector_extract":{"syntax":"vector_extract(X)","description":"<p>Function to extract string from binary vector</p>\\n<pre><code>SELECT title,\\n  vector_extract(embedding),\\n  vector_distance_cos(embedding, vector(\'[5,6,7]\'))\\nFROM movies;\\n</code></pre>"},"vector_top_k":{"syntax":"vector_top_k(idx_name, q_vector, k)","description":"<p>Use <strong>vector<em>top</em>k</strong> with the <strong>idx<em>name</strong> index to efficiently find the top k most similar vectors to <strong>q</em>vector</strong></p>\\n<pre><code>SELECT title, year\\nFROM vector_top_k(\'movies_idx\', vector(\'[4,5,6]\'), 3)\\nJOIN movies ON movies.rowid = id\\n</code></pre>"}}'),j=Object.keys(b).join(" "),N=g.fy.define({keywords:j+" absolute action add after all allocate alter and any are as asc assertion at authorization before begin between both breadth by call cascade cascaded case cast catalog check close collate collation column commit condition connect connection constraint constraints constructor continue corresponding count create cross cube current current_date current_default_transform_group current_transform_group_for_type current_path current_role current_time current_timestamp current_user cursor cycle data day deallocate declare default deferrable deferred delete depth deref desc describe descriptor deterministic diagnostics disconnect distinct do domain drop dynamic each else elseif end end-exec equals escape except exception exec execute exists exit external fetch first for foreign found from free full function general get global go goto grant group grouping handle having hold hour identity if immediate in indicator initially inner inout input insert intersect into is isolation join key language last lateral leading leave left level like limit local localtime localtimestamp locator loop map match method minute modifies module month names natural nesting new next no none not of old on only open option or order ordinality out outer output overlaps pad parameter partial path prepare preserve primary prior privileges procedure public read reads recursive redo ref references referencing relative release repeat resignal restrict result return returns revoke right role rollback rollup routine row rows savepoint schema scroll search second section select session session_user set sets signal similar size some space specific specifictype sql sqlexception sqlstate sqlwarning start state static system_user table temporary then timezone_hour timezone_minute to trailing transaction translation treat trigger under undo union unique unnest until update usage user using value values view when whenever where while with without work write year zone abort analyze attach autoincrement conflict database detach exclusive fail glob ignore index indexed instead isnull notnull offset plan pragma query raise regexp reindex rename replace temp vacuum virtual",types:"array binary bit boolean char character clob date decimal double float int integer interval large national nchar nclob numeric object precision real smallint time timestamp varchar varying f32_blob float32bool blob long longblob longtext medium mediumblob mediumint mediumtext tinyblob tinyint tinytext text bigint int2 int8 unsigned signed real",builtin:"auth backup bail changes clone databases dbinfo dump echo eqp explain fullschema headers help import imposter indexes iotrace lint load log mode nullvalue once print prompt quit restore save scanstats separator shell show stats system tables testcase timeout timer trace vfsinfo vfslist vfsname width",operatorChars:"*+-%<>!=&|/~",identifierQuotes:'`"',specialVar:"@:?$"});class w{static capture(e){let t=e.ctrlKey||e.metaKey,a=e.key;return"Shift"===a&&(a=void 0),"Control"===a&&(a=void 0),new w({ctrl:t,shift:e.shiftKey,key:a})}match(e){let t=!0,a=e.ctrlKey||e.metaKey;return this.key.ctrl&&!a&&(t=!1),this.key.key&&e.key!==this.key.key&&(t=!1),this.key.shift&&!e.shiftKey&&(t=!1),t}toJson(){return{...this.key}}toString(){var e,t;let a=navigator.userAgent.toLowerCase().indexOf("mac")>-1;return[this.key.ctrl?a?"⌘":"Ctrl":void 0,this.key.shift?"Shift":void 0,null===(t=this.key)||void 0===t?void 0:null===(e=t.key)||void 0===e?void 0:e.toUpperCase()].filter(Boolean).join(" + ")}toCodeMirrorKey(){var e;let t=navigator.userAgent.toLowerCase().indexOf("mac")>-1;return[this.key.ctrl?t?"Cmd":"Ctrl":void 0,this.key.shift?"Shift":void 0,null===(e=this.key)||void 0===e?void 0:e.key].filter(Boolean).join("-")}constructor(e){this.key=e}}let C={run:new w({ctrl:!0,key:"Enter"}),copy:new w({ctrl:!0,key:"c"}),paste:new w({ctrl:!0,key:"v"}),format:new w({ctrl:!0,shift:!0,key:"i"}),commit:new w({ctrl:!0,key:"s"}),discard:new w({ctrl:!0,shift:!0,key:"Delete"})};var k=a(58361),S=a(92836),E=a(30814),R=a(28220);function T(e,t){let a=(0,v.mv)(e),n=e.selection.main.head,s=a.resolveInner(e.selection.main.head,-1).parent;if(!s||"Parens"!==s.type.name||!s.prevSibling||!["Keyword","Type"].includes(s.prevSibling.type.name))return[];let r=t[e.doc.slice(s.prevSibling.from,s.prevSibling.to).toString().toLowerCase()];return r?[{pos:n,above:!0,arrow:!0,create:()=>{let e=document.createElement("div");return e.className="cm-tooltip-cursor",e.innerHTML="\n            <div style=\"max-width:700px; padding:5px; font-size:14px;\">\n              <p style='font-size:16px;'><strong>".concat(r.syntax,'</strong></p>\n              <div class="code-tooltip">').concat(r.description,"</div>\n            </div>\n            "),{dom:e}}}]:[]}let A=e=>R.sU.define({create:t=>T(t,e),update:(t,a)=>a.docChanged||a.selection?T(a.state,e):t,provide:e=>S.DK.computeN([e],t=>t.field(e))}),_=S.Lz.baseTheme({".cm-tooltip.cm-tooltip-cursor":{backgroundColor:"#66b",color:"white",border:"none",padding:"2px 7px",borderRadius:"4px","& .cm-tooltip-arrow:before":{borderTopColor:"#66b"},"& .cm-tooltip-arrow:after":{borderTopColor:"transparent"}},".code-tooltip a":{color:"white",textDecoration:"underline"},".code-tooltip a:hover":{color:"white",textDecoration:"none"}}),L=S.NZ.mark({class:"cm-table-name"});function I(e){let t=new Set(e.map(e=>e.toLowerCase()));function a(e){let a=[];for(let{from:n,to:s}of e.visibleRanges)(0,v.mv)(e.state).iterate({from:n,to:s,enter:n=>{if("Identifier"==n.name){let s=e.state.doc.sliceString(n.from,n.to).toLowerCase(),r=n.node.prevSibling?e.state.doc.sliceString(n.node.prevSibling.from,n.node.prevSibling.to).toLowerCase():"";t.has(s)&&"."!==r&&a.push(L.range(n.from,n.to))}}});return S.NZ.set(a)}return S.Z9.fromClass(class{update(e){this.decorations=a(e.view)}constructor(e){this.decorations=a(e)}},{decorations:e=>e.decorations})}let F=y.NZ.line({class:"cm-highlight-statement"});function M(e,t){return e.doc.sliceString(t.from,t.to)}function D(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],a=(0,v.mv)(e).topNode,n=0,s=a.getChildren("Statement");if(0===s.length)return[];let r=[],l=[],i=0;for(;i<s.length;i++){let t=s[i];(n+=function(e,t){let a=t.firstChild;if(!a)return 0;let n=M(e,a).toLowerCase();if("select"===n||"insert"===n||"update"===n||"delete"===n)return 0;let s=t.getChildren("Keyword");return 0===s.length?0:s.filter(t=>"begin"===M(e,t).toLowerCase()).length}(e,t))?l.push(t):r.push([t]),n&&function(e,t){let a=t.firstChild;return!!a&&"end"===M(e,a).toLowerCase()&&!!(a=a.nextSibling)&&";"===M(e,a)}(e,t)&&0==--n&&(r.push(l),l=[])}return l.length>0&&r.push(l),r.map(a=>({from:a[0].from,to:a[a.length-1].to,text:t?e.doc.sliceString(a[0].from,a[a.length-1].to):""}))}function O(e){let t=e.selection.main.from,a=D(e,!1);if(0===a.length)return null;let n=0;for(;n<a.length;n++){let e=a[n];if(t<e.from)break;if(!(t>e.to)&&t>=e.from&&t<=e.to)return e}if(0===n)return a[0];if(n===a.length)return a[n-1];let s=e.doc.lineAt(t).number;return s-e.doc.lineAt(a[n-1].to).number>=e.doc.lineAt(a[n].from).number-s?a[n]:a[n-1]}function q(e){let t=O(e);if(!t)return y.NZ.none;let a=e.doc.lineAt(t.from).number,n=e.doc.lineAt(t.to).number,s=[];for(let t=a;t<=n;t++)s.push(F.range(e.doc.line(t).from));return y.NZ.set(s)}let U=[y.sU.define({create:e=>q(e),update:(e,t)=>q(t.state),provide:e=>y.Lz.decorations.from(e)}),y.Lz.baseTheme({".cm-highlight-statement":{borderLeft:"3px solid #ff9ff3 !important"}})];var K=a(12675),z=a(56194),B=a(67113);let P=(0,s.forwardRef)(function(e,t){let{dialect:a,value:r,onChange:l,schema:i,onKeyDown:o,onCursorChange:d,readOnly:c,fontSize:u,onFontSizeChanged:m}=e,h=function(e){let{fontSize:t=.875}=e,{resolvedTheme:a,forcedTheme:n}=(0,B.D)();return(0,s.useMemo)(()=>(null!=n?n:a)==="light"?(0,z.a)({theme:"light",settings:{background:"#FFFFFF",foreground:"#000000",caret:"#FBAC52",selection:"#FFD420",selectionMatch:"#FFD420",gutterBackground:"#fff",gutterForeground:"#4D4D4C",gutterBorder:"transparent",lineHighlight:"var(--accent)",fontSize:t+"rem",fontFamily:'Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace'},styles:[{tag:[K._A.meta,K._A.comment],color:"#804000"},{tag:[K._A.keyword,K._A.strong,K._A.standard(K._A.name)],color:"#0000FF"},{tag:[K._A.number],color:"#FF0080"},{tag:[K._A.string],color:"#e17055"},{tag:[K._A.variableName],color:"#006600"},{tag:[K._A.escape],color:"#33CC33"},{tag:[K._A.tagName],color:"#1C02FF"},{tag:[K._A.heading],color:"#0C07FF"},{tag:[K._A.quote],color:"#000000"},{tag:[K._A.list],color:"#B90690"},{tag:[K._A.documentMeta],color:"#888888"},{tag:[K._A.function(K._A.variableName)],color:"#0000A2"},{tag:[K._A.definition(K._A.typeName),K._A.typeName],color:"#6D79DE"}]}):(0,z.a)({theme:"dark",settings:{background:"var(--background)",foreground:"#9cdcfe",caret:"#c6c6c6",selection:"#6199ff2f",selectionMatch:"#72a1ff59",lineHighlight:"var(--accent)",gutterBackground:"var(--background)",gutterForeground:"#838383",gutterActiveForeground:"#fff",fontSize:t+"rem",fontFamily:'Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace'},styles:[{tag:[K._A.number],color:"#fbc531"},{tag:[K._A.keyword,K._A.strong,K._A.standard(K._A.name)],color:"#3498db"},{tag:K._A.comment,color:"#27ae60"},{tag:K._A.definition(K._A.typeName),color:"#27ae60"},{tag:K._A.typeName,color:"#194a7b"},{tag:K._A.tagName,color:"#008a02"},{tag:K._A.variableName,color:"#1a00db"},{tag:K._A.string,color:"#e67e22"}]}),[a,n,t])}({fontSize:u}),x=(0,s.useMemo)(()=>i?I(Object.keys(i)):I([]),[i]),p=(0,s.useMemo)(()=>S.w4.of([{key:C.run.toCodeMirrorKey(),preventDefault:!0,run:()=>!0},{key:"Tab",preventDefault:!0,run:e=>("active"===(0,f.DH)(e.state)?(0,f.$w)(e):(0,k.pr)(e),!0)},{key:"Ctrl-Space",mac:"Cmd-i",preventDefault:!0,run:f.rB},{key:"Ctrl-=",mac:"Cmd-=",preventDefault:!0,run:()=>{if(m){let e=Math.min(2,(null!=u?u:1)+.2);m(e),E.oR.info("Change code editor font size to ".concat(Math.floor(100*e),"%"),{duration:1e3,id:"font-size"})}return!0}},{key:"Ctrl--",mac:"Cmd--",preventDefault:!0,run:()=>{if(m){let e=Math.max(.4,(null!=u?u:1)-.2);m(e),E.oR.info("Change code editor font size to ".concat(Math.floor(100*e),"%"),{duration:1e3,id:"font-size"})}return!0}},...k.pw]),[u,m]),j=(0,s.useMemo)(()=>{let e,t;return"sqlite"===a?(e=(0,g.ll)({dialect:N,schema:i}),t=[A(b),_]):e="postgres"===a?(0,g.ll)({dialect:g.Rv,schema:i}):(0,g.ll)({dialect:g.hi,schema:i}),[y.Lz.baseTheme({"& .cm-line":{borderLeft:"3px solid transparent",paddingLeft:"10px"},"& .cm-focused":{outline:"none !important"}}),p,v.Xt.of("  "),e,t,x,U,y.Lz.updateListener.of(e=>{let t=e.state.selection.main.head,a=e.state.doc.lineAt(t),n=a.number,s=t-a.from;d&&d(t,n,s)})].filter(Boolean)},[a,d,p,i,x]);return(0,n.jsx)(y.Ay,{ref:t,autoFocus:!0,readOnly:c,onKeyDown:o,basicSetup:{defaultKeymap:!1,drawSelection:!1},theme:h,indentWithTab:!1,value:r,height:"100%",onChange:l,style:{fontSize:20,height:"100%"},extensions:j})});var H=a(12317),X=a(31027);let V=(0,X.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-hidden focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-sm hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-xs hover:bg-destructive/90",outline:"border border-input bg-background shadow-xs hover:bg-accent hover:text-accent-foreground",secondary:"bg-neutral-200/75 dark:bg-neutral-800/75 text-secondary-foreground shadow-xs hover:bg-neutral-200 dark:hover:bg-neutral-800",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),W=s.forwardRef((e,t)=>{let{className:a,variant:s,size:r,asChild:l=!1,...i}=e,d=l?H.DX:"button";return(0,n.jsx)(d,{className:o(V({variant:s,size:r,className:a})),ref:t,...i})});W.displayName="Button";var G=a(38130),Y=a(87365);let Q=G.bL,J=G.l9;G.YJ,G.ZL,G.Pb,G.z6,s.forwardRef((e,t)=>{let{className:a,inset:s,children:r,...l}=e;return(0,n.jsxs)(G.ZP,{ref:t,className:o("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-hidden focus:bg-accent data-[state=open]:bg-accent",s&&"pl-8",a),...l,children:[r,(0,n.jsx)(Y.vKP,{className:"ml-auto h-4 w-4"})]})}).displayName=G.ZP.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(G.G5,{ref:t,className:o("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...s})}).displayName=G.G5.displayName;let Z=s.forwardRef((e,t)=>{let{className:a,sideOffset:s=4,...r}=e;return(0,n.jsx)(G.ZL,{children:(0,n.jsx)(G.UC,{ref:t,sideOffset:s,className:o("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...r})})});Z.displayName=G.UC.displayName;let $=s.forwardRef((e,t)=>{let{className:a,inset:s,...r}=e;return(0,n.jsx)(G.q7,{ref:t,className:o("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-hidden transition-colors focus:bg-accent focus:text-accent-foreground data-disabled:pointer-events-none data-disabled:opacity-50",s&&"pl-8",a),...r})});$.displayName=G.q7.displayName,s.forwardRef((e,t)=>{let{className:a,children:s,checked:r,...l}=e;return(0,n.jsxs)(G.H_,{ref:t,className:o("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-hidden transition-colors focus:bg-accent focus:text-accent-foreground data-disabled:pointer-events-none data-disabled:opacity-50",a),checked:r,...l,children:[(0,n.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,n.jsx)(G.VF,{children:(0,n.jsx)(Y.Srz,{className:"h-4 w-4"})})}),s]})}).displayName=G.H_.displayName,s.forwardRef((e,t)=>{let{className:a,children:s,...r}=e;return(0,n.jsxs)(G.hN,{ref:t,className:o("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-hidden transition-colors focus:bg-accent focus:text-accent-foreground data-disabled:pointer-events-none data-disabled:opacity-50",a),...r,children:[(0,n.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,n.jsx)(G.VF,{children:(0,n.jsx)(Y.RiX,{className:"h-4 w-4 fill-current"})})}),s]})}).displayName=G.hN.displayName;let ee=s.forwardRef((e,t)=>{let{className:a,inset:s,...r}=e;return(0,n.jsx)(G.JU,{ref:t,className:o("px-2 py-1.5 text-sm font-semibold",s&&"pl-8",a),...r})});ee.displayName=G.JU.displayName;let et=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(G.wv,{ref:t,className:o("-mx-1 my-1 h-px bg-muted",a),...s})});et.displayName=G.wv.displayName;var ea=a(31779);let en=e=>{let{className:t,...a}=e;return(0,n.jsx)(ea.YZ,{className:o("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",t),...a})},es=ea.Zk,er=e=>{let{withHandle:t,className:a,orientation:s="vertical",...r}=e;return(0,n.jsx)(ea.TW,{className:o("relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-hidden focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",a),...r,children:t&&(0,n.jsx)("div",{style:{transform:"translateY(-2px)"},className:"z-10 flex ".concat("vertical"===s?"h-full w-1":"w-full h-1"," dark:hover:bg-neutral-700 hover:bg-neutral-300 opacity-0 hover:opacity-100 transition-opacity duration-200"),children:(0,n.jsx)("div",{className:"h-2.5 w-2.5"})})})};class el{registerBeforeQuery(e){this.beforeQueryHandlers.push(e)}registerAfterQuery(e){this.afterQueryHandlers.push(e)}registerSidebar(e){this.sidebars.push(e)}registerCreateResourceMenu(e){this.resourceCreateMenu.push(e)}registerResourceContextMenu(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"other";this.resourceContextMenu[t]?this.resourceContextMenu[t].push(e):this.resourceContextMenu[t]=[e]}registerQueryHeaderContextMenu(e){this.queryResultHeaderContextMenu.push(e)}registerQueryCellContextMenu(e){this.queryResultCellContextMenu.push(e)}getExtension(e){return this.extensions.find(t=>t.extensionName===e)}constructor(e){this.extensions=e,this.sidebars=[],this.beforeQueryHandlers=[],this.afterQueryHandlers=[],this.queryResultHeaderContextMenu=[],this.queryResultCellContextMenu=[],this.resourceCreateMenu=[],this.resourceContextMenu={},this.extensions.forEach(e=>e.init(this))}}class ei extends el{cleanup(){this.extensions.forEach(e=>e.cleanup())}getSidebars(){return this.sidebars}getResourceCreateMenu(){return this.resourceCreateMenu}getResourceContextMenu(e,t){var a;return(null!==(a=this.resourceContextMenu[t])&&void 0!==a?a:[]).map(t=>t(e)).filter(Boolean)}getQueryHeaderContextMenu(e){return this.queryResultHeaderContextMenu.map(t=>t(e)).filter(Boolean)}getQueryCellContextMenu(){return this.queryResultCellContextMenu.map(e=>e()).filter(Boolean)}async beforeQuery(e){for(let t of this.beforeQueryHandlers)await t(e)}async afterQuery(){for(let e of this.afterQueryHandlers)await e()}}var eo=a(57464),ed=a.n(eo);let ec=(0,s.createContext)({name:"",color:"",extensions:new ei([]),onBack:ed(),containerClassName:""});function eu(){return(0,s.useContext)(ec)}function em(e){let{children:t,config:a}=e;return(0,n.jsx)(ec.Provider,{value:a,children:t})}function eh(e){let{className:t}=e;return(0,n.jsx)("div",{children:(0,n.jsxs)("svg",{className:o("w-32 h-32",t),width:"300",height:"300",viewBox:"40 40 220 220",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("rect",{width:"300",height:"300",fill:"none"}),(0,n.jsx)("rect",{x:"62",y:"65",width:"176",height:"169",rx:"20",className:"fill-gray-300 dark:fill-gray-500"}),(0,n.jsx)("rect",{x:"49.5",y:"82.5",width:"201",height:"58",rx:"4.5",className:"stroke-gray-400 fill-white stroke-2 dark:stroke-gray-400 dark:fill-black"}),(0,n.jsx)("rect",{x:"230",y:"92",width:"8",height:"41",rx:"4",fill:"#D9D9D9",className:"fill-gray-500"}),(0,n.jsx)("rect",{x:"217",y:"92",width:"8",height:"41",rx:"4",className:"fill-gray-500"}),(0,n.jsx)("rect",{x:"204",y:"92",width:"8",height:"41",rx:"4",className:"fill-gray-500"}),(0,n.jsx)("rect",{x:"62",y:"92",width:"60",height:"8",rx:"4",className:"fill-gray-500 animate-pulse duration-200"}),(0,n.jsx)("rect",{x:"127",y:"92",width:"21",height:"8",rx:"4",className:"fill-gray-500"}),(0,n.jsx)("rect",{x:"62",y:"107",width:"30",height:"8",rx:"4",className:"fill-gray-500"}),(0,n.jsx)("rect",{x:"96",y:"107",width:"46",height:"8",rx:"4",className:"fill-gray-500 animate-pulse duration-200"}),(0,n.jsx)("rect",{x:"62",y:"122",width:"57",height:"8",rx:"4",className:"fill-gray-500 animate-pulse duration-200"}),(0,n.jsx)("rect",{x:"49.5",y:"158.5",width:"201",height:"58",rx:"4.5",className:"stroke-gray-400 fill-white stroke-2 dark:stroke-gray-400 dark:fill-black"}),(0,n.jsx)("rect",{x:"230",y:"168",width:"8",height:"41",rx:"4",className:"fill-gray-500"}),(0,n.jsx)("rect",{x:"217",y:"168",width:"8",height:"41",rx:"4",className:"fill-gray-500"}),(0,n.jsx)("rect",{x:"204",y:"168",width:"8",height:"41",rx:"4",className:"fill-gray-500"}),(0,n.jsx)("rect",{x:"62",y:"168",width:"60",height:"8",rx:"4",className:"fill-gray-500"}),(0,n.jsx)("rect",{x:"127",y:"168",width:"21",height:"8",rx:"4",className:"fill-gray-500 animate-pulse duration-200"}),(0,n.jsx)("rect",{x:"62",y:"183",width:"30",height:"8",rx:"4",className:"fill-gray-500 animate-pulse duration-200"}),(0,n.jsx)("rect",{x:"96",y:"183",width:"46",height:"8",rx:"4",className:"fill-gray-500"}),(0,n.jsx)("rect",{x:"62",y:"198",width:"57",height:"8",rx:"4",className:"fill-gray-500"})]})})}function ex(e){let{message:t,onRetry:a}=e,{name:r,onBack:l}=eu(),i=(0,s.useMemo)(()=>window.outerbaseIpc,[]),o=(0,n.jsxs)("p",{children:["Connecting to ",(0,n.jsx)("strong",{children:r})]});return t&&(o=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"text-2xl font-semibold",children:"We have problem connecting to database"}),(0,n.jsx)("pre",{className:"mt-4",children:t}),(0,n.jsxs)("div",{className:"mt-4 flex gap-4",children:[(0,n.jsx)(W,{onClick:i?()=>{window.location.reload()}:a,children:"Retry"}),(0,n.jsx)(W,{variant:"secondary",onClick:i?()=>{var e,t;(null===(e=window.outerbaseIpc)||void 0===e?void 0:e.close)&&(null===(t=window.outerbaseIpc)||void 0===t||t.close())}:l,children:"Back"})]})]})),(0,n.jsxs)("div",{className:"w-screen h-screen flex items-center justify-center flex-col gap-4",children:[(0,n.jsx)(eh,{}),o]})}let ep=(0,s.createContext)({schema:{},updateTableList:()=>{throw Error("Not implemented")},updateTableSchema:()=>{throw Error("Not implemented")}});function ef(){return(0,s.useContext)(ep)}function eg(e){let{children:t}=e,[a,r]=(0,s.useState)({}),l=(0,s.useCallback)((e,t)=>{r(a=>({...a,[e]:t}))},[r]),i=(0,s.useCallback)(e=>{r(e.reduce((e,t)=>(e[t]=[],e),{}))},[r]),o=(0,s.useMemo)(()=>Object.entries(a).reduce((e,t)=>{let[a,n]=t;return e[a]=n.map(e=>e.name),e},{}),[a]);return(0,n.jsx)(ep.Provider,{value:{schema:o,updateTableList:i,updateTableSchema:l},children:t})}let ev=(0,s.createContext)({schema:{},autoCompleteSchema:{},currentSchema:[],currentSchemaName:"",refresh:()=>{throw Error("Not implemented")}});function ey(e){return e?e.filter(e=>"table"===e.type||"view"===e.type).reduce((e,t)=>{var a,n;return e[t.name]=(null!==(n=null===(a=t.tableSchema)||void 0===a?void 0:a.columns)&&void 0!==n?n:[]).map(e=>e.name),e},{}):{}}function eb(){return(0,s.useContext)(ev)}function ej(e){let{children:t}=e,{updateTableList:a,updateTableSchema:r}=ef(),[l,i]=(0,s.useState)(),[o,d]=(0,s.useState)(!0),{databaseDriver:c}=x(),[u,m]=(0,s.useState)({}),[h,p]=(0,s.useState)([]),[f,g]=(0,s.useState)(()=>c.getFlags().defaultSchema),v=(0,s.useCallback)(e=>{e&&d(!0),(async()=>{let e=await c.schemas(),t=null;return c.getFlags().supportUseStatement&&(t=await c.getCurrentSchema()),{schemaResult:e,selectedSchema:t}})().then(e=>{m(e.schemaResult),e.selectedSchema&&g(e.selectedSchema),i(void 0),d(!1)}).catch(e=>{i(e.message),d(!1)})},[c,i]);(0,s.useEffect)(()=>{u[f]&&p(u[f])},[f,u,p]),(0,s.useEffect)(()=>{for(let e of([...h].sort((e,t)=>e.name.localeCompare(t.name)),a(h.map(e=>e.name)),h))e.tableSchema&&r(e.name,e.tableSchema.columns)},[h,a,r]),(0,s.useEffect)(()=>{v(!0)},[v]);let y=(0,s.useMemo)(()=>({schema:u,currentSchema:h,currentSchemaName:f,refresh:v,autoCompleteSchema:{...ey(u[f]),...Object.entries(u).reduce((e,t)=>{let[a,n]=t;return e[a]=ey(n),e},{})}}),[u,v,h,f]);return l||o?(0,n.jsx)(ex,{message:l,loading:o}):(0,n.jsx)(ev.Provider,{value:y,children:t})}let eN=[];for(let e=0;e<=255;++e){let t=e.toString(16).padStart(2,"0");eN.push(t.toUpperCase())}var ew=a(50932);function eC(e){return'"'.concat(e.replace(/"/g,'""'),'"')}function ek(e){let t=e.replace(/^["`[]/g,"");return(t=t.replace(/["`\]]$/g,"")).replace(/""/g,'"')}function eS(e){return"x'".concat(function(e){let t=new Uint8Array(e),a="";for(let e=0;e<t.length;++e)a+=eN[t[e]];return a}(e),"'")}function eE(e){if(void 0===e)return"DEFAULT";if(null===e)return"NULL";if("string"==typeof e)return"'".concat(e.replace(/'/g,"''"),"'");if("number"==typeof e||"bigint"==typeof e)return e.toString();if(e instanceof ArrayBuffer)return eS(e);if(Array.isArray(e))return eS(Uint8Array.from(e).buffer);throw Error(e.toString()+" is unrecongize type of value")}function eR(e){if(""!==e)return void 0===e?ew.$C.BLOB:(e=e.toUpperCase()).includes("CHAR")||e.includes("TEXT")||e.includes("CLOB")||e.includes("STRING")?ew.$C.TEXT:e.includes("INT")||e.includes("NUMBER")?ew.$C.INTEGER:e.includes("BLOB")?ew.$C.BLOB:e.includes("REAL")||e.includes("DOUBLE")||e.includes("FLOAT")?ew.$C.REAL:ew.$C.TEXT}function eT(e,t,a,n){if(null==e)return"NULL";let s=e.toString();return s.includes(t)||s.includes(a)||s.includes(n)?"".concat(n).concat(s.replace(RegExp(n,"g"),n+n)).concat(n):s}var eA=a(91890);async function e_(e,t,a){let n=[],s=[];for(let r=0;r<t.length;r++){let l=t[r],i=l?function(e){let t=e.trim().toUpperCase();return(t=(t=t.replace(/\s+/g," ")).replace("IF NOT EXISTS","")).startsWith("SELECT")?"SELECT":t.startsWith("INSERT")?"INSERT":t.startsWith("UPDATE")?"UPDATE":t.startsWith("CREATE TABLE")?"CREATE_TABLE":t.startsWith("ALTER TABLE")?"ALTER_TABLE":t.startsWith("DROP TABLE")?"DROP_TABLE":t.startsWith("CREATE INDEX")?"CREATE_INDEX":t.startsWith("DROP INDEX")?"DROP_INDEX":t.startsWith("CREATE VIEW")?"CREATE_VIEW":t.startsWith("DROP VIEW")?"DROP_VIEW":t.startsWith("CREATE TRIGGER")?"CREATE_TRIGGER":t.startsWith("DROP TRIGGER")?"DROP_TRIGGER":"OTHER"}(l):"OTHER",o={order:r,sql:l,start:Date.now(),statementType:i};n.push(o),a&&a({logs:n,progress:r,total:t.length});try{let i=await e.query(l);o.end=Date.now(),o.stats=i.stat,i.headers.length>0&&s.push({sql:l,order:r,result:i}),a&&a({logs:n,progress:r+1,total:t.length})}catch(e){o.end=Date.now(),o.error=e.toString(),a&&a({logs:n,progress:r,total:t.length,error:!0});break}}return(0,eA.z)([...n.map(e=>{var t,a;return{name:"evt_query_execute",data:{sql:null!==(t=e.statementType)&&void 0!==t?t:"OTHER",type:null!==(a=e.statementType)&&void 0!==a?a:"OTHER"}}}),...s.map(e=>({name:"evt_rows_queried",data:{count:e.result.rows.length}}))]),{result:s,logs:n}}let eL=[{type:"WHITESPACE",findToken:e=>{var t;let a=/^\s+/.exec(e);return null!==(t=null==a?void 0:a[0])&&void 0!==t?t:null}},{type:"IDENTIFIER",findToken:e=>{var t;let a=/^(`[^(`\n)]+`|"[^("\n)]+"|\[[^(\]\n)]+\]|[a-zA-Z_][a-zA-Z0-9_]*)/.exec(e);return null!==(t=null==a?void 0:a[0])&&void 0!==t?t:null}},{type:"STRING",findToken:e=>{var t;let a=/^(?:'(?:[^('\n)]|'')*'|"(?:[^("\n)]|"")*")/.exec(e);return null!==(t=null==a?void 0:a[0])&&void 0!==t?t:null}},{type:"NUMBER",findToken:e=>{var t;let a=/^\d+(\.\d+)?/.exec(e);return null!==(t=null==a?void 0:a[0])&&void 0!==t?t:null}},{type:"PLACEHOLDER",findToken:e=>{var t;let a=/^:[a-zA-Z_][a-zA-Z0-9_]*/.exec(e);return null!==(t=null==a?void 0:a[0])&&void 0!==t?t:null}},{type:"COMMENT",findToken:(e,t)=>{var a;let n=/^(--.*|\/\*[\s\S]*?\*\/)/;"mysql"===t&&(n=/^(--.*|#.*|\/\*[\s\S]*?\*\/)/);let s=n.exec(e);return null!==(a=null==s?void 0:s[0])&&void 0!==a?a:null}},{type:"OPERATOR",findToken:e=>{var t;let a=/^(=|<>|!=|<|>|<=|>=|\+|-|\*|\/)/.exec(e);return null!==(t=null==a?void 0:a[0])&&void 0!==t?t:null}},{type:"PUNCTUATION",findToken:e=>{var t;let a=/^[`,;().]/.exec(e);return null!==(t=null==a?void 0:a[0])&&void 0!==t?t:null}}];function eI(e,t){try{let a=[],n=0,s=e.length,r="";for(;n<s;){let s=!1,l=e.substring(n);for(let{type:e,findToken:i}of eL){let o=i(l,t);if(o){""!==r&&(a.push({type:"UNKNOWN",value:r}),r=""),a.push({type:e,value:o}),n+=o.length,s=!0;break}}!s&&(r+=l[0],n++)}return""!==r&&a.push({type:"UNKNOWN",value:r}),a}catch(t){return[{type:"SQL",value:e}]}}var eF=a(45704),eM=a(64995),eD=a(6958),eO=a(2517),eq=a(78439),eU=a(43415),eK=a(31077),ez=a(53403),eB=a(59077),eP=a.n(eB);let eH=new(eP()).graphlib.Graph().setDefaultEdgeLabel(()=>({})),eX={x:0,y:0};function eV(e){return parseFloat(String(e)).toLocaleString("en-US",{maximumFractionDigits:2,notation:"compact",compactDisplay:"short"})}function eW(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"TB",n="LR"===a;return eH.setGraph({rankdir:a}),e.forEach(e=>{var t,a;eH.setNode(e.id,{width:(null===(t=e.measured)||void 0===t?void 0:t.width)||172,height:(null===(a=e.measured)||void 0===a?void 0:a.height)||36})}),t.forEach(e=>{eH.setEdge(e.source,e.target)}),eP().layout(eH),{nodes:e.map(e=>{var t,a;let s=eH.node(e.id);return{...e,targetPosition:n?"left":"top",sourcePosition:n?"right":"bottom",position:{x:s.x-((null===(t=e.measured)||void 0===t?void 0:t.width)||172)/2,y:s.y-((null===(a=e.measured)||void 0===a?void 0:a.height)||36)/2}}}),edges:t}}let eG=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(eK.h7,{ref:t,className:o("",a),...s})});function eY(e){var t;return(0,n.jsxs)(c,{children:[(0,n.jsx)(u,{asChild:!0,children:(0,n.jsxs)("div",{children:[(0,n.jsx)(eG,{type:"target",position:ez.yX.Left,id:e.id,className:"opacity-0 group-hover:opacity-100 w-[10px]! h-[10px]!"}),(0,n.jsx)(eG,{type:"source",position:ez.yX.Right,id:e.id,className:"opacity-0 group-hover:opacity-100 w-[10px]! h-[10px]!"}),(0,n.jsx)("div",{className:"flex flex-row justify-between items-center text-[8pt]",children:(0,n.jsx)("div",{className:"".concat(0===e.data.cost_info.query_cost?"hidden":""),children:(0,n.jsxs)("small",{children:["Query cost: ",eV(e.data.cost_info.query_cost||0)]})})}),(0,n.jsx)("div",{className:"flex flex-row items-center",children:(0,n.jsx)("div",{className:"max-w-[200px] p-2 bg-gray-300 text-gray-900 border-gray-900 text-[9pt] border-b rounded-md py-4",children:(0,n.jsx)("div",{children:(0,n.jsxs)("small",{children:[(null===(t=e.id.split("-"))||void 0===t?void 0:t[0])||null," ",e.data.select_id?"#".concat(e.data.select_id):""]})})})})]})}),(0,n.jsx)(m,{children:(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{className:"text-[9pt]!",children:["Select ID: ",e.data.select_id]}),(0,n.jsxs)("p",{className:"text-[9pt]! ".concat(0===e.data.cost_info.query_cost?"hidden":""),children:["Query Cost: ",e.data.cost_info.query_cost]})]})})]})}function eQ(e){return!0===e.disabled?(0,n.jsx)(n.Fragment,{children:e.children}):(0,n.jsxs)(c,{children:[(0,n.jsx)(u,{asChild:!0,children:e.children}),(0,n.jsx)(m,{children:e.content})]})}function eJ(e){return(0,n.jsx)(eQ,{content:(0,n.jsx)("div",{children:(0,n.jsxs)("p",{className:"text-[9pt]!",children:["Prefix Cost: ",e.data.cost_info.prefix_cost,e.id]})}),disabled:0===e.data.cost_info.prefix_cost,children:(0,n.jsxs)("div",{children:[(0,n.jsx)(eG,{type:"source",position:ez.yX.Right,id:e.id,className:"opacity-0 group-hover:opacity-100 w-[10px]! h-[10px]!"}),(0,n.jsx)(eG,{type:"target",position:ez.yX.Left,id:"left",className:"opacity-0 group-hover:opacity-100 w-[10px]! h-[10px]!"}),(0,n.jsx)(eG,{type:"target",position:ez.yX.Bottom,id:"bottom",className:"opacity-0 group-hover:opacity-100 w-[10px]! h-[10px]!"}),(0,n.jsx)("div",{className:"flex flex-row justify-between items-center text-[8pt]",children:(0,n.jsx)("div",{className:"".concat(0===e.data.cost_info.prefix_cost?"hidden":""),children:(0,n.jsx)("small",{children:eV(e.data.cost_info.prefix_cost)})})}),(0,n.jsx)("div",{className:"w-[50px] h-[50px] rotate-45 p-2 bg-secondary text-muted-foreground text-[9pt] border-b rounded-md overflow-hidden text-center my-2 mx-2",children:(0,n.jsx)("div",{className:"-rotate-45",children:(0,n.jsx)("small",{children:e.data.label})})})]})})}function eZ(e){let t="bg-emerald-700",a="Unique Key Lookup";return"ALL"===e.data.access_type&&(t="bg-rose-700",a="Full Table Scan"),"range"===e.data.access_type&&(t="bg-yellow-700",a="Index Range Scan"),"ref"===e.data.access_type&&(a="Non-Unique Key Lookup"),"index"===e.data.access_type&&(t="bg-rose-700",a="Full Index Scan"),"const"===e.data.access_type&&(a="Single Row (constant)",t="bg-sky-700"),(0,n.jsx)(eQ,{content:(0,n.jsx)("div",{children:(0,n.jsxs)("p",{className:"text-[9pt]!",children:["Prefix Cost: ",e.data.cost_info.prefix_cost]})}),disabled:0===e.data.cost_info.prefix_cost,children:(0,n.jsxs)("div",{children:[(0,n.jsx)(eG,{type:"source",position:ez.yX.Top,id:e.id,className:"opacity-0 group-hover:opacity-100 w-[10px]! h-[10px]!"}),(0,n.jsx)(eG,{type:"source",position:ez.yX.Right,id:"right",className:"opacity-0 group-hover:opacity-100 w-[10px]! h-[10px]!"}),(0,n.jsxs)("div",{className:"flex flex-row justify-between items-center text-[8pt]",children:[(0,n.jsx)("div",{className:"".concat(0===e.data.cost_info.read_cost?"hidden":""),children:(0,n.jsx)("small",{children:eV(Number(e.data.cost_info.read_cost)+Number(e.data.cost_info.eval_cost))})}),(0,n.jsx)("div",{className:"".concat("0"===e.data.rows_examined_per_scan?"hidden":""),children:(0,n.jsxs)("small",{children:[eV(Number(e.data.rows_examined_per_scan))," rows"]})})]}),(0,n.jsx)("div",{className:"p-2 text-white text-[9pt] border-b rounded-md text-center ".concat(t),children:(0,n.jsx)("small",{children:a})}),(0,n.jsxs)("div",{className:"flex flex-col justify-center text-[8pt] items-center",children:[(0,n.jsx)("div",{children:(0,n.jsx)("small",{children:e.data.table_name})}),(0,n.jsx)("div",{children:(0,n.jsx)("small",{className:"font-bold",children:e.data.key})})]})]})})}function e$(e){let t=e.data.using_filesort?"border-rose-500":"border-yellow-500",a="ORDERING_OPERATION"===e.type?"ORDER":"GROUP",s="ORDERING_OPERATION"===e.type?"filesort":"tmp table";return(0,n.jsxs)(c,{children:[(0,n.jsx)(u,{asChild:!0,children:(0,n.jsxs)("div",{children:[(0,n.jsx)(eG,{type:"source",position:ez.yX.Right,id:e.id,className:"opacity-0 group-hover:opacity-100 w-[10px]! h-[10px]!"}),(0,n.jsx)(eG,{type:"target",position:ez.yX.Left,id:e.id,className:"opacity-0 group-hover:opacity-100 w-[10px]! h-[10px]!"}),(0,n.jsx)("div",{className:"flex flex-row justify-between items-center text-[8pt]",children:(0,n.jsx)("small",{children:s})}),(0,n.jsx)("div",{className:"flex flex-row items-center",children:(0,n.jsx)("div",{className:"max-w-[200px] w-[100px] text-center  p-2 bg-gray-300 text-gray-900 ".concat(t," text-[9pt] border-2 rounded-md py-4"),children:(0,n.jsx)("div",{children:(0,n.jsx)("small",{children:a})})})})]})}),(0,n.jsx)(m,{children:(0,n.jsxs)("div",{children:[e.data.using_temporary_table&&(0,n.jsx)("p",{className:"text-[9pt]!",children:"Using Temporary Table: True"}),(0,n.jsxs)("p",{className:"text-[9pt]!",children:["Using Filesort: ",e.data.using_filesort?"True":"False"]})]})})]})}function e0(e){return(0,n.jsxs)("div",{children:[(0,n.jsx)(eG,{type:"source",position:ez.yX.Right,id:e.id,className:"opacity-0 group-hover:opacity-100 w-[10px]! h-[10px]!"}),(0,n.jsx)(eG,{type:"target",position:ez.yX.Left,id:e.id,className:"opacity-0 group-hover:opacity-100 w-[10px]! h-[10px]!"}),(0,n.jsx)("div",{className:"flex flex-row justify-center max-w-[200px]  p-2 w-[150px] items-center bg-gray-300 text-gray-900 border-gray-900 text-[8pt]",children:(0,n.jsx)("small",{children:e.data.label})})]})}function e1(e){let[t,a]=(0,s.useState)(!0),[r,l,i]=(0,eK.ck)([]),[o,d,c]=(0,eK.fM)([]),u=(0,s.useMemo)(()=>({QUERY_BLOCK:eY,NESTED_LOOP:eJ,TABLE:eZ,ORDERING_OPERATION:e$,GROUP_OPERATION:e$,UNION_RESULT:e0}),[]);return(0,s.useEffect)(()=>{if(t){let t=function e(t,a){var n,s,r,l,i,o,d,c,u,m,h,x;let p=[],f=[],g=new Set,v=new Set,y="query_block".concat(a?"-".concat(a):""),b=t.query_block.table||null,j=t.query_block.ordering_operation||null,N=t.query_block.grouping_operation||(null===(n=t.query_block.ordering_operation)||void 0===n?void 0:n.grouping_operation)||null,w=(null===(s=t.query_block)||void 0===s?void 0:s.union_result)||null,C=t.query_block.nested_loop||[];if(t.query_block&&(p.push({id:"query_block".concat(a?"-".concat(a):""),data:{...t.query_block},type:"QUERY_BLOCK",position:eX}),a&&f.push({id:"union_result-query_block".concat(a?"-".concat(a):""),target:"union_result",source:"query_block-".concat(a),targetHandle:"union_result",sourceHandle:"query_block-".concat(a),type:"smoothstep",markerEnd:{type:ez.TG.ArrowClosed,width:14,height:14},style:{strokeWidth:2},animated:!0})),j&&N&&(y="group_operation",C=(null===(l=t.query_block.ordering_operation)||void 0===l?void 0:null===(r=l.grouping_operation)||void 0===r?void 0:r.nested_loop)||[],b=(null===(o=t.query_block.ordering_operation)||void 0===o?void 0:null===(i=o.grouping_operation)||void 0===i?void 0:i.table)||null,p.push({id:"ordering_operation",data:{...t.query_block.ordering_operation},type:"ORDERING_OPERATION",position:eX,measured:{width:100}}),p.push({id:"group_operation",data:{...null===(d=t.query_block.ordering_operation)||void 0===d?void 0:d.grouping_operation},type:"GROUP_OPERATION",position:eX,measured:{width:100}}),f.push({id:"query_block".concat(a?"-".concat(a):"","-ordering_operation"),target:"query_block",source:"ordering_operation",targetHandle:"query_block",sourceHandle:"ordering_operation",type:"smoothstep",markerEnd:{type:ez.TG.ArrowClosed,width:14,height:14},style:{strokeWidth:2},animated:!0}),f.push({id:"ordering_operation-group_operation",target:"ordering_operation",source:"group_operation",targetHandle:"ordering_operation",sourceHandle:"group_operation",type:"smoothstep",markerEnd:{type:ez.TG.ArrowClosed,width:14,height:14},style:{strokeWidth:2},animated:!0})),j&&!N&&(y="ordering_operation",C=(null===(c=t.query_block.ordering_operation)||void 0===c?void 0:c.nested_loop)||[],b=(null===(u=t.query_block.ordering_operation)||void 0===u?void 0:u.table)||null,p.push({id:"ordering_operation",data:{...t.query_block.ordering_operation},type:"ORDERING_OPERATION",position:eX,measured:{width:100}}),f.push({id:"query_block".concat(a?"-".concat(a):"","-ordering_operation"),target:"query_block",source:"ordering_operation",targetHandle:"query_block",sourceHandle:"ordering_operation",type:"smoothstep",markerEnd:{type:ez.TG.ArrowClosed,width:14,height:14},style:{strokeWidth:2},animated:!0})),!j&&N&&(y="group_operation",C=(null===(m=t.query_block.grouping_operation)||void 0===m?void 0:m.nested_loop)||[],b=(null===(h=t.query_block.grouping_operation)||void 0===h?void 0:h.table)||null,p.push({id:"group_operation",data:{...t.query_block.grouping_operation},type:"GROUP_OPERATION",position:eX,measured:{width:100}}),f.push({id:"query_block".concat(a?"-".concat(a):"","-group_operation"),target:"query_block",source:"group_operation",targetHandle:"query_block",sourceHandle:"group_operation",type:"smoothstep",markerEnd:{type:ez.TG.ArrowClosed,width:14,height:14},style:{strokeWidth:2},animated:!0})),w){let a=[];for(let n of(p.push({id:"query_block",data:{...t.query_block,cost_info:{query_cost:0}},type:"QUERY_BLOCK",position:{x:300,y:-100}}),p.push({id:"union_result",data:{label:"UNION"},type:"UNION_RESULT",position:{x:150,y:-100}}),f.push({id:"query_block-union_result",target:"query_block",source:"union_result",targetHandle:"query_block",sourceHandle:"union_result",type:"smoothstep",markerEnd:{type:ez.TG.ArrowClosed,width:14,height:14},style:{strokeWidth:2},animated:!0}),w.query_specifications)){let t=e(n,n.query_block.select_id||0);a.push(t)}let n=eW([...p,...a.map(e=>e.nodes).flat()],[...f,...a.map(e=>e.edges).flat()],"LR");return{nodes:n.nodes.map(e=>({...e,position:{...e.position,x:e.position.x}})),edges:n.edges}}let k=(C||[]).reverse();if(b)return p.push({id:"".concat(b.table_name).concat(a),data:{...b},type:"TABLE",position:eX}),f.push({id:"".concat(y,"-").concat(b.table_name).concat(a),target:y,source:"".concat(b.table_name).concat(a),targetHandle:y,sourceHandle:"right",type:"smoothstep",markerEnd:{type:ez.TG.ArrowClosed,width:14,height:14},style:{strokeWidth:2},animated:!0}),eW(p,f,"LR");if(!b&&k.length>0){for(let[e,t]of k.entries())p.push({id:"nested_loop_"+e,data:{label:"nested loop",cost_info:{prefix_cost:t.table.cost_info.prefix_cost},target:"nested_loop_".concat(e,"-").concat(t.table.table_name),rows_produced_per_join:t.table.rows_produced_per_join},type:"NESTED_LOOP",position:eX,measured:{width:100,height:50}}),f.push({id:0===e?"".concat(y,"-nested_loop_0"):"nested_loop_".concat(e-1,"-nested_loop_").concat(e),target:0===e?y:"nested_loop_"+(e-1),source:0===e?"nested_loop_0":"nested_loop_"+e,targetHandle:0===e?y:"left",sourceHandle:0===e?"nested_loop_0":"nested_loop_"+e,type:"smoothstep",markerEnd:{type:ez.TG.ArrowClosed,width:14,height:14},style:{strokeWidth:2},animated:!0,label:"0"===t.table.rows_produced_per_join?"":eV(Number(t.table.rows_produced_per_join))+" rows",labelShowBg:!1,labelStyle:{fill:"#AAAAAA",color:"#AAAAAA",transform:"translate(-5%, -5%)"}});let e=eW(p,f,"LR");for(let[t,n]of k.entries()){let s=t===k.length-1?t-1:t,r=e.nodes.find(e=>e.id==="nested_loop_".concat(t));g.add({id:"".concat(n.table.table_name).concat(a),data:{...n.table},type:"TABLE",position:{x:((null==r?void 0:r.position.x)||0)+50,y:((null==r?void 0:r.position.y)||0)+((null==r?void 0:null===(x=r.measured)||void 0===x?void 0:x.height)||0)+100},targetPosition:ez.yX.Top,sourcePosition:ez.yX.Bottom}),v.add({id:"nested_loop_".concat(s,"-").concat(n.table.table_name).concat(a),target:"nested_loop_"+s,source:"".concat(n.table.table_name).concat(a),targetHandle:t===k.length-1||a?"left":"bottom",sourceHandle:a?"right":"".concat(n.table.table_name).concat(a),type:"smoothstep",markerEnd:{type:ez.TG.ArrowClosed,width:14,height:14},style:{strokeWidth:2},animated:!0,label:n.table.lable?n.table.lable:"",labelShowBg:!1,labelStyle:{fill:"#AAAAAA",color:"#AAAAAA",transform:"translate(-5%, -5%)"}})}return{nodes:[...e.nodes.filter((t,a)=>a<e.nodes.length-1),...g],edges:[...e.edges,...v]}}return{nodes:[],edges:[]}}(e.items);l(t.nodes.map(e=>({...e,sourcePosition:e.sourcePosition,targetPosition:e.targetPosition}))),d(t.edges),a(!1)}},[e,t,d,l]),(0,n.jsx)(eK.Gc,{nodes:r,edges:o,onNodesChange:i,onEdgesChange:c,fitView:!0,nodeTypes:u,maxZoom:1,minZoom:1,nodesDraggable:!1})}function e2(e){return(0,n.jsx)(eK.Ln,{children:(0,n.jsx)(e1,{...e})})}eG.displayName="BaseHandle";let e4=eU.z.object({id:eU.z.number(),parent:eU.z.number(),notused:eU.z.number(),detail:eU.z.string()});function e5(e){let t=(0,s.useMemo)(()=>{let t;return t=null,("sqlite"===e.dialect&&(t=eU.z.array(e4).safeParse(e.data.rows.map(e=>({...e,id:Number(e.id),parent:Number(e.parent),notused:Number(e.notused)})))),"mysql"===e.dialect)?{_tag:"SUCCESS",value:JSON.parse(String((e.data.rows||[])[0].EXPLAIN))}:"postgres"===e.dialect?{_tag:"SUCCESS",value:"Postgres dialect is not supported yet"}:(null==t?void 0:t.error)?{_tag:"ERROR",value:t.error}:{_tag:"SUCCESS",value:function(e){let t={},a=[];return e.forEach(e=>{t[e.id]={...e,children:[]}}),e.forEach(e=>{0===e.parent?a.push(t[e.id]):t[e.parent].children.push(t[e.id])}),a}((null==t?void 0:t.data)||[])}},[e]);if("ERROR"===t._tag)return(0,n.jsx)("div",{children:(0,n.jsx)("p",{className:"text-destructive",children:"Something went wrong while trying to display the explanation!"})});let a=t.value;return"sqlite"===e.dialect&&(a=function e(t){let a=t.some(e=>e.detail.includes("UNION")),n=[],s={prefix_cost:0,query_cost:0},r=[];if(a){let a=t.find(e=>0===e.parent);for(let n of t.filter(e=>e.parent===(null==a?void 0:a.id))){let a=e(t.filter(e=>e.parent===n.id));r.push({query_block:{select_id:Number(n.id||0),cost_info:s,id:n.id,table:a.query_block.table,nested_loop:a.query_block.nested_loop,label:n.detail}})}}for(let e of t){let t=function(e){var t,a,n,s;let r=null,l=null,i=null,o=null;return e.includes("SCAN")?(r=(null===(t=e.match(/SCAN (\w+)/))||void 0===t?void 0:t[1])||null,l="ALL"):e.includes("SEARCH")?(r=(null===(a=e.match(/SEARCH (\w+)/))||void 0===a?void 0:a[1])||null,i=(null===(n=e.match(/\((.+)\)/))||void 0===n?void 0:n[1])||null,o=(null===(s=e.match(/USING (\w+) (\w+)/))||void 0===s?void 0:s[2])||null,l="range"):e.includes("USING INDEX")&&(i="Using index"),{table:r,type:l,extra:i,key:o}}(e.detail);if(t.table){let a={table:{id:String(e.id||""),table_name:t.table||"",cost_info:{prefix_cost:0,query_cost:0,read_cost:0,eval_cost:0},rows_produced_per_join:"0",rows_examined_per_scan:"0",access_type:t.type,key:t.key,lable:t.extra}};n.push(a)}}return a?{query_block:{select_id:1,cost_info:s,id:"query_info",union_result:{query_specifications:r}}}:{query_block:{select_id:1,cost_info:{prefix_cost:0,query_cost:0},id:"query_info",table:1===n.length?{...n[0].table}:void 0,nested_loop:n.length>1?n:void 0}}}(e.data.rows)),(0,n.jsx)("div",{className:"p-5 font-mono h-full overflow-y-auto",children:["mysql","sqlite"].includes(e.dialect)?(0,n.jsx)(e2,{items:a}):(0,n.jsx)("p",{className:"text-destructive",children:a})})}function e3(e){let{code:t}=e;return(0,n.jsx)("code",{className:"p-2 bg-secondary block overflow-x-auto w-full text-sm",children:(0,n.jsx)("pre",{children:t})})}function e8(e){let{stats:t}=e;return(0,n.jsxs)("div",{className:"text-xs p-2 flex",children:[null!==t.queryDurationMs&&(0,n.jsxs)("div",{className:"px-2 border-r",children:[(0,n.jsx)("span",{className:"font-semibold",children:"Query Duration"}),":"," ",t.queryDurationMs,"ms"]}),!!t.rowsRead&&(0,n.jsxs)("div",{className:"px-2 border-r",children:[(0,n.jsx)("span",{className:"font-semibold",children:"Rows Read"}),": ",t.rowsRead]}),!!t.rowsWritten&&(0,n.jsxs)("div",{className:"px-2 border-r",children:[(0,n.jsx)("span",{className:"font-semibold",children:"Rows Written"}),":"," ",t.rowsWritten]}),!!t.rowsAffected&&(0,n.jsxs)("div",{className:"px-2 border-r",children:[(0,n.jsx)("span",{className:"font-semibold text-xs",children:"Affected Rows"}),":"," ",t.rowsAffected]})]})}function e6(e){let{progress:t}=e,[,a]=(0,s.useState)(()=>Date.now());(0,s.useEffect)(()=>{if(t.progress<t.total){let e=setInterval(()=>a(Date.now()),200);return()=>clearInterval(e)}},[t]);let r=t.logs.slice(-3).reverse(),l=t.progress,i=t.total,o=i===l||!!t.error;return(0,n.jsxs)("div",{className:"p-4 overflow-hidden",children:[(0,n.jsx)("div",{children:o?(0,n.jsxs)("strong",{children:["Executed ",l,"/",i]}):(0,n.jsxs)("strong",{children:["Executing ",l,"/",i]})}),(0,n.jsx)("div",{className:"flex flex-col gap-4 mt-4",children:r.map(e=>{var t,a;return(0,n.jsxs)("div",{children:[!!e.error&&(0,n.jsx)("div",{className:"mt-2 mb-2 text-red-500 font-mono",children:e.error}),!e.end&&(0,n.jsxs)("div",{className:"text-sm",children:["Executing this query\xa0",(0,n.jsx)("strong",{children:(t=Date.now()-e.start)<1e3?"".concat(t,"ms"):"".concat((t/1e3).toLocaleString(void 0,{maximumFractionDigits:2,minimumFractionDigits:2}),"s")})," ","ago."]}),(0,n.jsx)("div",{className:"mt-3"}),(0,n.jsx)(e3,{code:e.sql}),e.end&&!e.error&&e.stats&&!(!(a=e.stats).queryDurationMs&&!a.rowsAffected&&!a.rowsRead&&!a.rowsWritten)&&(0,n.jsx)("div",{className:"-ml-4",children:(0,n.jsx)(e8,{stats:e.stats})})]},e.order)})})]})}function e9(e){let{data:t}=e,{databaseDriver:a}=x();return(0,n.jsx)("div",{className:"flex flex-col h-full w-full border-t",children:(0,n.jsx)("div",{className:"grow overflow-hidden",children:(0,n.jsx)(e5,{data:t,dialect:a.getFlags().dialect})})})}var e7=a(80532);let te=e7.bL,tt=e7.l9;e7.Mz;let ta=s.forwardRef((e,t)=>{let{className:a,align:s="center",sideOffset:r=4,...l}=e;return(0,n.jsx)(e7.ZL,{children:(0,n.jsx)(e7.UC,{ref:t,align:s,sideOffset:r,className:o("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-hidden data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...l})})});ta.displayName=e7.UC.displayName;var tn=a(852),ts=a(81703);let tr=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(tn.bL,{className:o("grid gap-2",a),...s,ref:t})});tr.displayName=tn.bL.displayName;let tl=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(tn.q7,{ref:t,className:o("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow-sm focus:outline-hidden focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",a),...s,children:(0,n.jsx)(tn.C1,{className:"flex items-center justify-center",children:(0,n.jsx)(ts.A,{className:"h-2.5 w-2.5 fill-current text-current"})})})});tl.displayName=tn.q7.displayName;var ti=a(91014);let to=ti.bL;ti.YJ;let td=ti.WT,tc=s.forwardRef((e,t)=>{let{className:a,children:s,...r}=e;return(0,n.jsxs)(ti.l9,{ref:t,className:o("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-xs ring-offset-background placeholder:text-muted-foreground focus:outline-hidden focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...r,children:[s,(0,n.jsx)(ti.In,{asChild:!0,children:(0,n.jsx)(Y.TBE,{className:"h-4 w-4 opacity-50"})})]})});tc.displayName=ti.l9.displayName;let tu=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(ti.PP,{ref:t,className:o("flex cursor-default items-center justify-center py-1",a),...s,children:(0,n.jsx)(Y.Mtm,{})})});tu.displayName=ti.PP.displayName;let tm=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(ti.wn,{ref:t,className:o("flex cursor-default items-center justify-center py-1",a),...s,children:(0,n.jsx)(Y.D3D,{})})});tm.displayName=ti.wn.displayName;let th=s.forwardRef((e,t)=>{let{className:a,children:s,position:r="popper",...l}=e;return(0,n.jsx)(ti.ZL,{children:(0,n.jsxs)(ti.UC,{ref:t,className:o("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:r,...l,children:[(0,n.jsx)(tu,{}),(0,n.jsx)(ti.LM,{className:o("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,n.jsx)(tm,{})]})})});th.displayName=ti.UC.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(ti.JU,{ref:t,className:o("px-2 py-1.5 text-sm font-semibold",a),...s})}).displayName=ti.JU.displayName;let tx=s.forwardRef((e,t)=>{let{className:a,children:s,...r}=e;return(0,n.jsxs)(ti.q7,{ref:t,className:o("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-hidden focus:bg-accent focus:text-accent-foreground data-disabled:pointer-events-none data-disabled:opacity-50",a),...r,children:[(0,n.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,n.jsx)(ti.VF,{children:(0,n.jsx)(Y.Srz,{className:"h-4 w-4"})})}),(0,n.jsx)(ti.p4,{children:s})]})});tx.displayName=ti.q7.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(ti.wv,{ref:t,className:o("-mx-1 my-1 h-px bg-muted",a),...s})}).displayName=ti.wv.displayName;var tp=a(46195);let tf=(0,X.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),tg=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(tp.b,{ref:t,className:o(tf(),a),...s})});function tv(e,t){return t.map(t=>e[t])}function ty(e,t,a,n){let s=[],r=t.map(eC).join(", ");for(let t of a){let a=t.map(eE).join(", "),n="INSERT INTO ".concat(eC(e),"(").concat(r,") VALUES(").concat(a,");");s.push(n)}let l=s.join("\n");return"clipboard"===n?(tC(l),""):l}function tb(e){if(void 0===e)return"";if(null===e)return"NULL";let t=Number(e);return isNaN(t)?e:t}function tj(e,t,a){let n=JSON.stringify(t.map(e=>e.map(e=>"bigint"==typeof e?e.toString():e)).map(t=>t.reduce((t,a,n)=>{let s=e[n];return void 0!==s&&(t[s]=a),t},{})),null,2);return"clipboard"===a?(tC(n),""):n}function tN(e,t,a,n,s,r){let l=[],i=e.map(e=>eT(e,a,n,s)).join(a);for(let r of(e.length>0&&l.push(i),t)){let e=r.map(e=>eT(e,a,n,s)).join(a);l.push(e)}let o=l.join(n);return"clipboard"===r?(tC(o),""):o}function tw(e){return e.replace(/^"|"$/g,"").replace(/\\n/g,"\n").replace(/\\t/g,"	").replace(/\\\\/g,"\\").replace(/\\r/g,"\r")}function tC(e){navigator.clipboard.writeText(e).then(()=>E.oR.success("Copied to clipboard")).catch(()=>E.oR.error("Failed to copy to clipboard"))}function tk(e){let{data:t}=e,r=(0,s.useMemo)(()=>({fieldSeparator:",",lineTerminator:"\\n",encloser:'"'}),[]),l={fieldSeparator:"\\t",lineTerminator:"\\r\\n",encloser:'"'},i=e=>{localStorage.setItem("export_settings",JSON.stringify(e))},o=(0,s.useCallback)(()=>{let e=localStorage.getItem("export_settings");return e?JSON.parse(e):{format:"csv",target:"clipboard",selection:"complete",options:r}},[r]),[d,c]=(0,s.useState)(o().format),[u,m]=(0,s.useState)(o().target),[h,x]=(0,s.useState)({rows:0,cols:0,ranges:[]}),[p,f]=(0,s.useState)(()=>tS(o().selection,h)),[g,v]=(0,s.useState)(o().options||{fieldSeparator:",",lineTerminator:"\\n",encloser:'"'}),[y,b]=(0,s.useState)(()=>"csv"===d?r:"xlsx"===d?l:"delimited"===d?g:null),[j,N]=(0,s.useState)(h.ranges.length>0?0:-1),[w,C]=(0,s.useState)(!1),k=(0,s.useCallback)(()=>{if(!d)return;let e="",n=function(e,t,n,s,r){let l=aU(e.getSql())||"UnknownTable",i=[],o=[];if("complete"===n)i=e.getHeaders().map(e=>e.name),o=e.getAllRows().map(e=>i.map(t=>e.raw[t]));else if("selected_row"===n)i=e.getHeaders().map(e=>e.name),o=tv(e.getAllRows(),e.getSelectedRowIndex()).map(e=>i.map(t=>e.raw[t]));else if("selected_col"===n)i=e.getHeaders().filter((t,a)=>e.getFullSelectionColsIndex().includes(a)).map(e=>e.name),o=e.getAllRows().map(e=>i.map(t=>e.raw[t]));else if("selected_range"===n&&r>=0){let t=e.getSelectionRanges()[r];i=e.getHeaders().filter((e,a)=>a>=t.x1&&a<=t.x2).map(e=>e.name),o=e.getAllRows().filter((e,a)=>a>=t.y1&&a<=t.y2).map(e=>i.map(t=>e.raw[t]))}return{csv:()=>tN(i,o,",","\n",'"',t),json:()=>tj(i,o,t),sql:()=>ty(l,i,o,t),xlsx:()=>(function(e,t,n,s){if("clipboard"===s)return tN(t,e,"	","\r\n",'"',"clipboard"),"";let r=[t,...e.map(e=>e.map(e=>tb(e)))];return Promise.all([a.e(524),a.e(436)]).then(a.bind(a,7660)).then(e=>{let t=e.utils.book_new(),a=e.utils.aoa_to_sheet(r);e.utils.book_append_sheet(t,a,"sheet1"),e.writeFile(t,"".concat(n,".xlsx"))}),""})(o,i,l,t),delimited:()=>tN(i,o,tw((null==s?void 0:s.fieldSeparator)||"")||",",tw((null==s?void 0:s.lineTerminator)||"")||"\n",tw((null==s?void 0:s.encloser)||"")||'"',t)}}(t,u,p,y,j)[d];if(n&&(e=n()),C(!1),!e)return;let s=new Blob([e],{type:"text/plain;charset=utf-8"}),r=URL.createObjectURL(s),l=document.createElement("a");l.href=r,l.download="export.".concat("delimited"===d?"csv":d),l.click(),URL.revokeObjectURL(r)},[d,t,u,p,y,j]);return(0,s.useEffect)(()=>{let e=()=>{x({rows:t.getFullSelectionRowsIndex().length,cols:t.getFullSelectionColsIndex().length,ranges:t.getSelectionRanges()}),t.getSelectionRanges().length>0&&N(0)};return t.addChangeListener(e),()=>t.removeChangeListener(e)},[t]),(0,s.useEffect)(()=>{f(tS(o().selection,h))},[o,h]),(0,s.useEffect)(()=>{i({...o(),format:d,selection:p,target:u}),"delimited"===d&&(i({...o(),options:null!=y?y:r}),y&&v(y))},[r,y,p,o,u,d]),(0,n.jsxs)(te,{open:w,onOpenChange:C,children:[(0,n.jsx)(tt,{children:(0,n.jsx)("div",{className:V({variant:"ghost",size:"sm"}),onClick:()=>C(!w),children:"Export"})}),(0,n.jsxs)(ta,{className:"p-0 min-w[550px] w-[550px]",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"border-b p-4 flex flex-col gap-2",children:[(0,n.jsx)("h1",{className:"font-bold text-lg",children:"Export"}),(0,n.jsx)("small",{children:"Export target"}),(0,n.jsxs)(tr,{className:"flex gap-4",defaultValue:u,onValueChange:e=>{m(e)},children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(tl,{value:"clipboard",id:"export-clipboard"}),(0,n.jsx)(tg,{htmlFor:"export-clipboard",children:"Copy to clipboard"})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(tl,{value:"file",id:"export-file"}),(0,n.jsx)(tg,{htmlFor:"export-file",children:"Export to file"})]})]})]}),(0,n.jsxs)("div",{className:"flex grow border-b mb-2",children:[(0,n.jsxs)("div",{className:"flex flex-col px-4 p-2 border-r",children:[(0,n.jsx)("small",{children:"Output format"}),(0,n.jsxs)(tr,{className:"mt-2 flex flex-col gap-3",defaultValue:d,onValueChange:e=>{c(e),"csv"===e?b(r):"xlsx"===e?b(l):"delimited"===e?b(g):b(null)},children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(tl,{value:"csv",id:"export-format-csv"}),(0,n.jsx)(tg,{htmlFor:"export-format-csv",className:"flex-1 font-normal",children:"CSV"})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(tl,{value:"delimited",id:"export-format-delimit"}),(0,n.jsx)(tg,{htmlFor:"export-format-delimit",className:"flex-1 font-normal",children:"Delimited Text"})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(tl,{value:"json",id:"export-format-json"}),(0,n.jsx)(tg,{htmlFor:"export-format-json",className:"flex-1 font-normal",children:"JSON"})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(tl,{value:"sql",id:"export-format-sql"}),(0,n.jsx)(tg,{htmlFor:"export-format-sql",className:"flex-1 font-normal",children:"SQL"})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(tl,{value:"xlsx",id:"export-format-xlsx"}),(0,n.jsx)(tg,{htmlFor:"export-format-xlsx",className:"flex-1 font-normal",children:"Excel"})]})]})]}),(0,n.jsxs)("div",{className:"grow",children:[(0,n.jsxs)("div",{className:"flex grow px-4 p-2 flex-col border-b",children:[(0,n.jsx)("small",{children:"Selection"}),(0,n.jsx)("div",{children:(0,n.jsxs)(tr,{className:"my-2 gap-3",defaultValue:p,onValueChange:e=>{f(e)},children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(tl,{value:"complete",id:"export-selection-complete"}),(0,n.jsxs)(tg,{htmlFor:"export-selection-complete",className:"flex-1 font-normal",children:["Complete (",t.getAllRows().length," rows)"]})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(tl,{value:"selected_row",id:"export-selection-rows",disabled:0===h.rows}),(0,n.jsxs)(tg,{htmlFor:"export-selection-rows",className:"flex-1 font-normal",children:["Rows (",h.rows," rows)"]})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(tl,{value:"selected_col",id:"export-selection-cols",disabled:0===h.cols}),(0,n.jsxs)(tg,{htmlFor:"export-selection-cols",className:"flex-1 font-normal",children:["Columns (",h.cols," cols)"]})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(tl,{value:"selected_range",id:"export-selection-range",disabled:0===h.ranges.length}),(0,n.jsx)(tg,{htmlFor:"export-selection-range",className:"flex-1 font-normal",children:"Ranges"})]}),h.ranges.length>0&&(0,n.jsx)(e=>{let{ranges:t,value:a,onChange:s}=e;return(0,n.jsxs)(to,{value:a,onValueChange:s,children:[(0,n.jsx)(tc,{className:"ml-5 w-[200px]",children:(0,n.jsx)(td,{})}),(0,n.jsx)(th,{children:t.map((e,t)=>{let a=e?"Col(".concat(e.x1+1,", ").concat(e.x2+1,") - Row(").concat(e.y1+1,", ").concat(e.y2+1,")"):"";return(0,n.jsx)(tx,{value:t.toString(),children:(0,n.jsx)("small",{children:a})},t)})})]})},{ranges:h.ranges,value:j>0?j.toString():"0",onChange:e=>{N(parseInt(e))}})]})})]}),(0,n.jsxs)("div",{className:"flex grow ml-2 p-2 flex-col",children:[(0,n.jsx)("small",{children:"Options"}),(0,n.jsxs)("div",{className:"flex flex-col space-y-2 mt-2",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsx)("span",{className:"w-[120px] text-sm",children:"Field separator:"}),(0,n.jsx)("div",{className:"flex items-center rounded-md bg-white px-3 py-2.5 text-base text-neutral-900 outline outline-1 outline-neutral-200 focus:outline-neutral-400/70 dark:bg-neutral-900 dark:text-white dark:outline-neutral-800 dark:focus:outline-neutral-600 h-[28px] w-[120px]",children:(0,n.jsx)("input",{disabled:"delimited"!==d,type:"text",className:"bg-transparent flex-1 outline-hidden text-sm font-light",value:(null==y?void 0:y.fieldSeparator)||"",onChange:e=>{b({...y,fieldSeparator:e.target.value})}})})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsx)("span",{className:"w-[120px] text-sm",children:"Line terminator:"}),(0,n.jsx)("div",{className:"flex items-center rounded-md bg-white px-3 py-2.5 text-base text-neutral-900 outline outline-1 outline-neutral-200 focus:outline-neutral-400/70 dark:bg-neutral-900 dark:text-white dark:outline-neutral-800 dark:focus:outline-neutral-600 h-[28px] w-[120px]",children:(0,n.jsx)("input",{disabled:"delimited"!==d,type:"text",className:"bg-transparent flex-1 outline-hidden text-sm font-light",value:(null==y?void 0:y.lineTerminator)||"",onChange:e=>{b({...y,lineTerminator:e.target.value})}})})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsx)("span",{className:"w-[120px] text-sm",children:"Encloser:"}),(0,n.jsx)("div",{className:"flex items-center rounded-md bg-white px-3 py-2.5 text-base text-neutral-900 outline outline-1 outline-neutral-200 focus:outline-neutral-400/70 dark:bg-neutral-900 dark:text-white dark:outline-neutral-800 dark:focus:outline-neutral-600 h-[28px] w-[120px]",children:(0,n.jsx)("input",{disabled:"delimited"!==d,type:"text",className:"bg-transparent flex-1 outline-hidden text-sm font-light",value:(null==y?void 0:y.encloser)||"",onChange:e=>{b({...y,encloser:e.target.value})}})})]})]})]})]})]})]}),(0,n.jsx)("div",{className:"p-2 pt-0 px-4",children:(0,n.jsx)(W,{size:"sm",onClick:k,children:"Export"})})]})]})}function tS(e,t){return e&&("selected_row"!==e||0!==t.rows)&&("selected_col"!==e||0!==t.cols)&&("selected_range"!==e||0!==t.ranges.length)?e:"complete"}function tE(e){let{children:t,colCount:a,rowHeight:s,rowCount:r,rowStart:l,rowEnd:i}=e,o=l*s,d=(r-i)*s;return(0,n.jsxs)("tbody",{children:[!!o&&(0,n.jsx)("tr",{children:(0,n.jsx)("td",{style:{height:o,gridColumn:"span ".concat(a+1)}})},"padding-top"),t,!!d&&(0,n.jsx)("tr",{children:(0,n.jsx)("td",{style:{height:d,gridColumn:"span ".concat(a+1)}})},"padding-bottom")]})}function tR(e){let{colStart:t,colEnd:a}=e;return a-t>0?(0,n.jsx)("td",{style:{gridColumn:"span ".concat(a-t)}}):(0,n.jsx)(n.Fragment,{})}function tT(e){let{idx:t,onResize:a}=e,r=(0,s.useRef)(null),[l,i]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{if(r.current&&l){var e,n,s,o,d;let l=null===(o=r.current)||void 0===o?void 0:null===(s=o.parentNode)||void 0===s?void 0:null===(n=s.parentNode)||void 0===n?void 0:null===(e=n.parentNode)||void 0===e?void 0:e.parentNode,c=null===(d=l.parentNode)||void 0===d?void 0:d.parentNode,u=-100;if(l&&c){let e=e=>requestAnimationFrame(()=>{var n;if(u<0){u=e.clientX;return}let s=c.getBoundingClientRect().right-e.clientX>0?1:-1,i=3>Math.abs(c.getBoundingClientRect().right-e.clientX),o=0;o=i?2*s:e.clientX-u;let d=(null===(n=r.current)||void 0===n?void 0:n.parentNode).getBoundingClientRect().width,m=d;if(d+o>=100?m=d+o:(m=100,o=0),u=e.clientX,i&&(c.scrollLeft+=o),a(t,m),l){let e=l.style.gridTemplateColumns.split(" ");e[t]=m+"px",l.style.gridTemplateColumns=e.join(" ")}i&&(c.scrollLeft+=o)}),n=()=>{i(!1)};return document.addEventListener("mousemove",e),document.addEventListener("mouseup",n),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",n)}}}},[r,t,l,i,a]),(0,n.jsx)("div",{className:"libsql-resizer",ref:r,onMouseDown:()=>i(!0)})}function tA(e){let{idx:t,header:a,onHeaderResize:s,onContextMenu:r,sticky:l,renderHeader:i,state:d}=e,c=o(l?"sticky z-30":void 0,"bg-background");return(0,n.jsxs)("th",{title:a.display.tooltip,className:c,onContextMenu:r,style:{left:l?d.gutterColumnWidth:void 0},children:[i(a,t),a.setting.resizable&&(0,n.jsx)(tT,{idx:t+1,onResize:s})]},a.name)}function t_(e){let{headers:t,onHeaderResize:a,renderHeader:s,sticky:r,onHeaderContextMenu:l,state:i}=e;return(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"sticky left-0 z-30 bg-zinc-100 dark:bg-zinc-900",children:(0,n.jsx)("div",{className:"libsql-table-cell flex h-full items-center justify-end pr-2 font-mono font-bold",children:"#"})}),t.map((e,t)=>(0,n.jsx)(tA,{sticky:r&&0===t,header:e,renderHeader:s,idx:t,onHeaderResize:a,state:i,onContextMenu:t=>{l&&(l(t,e),t.stopPropagation())}},e.name))]})})}tg.displayName=tp.b.displayName;var tL=a(92098);let tI=tL.bL,tF=tL.l9,tM=s.forwardRef((e,t)=>{let{className:a,align:s="center",sideOffset:r=4,...l}=e;return(0,n.jsx)(tL.UC,{ref:t,align:s,sideOffset:r,className:o("z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-hidden data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...l})});tM.displayName=tL.UC.displayName;let tD=["jpg","jpeg","png","pneg","svg","bmp","gif"];function tO(e){let{link:t}=e,a=t.split(".").pop(),s=tD.includes((null!=a?a:"").toLowerCase());return(0,n.jsx)("div",{className:"flex w-full",children:(0,n.jsxs)(tI,{children:[(0,n.jsx)(tF,{target:"_blank",className:"text-blue-600 dark:text-blue-300 underline flex-1 text-ellipsis overflow-hidden whitespace-nowrap",children:t}),(0,n.jsx)(tM,{side:"bottom",align:"start",className:"min-w-[300px]",children:(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[s&&(0,n.jsx)("div",{className:"p-2 bg-gray-600 dark:bg-gray-800 rounded justify-center items-center flex",children:(0,n.jsx)("img",{src:t,alt:"",className:"object-contain w-[200px] h-[200px]"})}),(0,n.jsx)("div",{className:"font-mono text-sm line-clamp-3 truncate break-all w-[250px] whitespace-normal",children:t}),(0,n.jsx)("div",{children:(0,n.jsx)("a",{target:"_blank",className:"inline-block",href:t,rel:"noreferrer",children:(0,n.jsx)(W,{children:"Open Link"})})})]})})]})})}var tq=a(41240),tU=a(66121);function tK(e){let{fkSchemaName:t,fkTableName:a,fkColumnName:r,value:l}=e,{databaseDriver:i}=x(),[d,c]=(0,s.useState)();return((0,s.useEffect)(()=>{i.findFirst(t,a,{[r]:l}).then(c).catch(console.error)},[i,t,a,r,l]),d)?0===d.rows.length?(0,n.jsx)("div",{children:"Data not found"}):(0,n.jsx)("div",{className:"flex grow flex-col gap-3 p-4",children:d.headers.map(e=>{let t=d.rows[0][e.name],a="";return(""===t||null===t)&&(a="text-gray-400 dark:text-gray-600"),"string"==typeof t&&(a="text-orange-500"),("bigint"==typeof t||"number"==typeof t)&&(a="text-blue-600 dark:text-blue-300"),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"mb-1 font-mono text-xs text-gray-400",children:e.displayName}),(0,n.jsx)("div",{className:o("line-clamp-1 block w-[350px] overflow-hidden text-ellipsis whitespace-nowrap font-mono text-sm",a),children:(null===t?"NULL":"string"==typeof t?t:"bigint"==typeof t||"number"==typeof t?t.toString():t instanceof ArrayBuffer||t instanceof Uint8Array?btoa(new Uint8Array(t).reduce((e,t)=>e+String.fromCharCode(t),"")):"")||"EMPTY"})]},e.name)})}):(0,n.jsxs)("div",{className:"p-4 text-sm",children:[(0,n.jsx)(tq.A,{className:"animate-spin"}),(0,n.jsx)("p",{children:"Loading..."})]})}function tz(e){let[t,a]=(0,s.useState)(!1);return(0,n.jsxs)(te,{onOpenChange:a,children:[(0,n.jsx)(tt,{children:(0,n.jsx)(tU.A,{className:"h-4 w-4 text-gray-400 hover:text-blue-600"})}),(0,n.jsx)(ta,{side:"right",className:"m-0 w-[400px] overflow-hidden p-0",children:(0,n.jsxs)("div",{className:"flex h-full w-full flex-col overflow-hidden",children:[(0,n.jsx)("div",{className:"border-b px-4 py-2",children:(0,n.jsx)("strong",{children:e.fkTableName})}),(0,n.jsx)("div",{className:"max-h-[300px] grow overflow-y-auto overflow-x-hidden",children:t&&(0,n.jsx)(tK,{...e})})]})})]})}function tB(e){return[...e].map(e=>92===e?"\\\\":e>=32&&127!==e?String.fromCharCode(e):"\\x"+e.toString(16).toUpperCase().padStart(2,"0")).join("")}function tP(e){let{value:t,vector:a}=e;if(a){let e=new Float32Array(new Uint8Array(t).buffer),a=e.join(", ");return(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("div",{className:"mr-2 flex-col items-center justify-center",children:(0,n.jsxs)("span",{className:"inline rounded bg-blue-500 p-1 pl-2 pr-2 text-white",children:["vec(",e.length,")"]})}),(0,n.jsxs)("div",{className:"text-orange-600",children:["[",a,"]"]})]})}{let e=new Uint8Array(t);return(0,n.jsxs)("div",{className:"flex w-full",children:[(0,n.jsx)("span",{className:"flex-1 overflow-hidden text-ellipsis whitespace-nowrap text-orange-600 dark:text-orange-400",children:tB(e.subarray(0,64))}),(0,n.jsx)("div",{className:"ml-2 flex-col items-center justify-center",children:(0,n.jsxs)("span",{className:"inline rounded bg-blue-500 p-1 pl-2 pr-2 text-white",children:[e.length.toLocaleString(void 0,{maximumFractionDigits:0})," bytes"]})})]})}}function tH(e){let{value:t,onFocus:a,align:r,onDoubleClick:l,header:i}=e,d=o("libsql-cell font-mono flex","pl-2 pr-2"),c=o("flex grow text-gray-500","right"===r?"justify-end":""),u=(0,s.useMemo)(()=>i.metadata.referenceTo&&void 0!==t?(0,n.jsx)("div",{className:"ml-2 flex shrink-0 cursor-pointer items-center",children:(0,n.jsx)(tz,{fkSchemaName:i.metadata.referenceTo.schema,fkColumnName:i.metadata.referenceTo.column,fkTableName:i.metadata.referenceTo.table,value:t})}):null,[i,t]),m=(0,s.useMemo)(()=>{var e,a,s,r,l;return null===t?(0,n.jsx)("span",{className:c,children:"NULL"}):void 0===t?(0,n.jsx)("span",{className:c,children:null!==(s=null===(a=i.metadata.columnSchema)||void 0===a?void 0:null===(e=a.constraint)||void 0===e?void 0:e.generatedExpression)&&void 0!==s?s:"DEFAULT"}):"string"==typeof t?!function(e){if(e.length>200)return!1;try{return["http:","https:"].includes(new URL(e).protocol)}catch(e){return!1}}(t)?(0,n.jsx)("span",{className:o("flex-1 overflow-hidden text-ellipsis whitespace-nowrap","text-green-600 dark:text-green-500"),children:t}):(0,n.jsx)(tO,{link:t}):"number"==typeof t||"bigint"==typeof t?(0,n.jsx)("span",{className:o("flex-1 overflow-hidden text-ellipsis whitespace-nowrap","block grow text-right text-blue-700 dark:text-blue-300"),children:t.toString()}):t instanceof ArrayBuffer||t instanceof Uint8Array||Array.isArray(t)?(0,n.jsx)(tP,{value:t,vector:(null===(r=i.metadata.originalType)||void 0===r?void 0:r.includes("F32_BLOB"))||(null===(l=i.metadata.originalType)||void 0===l?void 0:l.includes("FLOAT32 "))}):(0,n.jsx)("span",{children:t.toString()})},[t,c,i]);return(0,n.jsxs)("div",{className:d,onMouseDown:a,onDoubleClick:l,children:[(0,n.jsx)("div",{className:"flex grow overflow-hidden",children:m}),u]})}var tX=a(90434);let tV=s.forwardRef((e,t)=>{let{className:a,orientation:s="horizontal",decorative:r=!0,...l}=e;return(0,n.jsx)(tX.b,{ref:t,decorative:r,orientation:s,className:o("shrink-0 bg-border","horizontal"===s?"h-[1px] w-full":"h-full w-[1px]",a),...l})});tV.displayName=tX.b.displayName;var tW=a(66217);let tG=tW.bL;tW.l9,tW.bm;let tY=tW.ZL,tQ=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(tW.hJ,{className:o("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...s,ref:t})});tQ.displayName=tW.hJ.displayName;let tJ=(0,X.F)("fixed z-50 gap-4 bg-card p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),tZ=s.forwardRef((e,t)=>{let{side:a="right",className:s,hideCloseButton:r,children:l,...i}=e;return(0,n.jsxs)(tY,{children:[(0,n.jsx)(tQ,{}),(0,n.jsxs)(tW.UC,{ref:t,className:o(tJ({side:a}),s),...i,children:[l,!r&&(0,n.jsxs)(tW.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-hidden focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,n.jsx)(Y.MKb,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});tZ.displayName=tW.UC.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(tW.hE,{ref:t,className:o("text-lg font-semibold text-foreground",a),...s})}).displayName=tW.hE.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(tW.VY,{ref:t,className:o("text-sm text-muted-foreground",a),...s})}).displayName=tW.VY.displayName;var t$=a(76752),t0=a(20815);let t1=(0,s.forwardRef)(function(e,t){let{value:a,onChange:r,readOnly:l}=e,i=function(){let{resolvedTheme:e,forcedTheme:t}=(0,B.D)();return(0,s.useMemo)(()=>(null!=t?t:e)==="light"?(0,z.A)({theme:"light",settings:{background:"#FFFFFF",foreground:"#000000",caret:"#FBAC52",selection:"#FFD420",selectionMatch:"#FFD420",gutterBackground:"#fff",gutterForeground:"#4D4D4C",gutterBorder:"transparent",lineHighlight:"#00000012",fontFamily:'Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace'},styles:[{tag:[K._A.propertyName],color:"#4078F2"},{tag:[K._A.bool,K._A.null],color:"#696C77"},{tag:[K._A.number],color:"#FF0080"},{tag:[K._A.string],color:"#50A14F"},{tag:[K._A.separator],color:"#383A42"},{tag:[K._A.squareBracket],color:"#383A42"},{tag:[K._A.brace],color:"#A626A4"}]}):(0,z.A)({theme:"dark",settings:{background:"var(--background)",foreground:"#9cdcfe",caret:"#c6c6c6",selection:"#6199ff2f",selectionMatch:"#72a1ff59",lineHighlight:"#ffffff0f",gutterBackground:"var(--background)",gutterForeground:"#838383",gutterActiveForeground:"#fff",fontFamily:'Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace'},styles:[{tag:[K._A.propertyName],color:"#4078F2"},{tag:[K._A.bool,K._A.null],color:"#696C77"},{tag:[K._A.number],color:"#f39c12"},{tag:[K._A.string],color:"#50A14F"},{tag:[K._A.separator],color:"#383A42"},{tag:[K._A.squareBracket],color:"#383A42"},{tag:[K._A.brace],color:"#A626A4"}]}),[e,t])}();return(0,n.jsx)(y.Ay,{ref:t,autoFocus:!0,readOnly:l,basicSetup:{drawSelection:!1,lineNumbers:!1},theme:i,value:a,height:"100%",onChange:r,style:{fontSize:20,height:"100%"},extensions:[(0,t$.Pq)(),(0,t0.h)()]})}),t2=(0,s.createContext)({openEditor:ed(),closeEditor:ed()});function t4(e){let{option:t}=e,[a,r]=(0,s.useState)(()=>{if("json"===t.format)try{return JSON.stringify(JSON.parse(t.initialValue),void 0,2)}catch(e){}return t.initialValue});return(0,n.jsx)(tG,{open:!0,children:(0,n.jsx)(tZ,{hideCloseButton:!0,className:"border-none sm:max-w-[1000px] sm:w-[70vw] overflow-hidden flex p-0",children:(0,n.jsxs)("div",{className:"flex flex-col grow overflow-hidden",children:[(0,n.jsxs)("div",{className:"p-4 flex gap-2",children:[(0,n.jsx)("div",{className:"grow"}),(0,n.jsx)(W,{onClick:t.onCancel,variant:"destructive",children:"Close"}),(0,n.jsx)(W,{onClick:()=>{if("json"===t.format)try{t.onSave(JSON.stringify(JSON.parse(a)))}catch(e){t.onSave(a)}else t.onSave(a)},children:"Save Change"})]}),(0,n.jsx)(tV,{}),"text"===t.format&&(0,n.jsx)("textarea",{autoFocus:!0,className:"grow p-4 w-full outline-hidden bg-inherit font-mono",value:a,onChange:e=>r(e.currentTarget.value),readOnly:t.readOnly}),"json"===t.format&&(0,n.jsx)("div",{className:"grow overflow-hidden",children:(0,n.jsx)(t1,{value:a,onChange:r,readOnly:t.readOnly})})]})})})}function t5(){return(0,s.useContext)(t2)}function t3(e){let{children:t}=e,[a,r]=(0,s.useState)(null),l=(0,s.useMemo)(()=>({openEditor:e=>{r({initialValue:e.initialValue,format:e.format,readOnly:e.readOnly,onCancel:()=>{e.onCancel&&e.onCancel(),r(null)},onSave:t=>{e.onSave&&e.onSave(t),r(null)}})},closeEditor:()=>{r(null)}}),[r]);return(0,n.jsxs)(t2.Provider,{value:l,children:[a&&(0,n.jsx)(t4,{option:a}),(0,n.jsx)(s.Fragment,{children:t})]})}function t8(e){let{value:t,align:a,discardChange:r,readOnly:l,applyChange:i,onChange:o,state:d}=e,c=(0,s.useRef)(null),u=(0,s.useRef)(!0);return(0,s.useEffect)(()=>{c.current&&(c.current.select(),c.current.focus())},[c]),(0,n.jsx)("input",{ref:c,autoFocus:!0,readOnly:l,onBlur:()=>{i(t,u.current)},onChange:e=>{o(e.currentTarget.value)},onKeyDown:e=>{if("Enter"===e.key)i(t),e.stopPropagation();else if("Escape"===e.key)r();else if("Tab"===e.key){let a=d.getFocus();if(a){let n=d.getHeaderCount(),s=a.y*n+a.x+1,r=s%n,l=Math.floor(s/n);if(l>=d.getRowsCount())return;u.current=!1,i(t,!1),d.setFocus(l,r),d.scrollToCell(0===r?"left":"right","bottom",a),e.preventDefault(),e.stopPropagation()}}},type:"text",className:"right"===a?"h-full w-full border-0 bg-inherit pl-2 pr-2 text-right font-mono outline-hidden":"h-full w-full border-0 bg-inherit pl-2 pr-2 font-mono outline-hidden",value:null!=t?t:""})}function t6(e){let{toString:t,toValue:a,align:r}=e;return function(e){let{value:l,valueType:i,focus:d,onChange:c,state:u,editor:m,editMode:h,header:x}=e,[p,f]=(0,s.useState)(t(l)),{openEditor:g}=t5();(0,s.useEffect)(()=>{f(t(l))},[l]);let v=(0,s.useCallback)(function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];c&&c(a(e)),t&&u.exitEditMode()},[c,u]),y=(0,s.useCallback)(()=>{f(t(l)),u.exitEditMode()},[f,u,l]);return!x.setting.readonly&&h&&(void 0===m||"input"===m)?(0,n.jsx)("div",{className:o("libsql-cell flex"),children:(0,n.jsx)(t8,{state:u,readOnly:u.getReadOnlyMode(),align:r,applyChange:v,discardChange:y,onChange:f,value:p})}):(0,n.jsx)(tH,{header:x,value:a(p),valueType:i,focus:d,align:r,onDoubleClick:()=>{"string"==typeof p&&("json"===m||"text"===m)&&g({format:m,initialValue:p,readOnly:u.getReadOnlyMode(),onCancel:()=>u.exitEditMode(),onSave:v}),u.enterEditMode()}})}}let t9=t6({toString:e=>e,toValue:e=>e}),t7=t6({align:"right",toString:e=>null===e?null:void 0!==e?e.toString():void 0,toValue:e=>{if(null===e)return null;if(void 0===e)return;if(""===e)return null;let t=Number(e);return Number.isFinite(t)?t:null}}),ae=t6({align:"right",toString:e=>null===e?null:void 0!==e?e.toString():void 0,toValue:e=>{if(null===e)return null;if(void 0!==e){if(""===e)return null;try{return BigInt(e)}catch(e){return null}}}}),at=t6({toString:e=>null===e?null:void 0!==e?tB(Uint8Array.from(null!=e?e:[])):void 0,toValue:e=>null===e?null:void 0!==e?""===e?null:[...e.matchAll(/(\\\\)|\\x([0-9a-f]{2})|(.)/gi)].map(e=>{let[,t,a,n]=e;return void 0!==t?92:void 0!==n?n.codePointAt(0):parseInt(a,16)}):void 0});function aa(e){let{state:t,header:a,rowIndex:r,colIndex:l}=e,{isFocus:i,isSelected:d,isBorderBottom:c,isBorderRight:u}=t.getCellStatus(r,l),m=t.isRemovedRow(r),h=t.isNewRow(r),x=t.hasCellChange(r,l),p=a.sticky,f=(0,s.useMemo)(()=>{if(p)return{zIndex:15,left:t.gutterColumnWidth+"px"}},[t.gutterColumnWidth,p]),g="bg-background";d?g=m?"bg-red-200 dark:bg-red-800":x?"bg-yellow-200 dark:bg-orange-600":h?"bg-green-200 dark:bg-green-700":"bg-blue-100 dark:bg-sky-900":x?g="bg-yellow-100 dark:bg-orange-700":h?g="bg-green-100 dark:bg-green-900":m&&(g="bg-red-100 dark:bg-red-900");let v=o("box-border",d&&"border-blue-300 dark:border-blue-500",c&&"border-b border-b-blue-500",u&&"border-r border-r-blue-500",i&&"shadow-[0_0_0_1px_rgba(0,0,255,0.5)_inset]",p&&"sticky",g),y=o("libsql-table-cell");return(0,n.jsx)("td",{className:v,style:f,onMouseDown:e=>{let a=e.shiftKey,n=t.getFocus();2===e.button&&t.getCellStatus(r,l).isSelected||(a&&n?t.selectCellRange(n.y,n.x,r,l):e.ctrlKey?t.addSelectionRange(r,l,r,l):t.selectCell(r,l))},children:(0,n.jsx)("div",{className:y,children:function(e){let{y:t,x:a,state:s,header:r,isFocus:l}=e,i=l&&s.isInEditMode(),o=s.getValue(t,a),d=function(e){if(null!==e){if("bigint"==typeof e)return ew.$C.INTEGER;if("number"==typeof e)return ew.$C.REAL;if("string"==typeof e)return ew.$C.TEXT;if("object"==typeof e)return ew.$C.BLOB}}(o);switch(null!=d?d:r.metadata.type){case ew.$C.INTEGER:return(0,n.jsx)(ae,{header:r,state:s,editMode:i,value:o,valueType:d,focus:l,onChange:e=>{s.changeValue(t,a,e)}});case ew.$C.REAL:return(0,n.jsx)(t7,{header:r,state:s,editMode:i,value:o,valueType:d,focus:l,onChange:e=>{s.changeValue(t,a,e)}});case ew.$C.TEXT:return(0,n.jsx)(t9,{header:r,state:s,editor:function(e){if("string"!=typeof e)return"input";let t=e.trim();return"{"===t.substring(0,1)&&"}"===t.substring(t.length-1)&&void 0!==function(e,t){if(!e)return t;try{return JSON.parse(e)}catch(e){return t}}(t,void 0)?"json":e.length>200||e.search(/[\n\r]/)>=0?"text":"input"}(o),editMode:i,value:o,valueType:d,focus:l,onChange:e=>{s.changeValue(t,a,e)}});case ew.$C.BLOB:return(0,n.jsx)(at,{header:r,state:s,editMode:i,valueType:d,value:o,focus:l,onChange:e=>{s.changeValue(t,a,e)}});default:return(0,n.jsx)(tH,{value:o,header:r})}}({x:l,y:r,state:t,header:a,isFocus:i})})})}function an(e){let{stickyHeaderIndex:t,internalState:a,renderHeader:r,rowHeight:l,renderAhead:i,onContextMenu:d,onHeaderContextMenu:c,onKeyDown:u,arrangeHeaderIndex:m}=e,h=(0,s.useRef)(null),[x,p]=(0,s.useState)(1),f=(0,s.useCallback)(()=>{p(e=>e+1)},[p]);(0,s.useEffect)(()=>{a.setContainer(h.current)},[a,h]),(0,s.useEffect)(()=>{let e=()=>{f()};return a.addChangeListener(e),()=>a.removeChangeListener(e)},[a,f]);let g=(0,s.useMemo)(()=>{let e=a.getHeaders().map((e,a)=>({...e,index:a,sticky:a===t})),n=m.map(t=>e[t]);return[...void 0!==t?[e[t]]:[],...n.filter(e=>e.index!==t)]},[a,m,t]),{visibileRange:v,onHeaderResize:y}=function(e){let{containerRef:t,totalRowCount:a,rowHeight:n,renderAhead:r,headers:l,state:i}=e,[o,d]=(0,s.useState)({rowStart:0,rowEnd:0,colStart:0,colEnd:0}),c=(0,s.useCallback)(e=>{let t=i.getHeaderWidth();d(function(e,t,a,n,s,r){let l=Math.max(0,Math.floor(e.scrollTop/n)-1-s),i=Math.min(a,l+Math.ceil(e.getBoundingClientRect().height/n)+s),o=-1,d=r,c=-1,u=e.scrollLeft,m=u+e.getBoundingClientRect().width;for(let e=0;e<t.length;e++){var h;if(d>=u&&o<0&&(o=e-1),(d+=null!==(h=t[e])&&void 0!==h?h:0)>=m&&c<0){c=e;break}}return c<0&&(c=t.length-1),o<0&&(o=0),c>=t.length&&(c=t.length-1),{colStart:o,colEnd:c,rowStart:l,rowEnd:i}}(e,l.map(e=>t[e.index]),a,n,r,i.gutterColumnWidth))},[d,a,n,r,l,i]),u=(0,s.useCallback)((e,a)=>{t.current&&(i.setHeaderWidth(e,a),c(t.current))},[i,c,t]);return(0,s.useEffect)(()=>{let e=t.current;if(e){let a=e=>{c(e.currentTarget),e.preventDefault(),e.stopPropagation()};return t.current.addEventListener("scroll",a),()=>e.removeEventListener("scroll",a)}},[t,c]),(0,s.useEffect)(()=>{t.current&&c(t.current)},[t,c]),(0,s.useEffect)(()=>{if(t.current){let e=new ResizeObserver(e=>{for(let t of e)c(t.target)});return e.observe(t.current),()=>e.disconnect()}},[t,c]),{visibileRange:o,onHeaderResize:u}}({containerRef:h,headers:g,renderAhead:i,rowHeight:l,totalRowCount:a.getRowsCount(),state:a}),{rowStart:b,rowEnd:j,colEnd:N,colStart:w}=v;return(0,s.useMemo)(()=>(0,n.jsx)("div",{tabIndex:-1,onKeyDown:e=>{u&&u(a,e)},ref:h,style:{outline:"none"},className:"libsql-table",onContextMenu:e=>{d&&d({state:a,event:e}),e.preventDefault()},children:(0,n.jsx)("div",{style:{height:(a.getRowsCount()+1)*l+10},children:function(e){let{hasSticky:t,customStyles:a,headers:s,rowEnd:r,rowStart:l,colEnd:i,colStart:d,rowHeight:c,onHeaderResize:u,renderHeader:m,internalState:h,onHeaderContextMenu:x}=e,p=h.getHeaderWidth(),f="".concat(h.gutterColumnWidth,"px ")+s.map(e=>p[e.index]+"px").join(" "),g=Array(r-l).fill(!1).map(()=>Array(s.length).fill(!1)).map((e,a)=>{let r=a+l,c="libsql-table-cell flex items-center justify-end h-full pr-2 font-mono",u="sticky left-0 bg-zinc-100 dark:bg-zinc-900";return h.getSelectedRowIndex().includes(r)&&(h.isFullSelectionRow(r)?(c=o("libsql-table-cell flex items-center justify-end h-full pr-2 font-mono","bg-blue-600 border-red-900  text-white font-bold"),u="sticky left-0 bg-blue-600 dark:bg-blue-800"):(c="libsql-table-cell flex items-center justify-end h-full pr-2 font-mono dark:text-white font-bold",u="sticky left-0 bg-blue-200 dark:bg-blue-400")),(0,n.jsxs)("tr",{"data-row":r,children:[(0,n.jsx)("td",{className:u,style:{zIndex:15},onMouseDown:e=>{let t=h.getFocus();e.shiftKey&&t?h.selectRowRange(t.y,r):(e.ctrlKey&&t?h.addSelectionRow(r):h.selectRow(r),h.setFocus(r,0))},children:(0,n.jsx)("div",{className:c,children:r+1})}),t&&(0,n.jsx)(aa,{state:h,colIndex:s[0].index,rowIndex:r,header:s[0]},-1),(0,n.jsx)(tR,{colEnd:d,colStart:0+(t?1:0)}),e.slice(d,i+1).map((e,t)=>{let a=t+d,l=s[a];return!l||l.sticky?null:(0,n.jsx)(aa,{state:h,colIndex:l.index,rowIndex:r,header:l},a)}),(0,n.jsx)(tR,{colStart:i,colEnd:s.length-1})]},r)});return(0,n.jsxs)("table",{style:{...a,gridTemplateColumns:f},children:[(0,n.jsx)(t_,{state:h,renderHeader:m,sticky:t,headers:s,onHeaderResize:(e,t)=>{var a,n,r;u(null!==(r=p[null!==(n=null===(a=s[e])||void 0===a?void 0:a.index)&&void 0!==n?n:0])&&void 0!==r?r:150,t)},onHeaderContextMenu:x}),(0,n.jsx)(tE,{colCount:s.length,rowCount:h.getRowsCount(),rowEnd:r,rowStart:l,rowHeight:c,children:g})]})}({headers:g,rowEnd:j,rowStart:b,colEnd:N,colStart:w,rowHeight:l,onHeaderResize:y,hasSticky:void 0!==t,internalState:a,revision:x,onContextMenu:d,onHeaderContextMenu:c,renderHeader:r})})}),[j,b,N,w,l,g,y,t,a,d,c,u,x,r])}var as=a(32645),ar=a(95710),al=a(81766),ai=a(59523),ao=a(4683),ad=a(35524);class ac{static duplicateRow(e){var t,a,n;let s=null===(t=e.getFocus())||void 0===t?void 0:t.y;if(!s)return;let r=e.getRowByIndex(s);if(r){let t={...r.raw,...r.change};for(let s of e.getHeaders())(null===(n=s.metadata.columnSchema)||void 0===n?void 0:null===(a=n.constraint)||void 0===a?void 0:a.generatedExpression)&&delete t[s.name];e.insertNewRow(s,t)}}static duplicateRowWithoutKey(e){var t,a,n;let s=null===(t=e.getFocus())||void 0===t?void 0:t.y;if(!s)return;let r=e.getRowByIndex(s);if(r){let t={...r.raw,...r.change};for(let s of e.getHeaders())((null===(n=s.metadata.columnSchema)||void 0===n?void 0:null===(a=n.constraint)||void 0===a?void 0:a.generatedExpression)||s.metadata.isPrimaryKey)&&delete t[s.name];e.insertNewRow(s,t)}}}class au{send(e){return this.listeners.map(t=>t(e)).pop()}listen(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(t=>t!==e)}}constructor(){this.listeners=[]}}let am=new au;function ah(e){let{children:t,header:a,internalState:r}=e,[l,i]=(0,s.useState)(!1),d=a.index,c="grow line-clamp-1 font-mono font-bold",u="flex grow items-center px-2 overflow-hidden";return r.getSelectedColIndex().includes(d)&&(r.isFullSelectionCol(d)?(c="grow line-clamp-1 font-mono font-bold text-white font-bold",u="flex grow items-center px-2 overflow-hidden bg-blue-600 dark:bg-blue-900"):(c="grow line-clamp-1 font-mono font-bold dark:text-white font-bold",u="flex grow items-center px-2 overflow-hidden bg-blue-200 dark:bg-blue-400")),(0,n.jsxs)("div",{className:u,children:[(0,n.jsxs)("div",{className:u,onMouseDown:e=>{if(2===e.button)i(!0),e.preventDefault();else{let t=r.getFocus();e.shiftKey&&t?r.selectColRange(t.x,d):(e.ctrlKey&&t?r.addSelectionCol(d):r.selectColumn(d),r.setFocus(0,d))}},children:[a.display.icon?(0,n.jsx)("div",{className:"mr-2",children:(0,n.jsx)(a.display.icon,{className:o("h-4 w-4",a.display.iconClassName)})}):null,(0,n.jsx)("div",{className:c,children:a.display.text})]}),(0,n.jsx)("div",{children:(0,n.jsxs)(Q,{modal:!1,onOpenChange:i,open:l,children:[(0,n.jsx)(J,{asChild:!0,children:(0,n.jsx)(as.A,{className:o("text-mute h-4 w-4 shrink-0 cursor-pointer",c)})}),(0,n.jsx)(Z,{className:"w-[300px]",side:"bottom",align:"start",sideOffset:0,children:t})]})})]})}function ax(e){let{data:t,tableName:a,onSortColumnChange:r,visibleColumnIndexList:l}=e,[i,o]=(0,s.useState)(),{extensions:d}=eu(),c=(0,s.useMemo)(()=>l||t.getHeaders().map((e,t)=>t),[t,l]),u=(0,s.useCallback)(e=>{let s=d.getQueryHeaderContextMenu(e).map(e=>e.component?(0,n.jsx)("div",{onKeyDown:e=>e.stopPropagation(),onClick:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),onMouseUp:e=>e.stopPropagation(),children:e.component},e.key):(0,n.jsx)($,{onClick:e.onClick,children:e.title},e.key));return(0,n.jsxs)(ah,{header:e,internalState:t,children:[s,(0,n.jsxs)($,{onClick:()=>{o(e.index===i?void 0:e.index)},children:[(0,n.jsx)(ar.A,{className:"mr-2 h-4 w-4"}),"Pin Header"]}),(0,n.jsx)(et,{}),(0,n.jsxs)($,{disabled:!a,onClick:()=>{r&&r([{columnName:e.name,by:"ASC"}])},children:[(0,n.jsx)(al.A,{className:"mr-2 h-4 w-4"}),"Sort A → Z"]}),(0,n.jsxs)($,{disabled:!a,onClick:()=>{r&&r([{columnName:e.name,by:"DESC"}])},children:[(0,n.jsx)(ai.A,{className:"mr-2 h-4 w-4"}),"Sort Z → A"]})]},e.name)},[t,a,i,r,d]),m=(0,s.useCallback)(e=>{e.preventDefault(),e.stopPropagation()},[]),h=(0,s.useCallback)(e=>{let a=e.getFocus();if(a){let n=a.y,s=a.x,r=e.getSelectionRange(n,s);if(r&&(r.x1!==r.x2||r.y1!==r.y2)){let e=t.getHeaders().filter((e,t)=>t>=r.x1&&t<=r.x2).map(e=>e.name);tN([],t.getAllRows().filter((e,t)=>t>=r.y1&&t<=r.y2).map(t=>e.map(e=>t.raw[e])),"	","\r\n",'"',"clipboard")}else window.navigator.clipboard.writeText(e.getValue(n,s))}},[t]),x=(0,s.useCallback)(e=>{let t=e.getFocus();if(t){let a=t.y,n=t.x;window.navigator.clipboard.readText().then(t=>{let s=t.split("\r\n").map(e=>e.split("	"));for(let t=0;t<s.length&&(t!==s.length-1||1!==s[t].length||""!==s[t][0]);t++)for(let r=0;r<s[t].length;r++)e.changeValue(a+t,n+r,"null"===s[t][r].toLowerCase()?null:s[t][r])})}},[]),p=function(e){let{tableName:t,data:a,copyCallback:r,pasteCallback:l}=e,{openEditor:i}=t5(),{extensions:o}=eu();return(0,s.useCallback)(e=>{var s;let{state:d,event:c}=e,u=crypto.randomUUID(),m=Math.floor(Date.now()/1e3).toString(),h=!!d.getFocus();function x(e){let t=d.getFocus();t&&d.changeValue(t.y,t.x,e)}(s=[...o.getQueryCellContextMenu().map(e=>({title:e.title})),{title:"Insert Value",disabled:!h,subWidth:200,sub:[{title:(0,n.jsx)("pre",{children:"NULL"}),onClick:()=>{x(null)}},{title:(0,n.jsx)("pre",{children:"DEFAULT"}),onClick:()=>{x(void 0)}},{separator:!0},{title:(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("span",{className:"text-xs text-gray-500",children:"Unix Timestamp"}),(0,n.jsx)("span",{children:m})]}),onClick:()=>{x(m)}},{separator:!0},{title:(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("span",{className:"text-xs text-gray-500",children:"UUID "}),(0,n.jsx)("span",{children:u})]}),onClick:()=>{x(u)}}]},{title:"Open With",sub:[{title:"Full Text Editor",onClick:()=>{let e=d.getFocusValue();"string"==typeof e&&i({initialValue:e,format:"text",readOnly:d.getReadOnlyMode(),onCancel:()=>{},onSave:e=>{d.setFocusValue(e)}})}},{title:"JSON Editor",onClick:()=>{let e=d.getFocusValue();"string"==typeof e&&i({initialValue:e,format:"json",readOnly:d.getReadOnlyMode(),onCancel:()=>{},onSave:e=>{d.setFocusValue(e)}})}}]},{separator:!0},{title:"Copy Cell Value",shortcut:C.copy.toString(),onClick:()=>{r(d)}},{title:"Paste",shortcut:C.paste.toString(),onClick:()=>{l(d)}},{separator:!0},{title:"Copy Row As",sub:[{title:"Copy as Excel",onClick:()=>{d.getSelectedRowCount()>0&&window.navigator.clipboard.writeText(function(e){let t=[];for(let a of e){let e=a.map(tb).join("	");t.push(e)}return t.join("\r\n")}(d.getSelectedRowsArray()))}},{title:"Copy as Json",onClick:()=>{let e=d.getHeaders().map(e=>{var t;return null!==(t=null==e?void 0:e.name)&&void 0!==t?t:""});d.getSelectedRowCount()>0&&window.navigator.clipboard.writeText(tj(e,d.getSelectedRowsArray()))}},{title:"Copy as INSERT SQL",onClick:()=>{let e=d.getHeaders().map(e=>{var t;return null!==(t=null==e?void 0:e.name)&&void 0!==t?t:""});d.getSelectedRowCount()>0&&window.navigator.clipboard.writeText(ty(null!=t?t:"UnknownTable",e,d.getSelectedRowsArray()))}}]},...d.getReadOnlyMode()?[]:[{separator:!0},{title:"Insert row",icon:ao.A,onClick:()=>{a.insertNewRow()}},{title:"Duplicate row without keys",onClick:()=>{ac.duplicateRowWithoutKey(d)}},{title:"Duplicate row with keys",onClick:()=>{ac.duplicateRow(d)}},{separator:!0},{title:"Delete selected row(s)",icon:ad.A,onClick:()=>{a.getSelectedRowIndex().forEach(e=>{a.removeRow(e)})}}]],function(e){var t;return t={contextMenu:s,x:e.pageX,y:e.pageY},am.send(t),e.preventDefault(),!1})(c)},[a,t,r,l,i,o])}({tableName:a,data:t,copyCallback:h,pasteCallback:x}),f=(0,s.useCallback)((e,t)=>{let a=e.getFocus();if(t.shiftKey&&a){let n=null;if(e.getLastMove())n=e.getLastMove();else{let t=e.getSelectionRange(a.y,a.x);t&&(n={x:t.x2,y:t.y2})}if(n){let s=e.getRowsCount(),r=e.getHeaderCount(),l=n.y,i=n.x,o="left",d="bottom";"ArrowUp"===t.key&&(l=Math.max(n.y-1,0),o="left",d="top"),"ArrowDown"===t.key&&(o="left",d="bottom",l=Math.min(n.y+1,s-1)),"ArrowLeft"===t.key&&(o="left",d="top",i=Math.max(n.x-1,0)),"ArrowRight"===t.key&&(o="right",d="top",i=Math.min(n.x+1,r-1)),e.selectCellRange(a.y,a.x,l,i),e.setLastMove(l,i),e.scrollToCell(o,d,{x:i,y:l})}}},[]),g=(0,s.useCallback)((e,t)=>{if(!e.isInEditMode()){if(C.copy.match(t))h(e);else if(C.paste.match(t))x(e);else if("ArrowRight"===t.key){if(t.shiftKey)f(e,t);else{let t=e.getFocus();t&&t.x+1<e.getHeaderCount()&&(e.setFocus(t.y,t.x+1),e.scrollToCell("right","top",{y:t.y,x:t.x+1}))}}else if("ArrowLeft"===t.key){if(t.shiftKey)f(e,t);else{let t=e.getFocus();t&&t.x-1>=0&&(e.setFocus(t.y,t.x-1),e.scrollToCell("left","top",{y:t.y,x:t.x-1}))}}else if("ArrowUp"===t.key){if(t.shiftKey)f(e,t);else{let t=e.getFocus();t&&t.y-1>=0&&(e.setFocus(t.y-1,t.x),e.scrollToCell("left","top",{y:t.y-1,x:t.x}))}}else if("ArrowDown"===t.key){if(t.shiftKey)f(e,t);else{let t=e.getFocus();t&&t.y+1<e.getRowsCount()&&(e.setFocus(t.y+1,t.x),e.scrollToCell("left","bottom",{y:t.y+1,x:t.x}))}}else if("Tab"===t.key){let t=e.getFocus();if(t){let a=e.getHeaderCount(),n=t.y*a+t.x+1,s=n%a,r=Math.floor(n/a);if(r>=e.getRowsCount())return;e.setFocus(r,s),e.scrollToCell(0===s?"left":"right","bottom",{y:r,x:s})}}else"Enter"===t.key&&e.enterEditMode();t.preventDefault()}},[h,f,x]);return(0,n.jsx)(an,{internalState:t,onContextMenu:p,onHeaderContextMenu:m,stickyHeaderIndex:i,arrangeHeaderIndex:c,renderAhead:20,renderHeader:u,rowHeight:35,onKeyDown:g})}var ap=a(2326),af=a(7126),ag=a(82982);let av=e=>e?new Intl.NumberFormat("en-US",{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:2}).format(e):e;var ay=a(66430),ab=a.n(ay);class aj{static createFromResult(e){let t=new aj(function(e){let{result:t}=e,a=t.headers.map(e=>{let t=null;if(e.table&&e.schema){var a;t={schema:e.schema,table:e.table,column:null!==(a=e.originalName)&&void 0!==a?a:e.name}}return{name:e.name,display:{text:e.displayName},setting:{readonly:!0,resizable:!0},metadata:{type:e.type,originalType:e.originalType,...t?{from:t}:{}}}});return!function(e,t){let{tableSchema:a,driver:n}=t;if(a)for(let t of e){var s,r;let e=a.columns.find(e=>e.name.toLowerCase()===t.name.toLowerCase());if(t.metadata.columnSchema=e,t.metadata.originalType=null==e?void 0:e.type,t.metadata.type=null!==(r=t.metadata.type)&&void 0!==r?r:n.inferTypeFromHeader(e),t.metadata.from={schema:a.schemaName,table:a.tableName,column:t.name},a.pk.map(e=>e.toLowerCase()).includes(t.name.toLowerCase())&&(t.metadata.isPrimaryKey=!0),e&&(null===(s=e.constraint)||void 0===s?void 0:s.foreignKey)&&e.constraint.foreignKey.foreignColumns&&(t.metadata.referenceTo={schema:e.constraint.foreignKey.foreignSchemaName,table:e.constraint.foreignKey.foreignTableName,column:e.constraint.foreignKey.foreignColumns[0]}),a.constraints){for(let e of a.constraints)if(e.foreignKey&&e.foreignKey.columns){let a=e.foreignKey.columns.indexOf(t.name);-1!==a&&(t.metadata.referenceTo={schema:e.foreignKey.foreignSchemaName,table:e.foreignKey.foreignTableName,column:e.foreignKey.columns[a]})}}}}(a,e),!function(e,t){let{tableSchema:a,schemas:n,driver:s}=t;if(!a)for(let t of e){var r;if(!t.metadata.from)continue;let e=t.metadata.from,a=n[e.schema];if(!a)continue;let l=a.find(t=>t.tableName===e.table);if(!l)continue;let i=l.tableSchema;if(!i)continue;i.pk.includes(e.column)&&(t.metadata.isPrimaryKey=!0);let o=i.columns.find(t=>t.name.toLowerCase()===e.column.toLowerCase());o&&(t.metadata.type=null!==(r=t.metadata.type)&&void 0!==r?r:s.inferTypeFromHeader(o),t.metadata.columnSchema=o)}}(a,e),!function(e,t){let{schemas:a}=t,n=[];for(let t of e){let e=t.metadata.from;if(e&&t.metadata.isPrimaryKey){let t=n.find(t=>t.schema===e.schema&&t.table===e.table);if(t)t.columns.push(e.column);else{var s,r,l;let t=null!==(l=null===(r=a[e.schema].find(t=>t.tableName===e.table))||void 0===r?void 0:null===(s=r.tableSchema)||void 0===s?void 0:s.pk)&&void 0!==l?l:[];n.push({schema:e.schema,table:e.table,columns:[e.column],pkColumns:t})}}}for(let t of n){let a=!1;if(t.columns.filter(e=>t.pkColumns.includes(e)).length===t.pkColumns.length&&(a=!0),a||0!==t.pkColumns.length||1!==t.columns.length||"rowid"!==t.columns[0]||(a=!0),a)for(let a of e){let e=a.metadata.from;e&&e.schema===t.schema&&e.table===t.table&&(a.setting.readonly=!1)}}}(a,e),!function(e){for(let n of e){var t,a;(null===(a=n.metadata.columnSchema)||void 0===a?void 0:null===(t=a.constraint)||void 0===t?void 0:t.generatedExpression)&&(n.setting.readonly=!0)}}(a),!function(e,t){let{result:a}=t;for(let t of e){let e=t.metadata.type,l=100;if(e===ew.$C.INTEGER||e===ew.$C.REAL)l=100;else if(e===ew.$C.TEXT){let e=0;for(let l=0;l<Math.min(a.rows.length,100);l++){let i=a.rows[l];if(i){var n,s,r;e=Math.max((null!==(r=null===(n=i[null!==(s=t.name)&&void 0!==s?s:""])||void 0===n?void 0:n.toString())&&void 0!==r?r:"").length,e)}}l=Math.max(150,Math.min(500,8*e))}t.display.initialSize=l}}(a,e),!function(e){for(let n of e){var t,a;n.metadata.isPrimaryKey?(n.display.icon=ap.A,n.display.iconClassName="text-red-500"):n.metadata.referenceTo?(n.display.icon=af.A,n.display.iconClassName="text-yellow-500"):(null===(a=n.metadata.columnSchema)||void 0===a?void 0:null===(t=a.constraint)||void 0===t?void 0:t.generatedExpression)&&(n.display.icon=ag.A,n.display.iconClassName="text-blue-500")}}(a),a}(e),e.result.rows.map(e=>({...e})));return t.getRowsCount()>=1e3&&(t.gutterColumnWidth=50),t.getRowsCount()>=1e4&&(t.gutterColumnWidth=60),t}setReadOnlyMode(e){this.readOnlyMode=e}getReadOnlyMode(){return this.readOnlyMode}setContainer(e){this.container=e}addChangeListener(e){this.changeCallback.push(e)}removeChangeListener(e){this.changeCallback=this.changeCallback.filter(t=>t!==e)}broadcastChange(e){return e&&(this.changeDebounceTimerId&&clearTimeout(this.changeDebounceTimerId),this.changeCallback.reverse().forEach(e=>e(this))),!this.changeDebounceTimerId&&(this.changeDebounceTimerId=setTimeout(()=>{this.changeDebounceTimerId=null,this.changeCallback.reverse().forEach(e=>e(this))},5),!0)}mergeSelectionRanges(){this.selectionRanges.sort((e,t)=>e.y1-t.y1||e.x1-t.x1);let e=[],t=!1;for(let a of this.selectionRanges){let n=e[e.length-1];n&&(n.y1===a.y1&&n.y2===a.y2&&n.x2+1===a.x1||n.x1===a.x1&&n.x2===a.x2&&n.y2+1===a.y1)?(n.x2=Math.max(n.x2,a.x2),n.y2=Math.max(n.y2,a.y2),t=!0):(e.push({...a}),t=!1)}this.selectionRanges=e,t&&this.mergeSelectionRanges()}splitSelectionRange(e,t){let a=[];return t.y1>e.y1&&a.push({x1:e.x1,y1:e.y1,x2:e.x2,y2:t.y1-1}),t.y2<e.y2&&a.push({x1:e.x1,y1:t.y2+1,x2:e.x2,y2:e.y2}),t.x1>e.x1&&a.push({x1:e.x1,y1:Math.max(e.y1,t.y1),x2:t.x1-1,y2:Math.min(e.y2,t.y2)}),t.x2<e.x2&&a.push({x1:t.x2+1,y1:Math.max(e.y1,t.y1),x2:e.x2,y2:Math.min(e.y2,t.y2)}),a}getHeaders(){return this.headers}getValue(e,t){var a,n,s;let r=null===(a=this.data[e])||void 0===a?void 0:a.change;if(r){let e=null!==(s=null===(n=this.headers[t])||void 0===n?void 0:n.name)&&void 0!==s?s:"";if(e in r)return r[e]}return this.getOriginalValue(e,t)}hasCellChange(e,t){var a,n,s;let r=null===(a=this.data[e])||void 0===a?void 0:a.change;return!!r&&(null!==(s=null===(n=this.headers[t])||void 0===n?void 0:n.name)&&void 0!==s?s:"")in r}getOriginalValue(e,t){var a,n,s;let r=null!==(s=null===(a=this.headers[t])||void 0===a?void 0:a.name)&&void 0!==s?s:"";return null===(n=this.data[e])||void 0===n?void 0:n.raw[r]}changeValue(e,t,a){var n,s,r;if(this.readOnlyMode||(null===(n=this.headers[t])||void 0===n?void 0:n.setting.readonly))return;let l=this.getOriginalValue(e,t),i=this.data[e],o=null!==(r=null===(s=this.headers[t])||void 0===s?void 0:s.name)&&void 0!==r?r:"";if(i){if(ab()(l,a)){let e=i.change;e&&o in e&&(delete e[o],0===Object.entries(e).length&&(i.changeKey&&(delete this.changeLogs[i.changeKey],delete i.changeKey),delete i.change))}else{let e=i.change;e?e[o]=a:(i.changeKey=++this.changeCounter,i.change={[o]:a},this.changeLogs[i.changeKey]=i)}this.broadcastChange()}}getChangedRows(){return Object.values(this.changeLogs)}getRowsCount(){return this.data.length}getHeaderCount(){return this.headers.length}disardAllChange(){let e=[];for(let t of Object.values(this.changeLogs))t.isNewRow?(e.push(t),delete t.change,delete t.changeKey,delete t.isNewRow):(delete t.change,delete t.changeKey,delete t.isRemoved);this.data=this.data.filter(t=>!e.includes(t)),this.changeLogs={},this.broadcastChange(!0)}applyChanges(e){let t=this.getChangedRows(),a=t.filter(e=>e.isRemoved);for(let a of t){let t=e.find(e=>e.row===a);a.raw={...a.raw,...a.change,...null==t?void 0:t.updated},delete a.changeKey,delete a.change,delete a.isNewRow,delete a.isRemoved}a.length>0&&(this.data=this.data.filter(e=>!a.includes(e)),this.selectionRanges=[]),this.changeLogs={},this.broadcastChange()}insertNewRow(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(-1===e){let t=this.getFocus();t&&(e=t.y)}e<0&&(e=0);let a={isNewRow:!0,raw:{},change:t,changeKey:++this.changeCounter};this.data.splice(e,0,a),this.changeLogs[a.changeKey]=a,this.broadcastChange()}isNewRow(e){var t;return!!(null===(t=this.data[e])||void 0===t?void 0:t.isNewRow)}removeRow(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;if(-1===e){let t=this.getFocus();t&&(e=t.y)}let t=this.data[e];t&&(t.isNewRow&&t.changeKey?(delete this.changeLogs[t.changeKey],this.data=this.data.filter(e=>e!=t)):(t.isRemoved=!0,t.changeKey||(t.change={},t.changeKey=++this.changeCounter,this.changeLogs[t.changeKey]=t))),this.broadcastChange()}isRemovedRow(e){var t;return!!(null===(t=this.data[e])||void 0===t?void 0:t.isRemoved)}getAllRows(){return this.data}getRowByIndex(e){return this.data[e]}getLastMove(){return this.lastMove?{x:this.lastMove[1],y:this.lastMove[0]}:null}setLastMove(e,t){this.lastMove=[e,t]}clearLastMove(){this.lastMove=null}getFocus(){return this.focus?{x:this.focus[1],y:this.focus[0]}:null}getFocusValue(){let e=this.getFocus();if(e)return this.getValue(e.y,e.x)}setFocusValue(e){let t=this.getFocus();t&&this.changeValue(t.y,t.x,e)}hasFocus(e,t){return!!this.focus&&this.focus[0]===e&&this.focus[1]===t}setFocus(e,t){this.focus=[e,t],this.clearLastMove(),this.broadcastChange()}isInEditMode(){return this.editMode}enterEditMode(){this.editMode=!0,this.broadcastChange()}exitEditMode(){this.editMode=!1,this.container&&this.container.focus(),this.broadcastChange()}clearFocus(){this.focus=null,this.broadcastChange()}setHeaderWidth(e,t){return this.headerWidth[e]=t}getHeaderWidth(){return this.headerWidth}scrollToCell(e,t,a){if(this.container&&a){var n,s;let r=a.x,l=a.y,i=38,o=0,d=(l+1)*38,c=d+38;for(let e=0;e<r;e++)i+=null!==(n=this.headerWidth[e])&&void 0!==n?n:0;o=i+(null!==(s=this.headerWidth[r])&&void 0!==s?s:0);let u=this.container.clientWidth,m=this.container.clientHeight,h=this.container.scrollLeft,x=h+this.container.clientWidth,p=this.container.scrollTop;"right"===e?o-38>x&&(this.container.scrollLeft=Math.max(0,o-u)):i<h&&(this.container.scrollLeft=i),"bottom"===t?c>p+m&&(this.container.scrollTop=Math.max(0,c-m)):d-38<p&&(this.container.scrollTop=Math.max(0,d-38))}}clearSelect(){this.selectionRanges=[],this.broadcastChange()}getSelectionRanges(){return this.selectionRanges}setSelectionRanges(e){this.selectionRanges=e,this.broadcastChange()}getSelectedRowCount(){return this.getSelectedRowIndex().length}getSelectedRowsArray(){return tv(this.data,this.getSelectedRowIndex()).map(e=>this.headers.map(t=>e.raw[t.name]))}getSelectedRowIndex(){let e=new Set;for(let t of this.selectionRanges)for(let a=t.y1;a<=t.y2;a++)e.add(a);return Array.from(e.values())}getSelectedColIndex(){let e=new Set;for(let t of this.selectionRanges)for(let a=t.x1;a<=t.x2;a++)e.add(a);return Array.from(e.values())}isFullSelectionRow(e){for(let t of this.selectionRanges)if(t.y1<=e&&t.y2>=e&&0===t.x1&&t.x2===this.getHeaderCount()-1)return!0;return!1}getFullSelectionRowsIndex(){let e=new Set;for(let t of this.selectionRanges)if(0===t.x1&&t.x2===this.getHeaderCount()-1)for(let a=t.y1;a<=t.y2;a++)e.has(a)||e.add(a);return Array.from(e.values())}getFullSelectionColsIndex(){let e=new Set;for(let t of this.selectionRanges)if(0===t.y1&&t.y2===this.getRowsCount()-1)for(let a=t.x1;a<=t.x2;a++)e.has(a)||e.add(a);return Array.from(e.values())}isFullSelectionCol(e){for(let t of this.selectionRanges)if(t.x1<=e&&t.x2>=e&&0===t.y1&&t.y2===this.getRowsCount()-1)return!0;return!1}selectRow(e){this.selectionRanges=[{x1:0,y1:e,x2:this.headers.length-1,y2:e}],this.broadcastChange()}selectColumn(e){this.selectionRanges=[{x1:e,y1:0,x2:e,y2:this.getRowsCount()-1}],this.broadcastChange()}selectCell(e,t){let a=!(arguments.length>2)||void 0===arguments[2]||arguments[2];this.selectionRanges=[{x1:t,y1:e,x2:t,y2:e}],a?this.setFocus(e,t):this.broadcastChange()}selectCellRange(e,t,a,n){this.selectionRanges=[{x1:Math.min(t,n),y1:Math.min(e,a),x2:Math.max(t,n),y2:Math.max(e,a)}],this.broadcastChange()}findSelectionRange(e){return this.selectionRanges.findIndex(t=>t.x1<=e.x1&&t.x2>=e.x2&&t.y1<=e.y1&&t.y2>=e.y2)}addSelectionRange(e,t,a,n){let s={x1:Math.min(t,n),y1:Math.min(e,a),x2:Math.max(t,n),y2:Math.max(e,a)},r=this.findSelectionRange(s);if(r<0)this.selectionRanges.push(s),this.mergeSelectionRanges();else{let e=this.selectionRanges[r],t=this.splitSelectionRange(e,s);t.length>=0&&(this.selectionRanges.splice(r,1),this.selectionRanges=[...this.selectionRanges,...t],this.mergeSelectionRanges())}this.broadcastChange()}addSelectionRow(e){let t={x1:0,y1:e,x2:this.headers.length-1,y2:e};this.addSelectionRange(t.y1,t.x1,t.y2,t.x2)}addSelectionCol(e){let t={x1:e,y1:0,x2:e,y2:this.getRowsCount()-1};this.addSelectionRange(t.y1,t.x1,t.y2,t.x2)}selectRowRange(e,t){let a={x1:0,y1:Math.min(e,t),x2:this.headers.length-1,y2:Math.max(e,t)};this.selectionRanges=[a],this.broadcastChange()}selectColRange(e,t){let a={x1:Math.min(e,t),y1:0,x2:Math.max(e,t),y2:this.getRowsCount()-1};this.selectionRanges=[a],this.broadcastChange()}isRowSelected(e){for(let t of this.selectionRanges)if(e>=t.y1&&e<=t.y2)return!0;return!1}getSelectionRange(e,t){for(let a of this.selectionRanges)if(e>=a.y1&&e<=a.y2&&t>=a.x1&&t<=a.x2)return a;return null}getCellStatus(e,t){let a=this.getFocus(),n=!!a&&a.y===e&&a.x===t,s=!1,r=!1,l=!1;for(let a of this.selectionRanges)e>=a.y1&&e<=a.y2&&(t>=a.x1&&t<=a.x2&&(s=!0),(t===a.x2||t+1===a.x1)&&(r=!0)),t>=a.x1&&t<=a.x2&&(e===a.y2||e+1===a.y1)&&(l=!0);return{isFocus:n,isSelected:s,isBorderBottom:l,isBorderRight:r}}getSelectionAggregatedResult(){let e,t,a,n,s;let r=0,l=new Set;for(let t of this.selectionRanges)for(let i=t.x1;i<=t.x2;i++)for(let o=t.y1;o<=t.y2;o++){let t="".concat(i,"-").concat(o);if(l.has(t))continue;l.add(t);let d=this.getValue(o,i);if(null!=d&&""!==d){if(void 0!==s||(isNaN(Number(d))?"string"!=typeof d||isNaN(Date.parse(d))||(s="date"):s="number"),"number"===s){let t=Number(d);isNaN(t)||(e=void 0!==e?e+t:t,a=void 0!==a&&a<t?a:t,n=void 0!==n&&n>t?n:t)}else if("date"===s&&(/^\d{4}-\d{2}-\d{2}$/.test(d)&&!isNaN(new Date(d).getTime())||/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$/.test(d)&&!isNaN(new Date(d).getTime()))){let e=Date.parse(d);isNaN(e)||(a=void 0!==a&&Date.parse(a)<e?a:d,n=void 0!==n&&Date.parse(n)>e?n:d)}}r+=1}return(void 0!==e&&r>0&&(t=e/r),"number"===s)?{sum:av(e),avg:av(t),min:av(a),max:av(n),count:av(r)}:{min:a,max:n,count:r}}setDefaultAggregateFunction(e){this.defaultAggregateFunction=e}getDefaultAggregateFunction(){return this.defaultAggregateFunction}setSql(e){this.sql=e}getSql(){return this.sql}constructor(e,t){this.focus=null,this.data=[],this.lastMove=null,this.selectionRanges=[],this.gutterColumnWidth=40,this.headers=[],this.headerWidth=[],this.editMode=!1,this.readOnlyMode=!1,this.container=null,this.changeCallback=[],this.changeDebounceTimerId=null,this.changeCounter=1,this.changeLogs={},this.defaultAggregateFunction="sum",this.sql="",this.headers=e,this.data=t.map(e=>({raw:e})),this.headerWidth=e.map(e=>e.display.initialSize)}}function aN(e){let{selected:t,text:a,icon:s,onClick:r}=e;return(0,n.jsxs)("button",{onClick:r,className:o(V({variant:t?"default":"ghost",size:"sm"}),"justify-start","cursor-pointer"),children:[s?(0,n.jsx)(s,{className:"w-4 h-4 mr-2"}):(0,n.jsx)("div",{className:"w-4 h-4 mr-2"}),a]})}var aw=a(27193);function aC(e){let{data:t}=e,[a,r]=(0,s.useState)({sum:void 0,avg:void 0,min:void 0,max:void 0,count:void 0}),[l,i]=(0,s.useState)(t.getDefaultAggregateFunction());(0,s.useEffect)(()=>{let e=()=>{r({...t.getSelectionAggregatedResult()})};return t.addChangeListener(e),()=>t.removeChangeListener(e)},[t]);let o="";l&&a[l]?o="".concat(l.toUpperCase(),": ").concat(a[l]):void 0!==a.sum?o="SUM: ".concat(a.sum):void 0!==a.avg?o="AVG: ".concat(a.avg):void 0!==a.min?o="MIN: ".concat(a.min):void 0!==a.max?o="MAX: ".concat(a.max):void 0!=a.count&&(o="COUNT: ".concat(a.count));let d=(0,s.useCallback)(e=>{i(e),t.setDefaultAggregateFunction(e)},[t]);return a.count&&1>=Number(a.count)?null:(0,n.jsxs)(te,{children:[(0,n.jsx)(tt,{children:(0,n.jsxs)("div",{className:V({variant:"ghost",size:"sm"}),children:[o," ",!!o&&(0,n.jsx)(as.A,{className:"w-4 h-4 ml-2"})]})}),(0,n.jsx)(ta,{className:"p-0",children:(0,n.jsxs)("div",{className:"flex flex-col p-4",children:[!!a.sum&&(0,n.jsx)(aN,{text:"SUM: "+a.sum,icon:"sum"===l?aw.A:void 0,onClick:function(){d("sum")}}),!!a.avg&&(0,n.jsx)(aN,{text:"AVG: "+a.avg,icon:"avg"===l?aw.A:void 0,onClick:function(){d("avg")}}),!!a.max&&(0,n.jsx)(aN,{text:"MAX: "+a.max,icon:"max"===l?aw.A:void 0,onClick:function(){d("max")}}),!!a.min&&(0,n.jsx)(aN,{text:"MIN: "+a.min,icon:"min"===l?aw.A:void 0,onClick:function(){d("min")}}),!!a.count&&(0,n.jsx)(aN,{text:"COUNT: "+a.count,icon:"count"===l?aw.A:void 0,onClick:function(){d("count")}})]})})]})}function ak(e){let{result:t}=e,{databaseDriver:a}=x(),{schema:r}=eb(),[l]=(0,s.useState)(r),i=(0,s.useMemo)(()=>{let e=aj.createFromResult({driver:a,result:t.result,schemas:l});return e.setReadOnlyMode(!0),e.setSql(t.sql),e},[t,a,l]),o=t.result.stat;return(0,n.jsxs)("div",{className:"flex h-full w-full flex-col border-t",children:[(0,n.jsx)("div",{className:"grow overflow-hidden",children:(0,n.jsx)(ax,{data:i})}),o&&(0,n.jsxs)("div",{className:"flex shrink-0 justify-between border-t",children:[(0,n.jsxs)("div",{className:"flex p-1",children:[(0,n.jsx)(e8,{stats:o}),(0,n.jsx)("div",{children:(0,n.jsx)(tk,{data:i})})]}),(0,n.jsx)("div",{className:"p-1 pr-3",children:(0,n.jsx)(aC,{data:i})})]})]})}var aS=a(91812),aE=a(53561),aR=a(689);let aT=Object.freeze({Translate:{toString(e){if(!e)return;let{x:t,y:a}=e;return"translate3d(".concat(t?Math.round(t):0,"px, ").concat(a?Math.round(a):0,"px, 0)")}},Scale:{toString(e){if(!e)return;let{scaleX:t,scaleY:a}=e;return"scaleX(".concat(t,") scaleY(").concat(a,")")}},Transform:{toString(e){if(e)return[aT.Translate.toString(e),aT.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:a,easing:n}=e;return"".concat(t," ").concat(a,"ms ").concat(n)}}}),aA=e=>{let{transform:t}=e;return{...t,y:0}},a_=(0,s.forwardRef)(function(e,t){let{icon:a,selected:s,title:r,onClose:l,isDragging:i,index:d,...c}=e;return(0,n.jsxs)("button",{className:o("bg-neutral-100 dark:bg-neutral-900 relative h-[40px] border-x text-neutral-500 flex items-center text-left text-xs px-2 min-w-[170px] max-w-[300px] dark:hover:text-white hover:text-black",i&&"z-20",s?"bg-neutral-50 dark:bg-neutral-950 text-primary":"border-b border-x-transparent",0===d?"border-l-0":""),onAuxClick:e=>{let{button:t}=e;return 1===t&&l&&l()},ref:t,...c,children:[(0,n.jsx)(a,{className:"ml-2 h-4 w-4 shrink-0 grow-0"}),(0,n.jsx)("div",{className:"line-clamp-1 grow px-2",children:r}),l&&(0,n.jsx)("div",{className:o("rounded hover:bg-neutral-800 hover:text-white w-5 h-5 ml-2 flex justify-center items-center"),onClick:e=>{e.stopPropagation(),l&&l()},children:(0,n.jsx)(aR.A,{className:o("w-3 h-3 grow-0 shrink-0")})}),!s&&(0,n.jsx)("div",{className:"absolute right-[-1px] top-2 w-[1px] h-6 bg-border dark:bg-neutral-800"})]})});function aL(e){let{index:t,tab:a,selected:s,onSelectChange:r,onClose:l}=e,{attributes:i,listeners:o,transition:d,transform:c,isDragging:u,setNodeRef:m}=(0,aE.gl)({id:a.key}),h={transform:aT.Translate.toString(c),transition:d};return(0,n.jsx)(a_,{ref:m,icon:a.icon,title:a.title,onClick:r,selected:s,onClose:l,style:h,index:t,isDragging:u,...i,...o})}let aI=(0,s.createContext)({replaceCurrentTab:()=>{throw Error("Not implemented")},changeCurrentTab:()=>{throw Error("Not implemented")}}),aF=(0,s.createContext)({isActiveTab:!1});function aM(){return(0,s.useContext)(aI)}function aD(e){let{menu:t,tabs:a,selected:r,hideCloseButton:l,onSelectChange:i,onTabsChange:o}=e,d=(0,aS.MS)(aS.AN,{activationConstraint:{distance:8}}),c=(0,s.useRef)(null),u=(0,s.useRef)(null);(0,s.useEffect)(()=>{let e=c.current;if(!e)return;let t=e.children[r];if(!t)return;let a=e.getBoundingClientRect(),n=t.getBoundingClientRect(),s=0;u.current&&(s=u.current.getBoundingClientRect().width),n.left<a.left?e.scrollLeft+=n.left-a.left:n.right>a.right&&(e.scrollLeft+=n.right-a.right+s+1)},[r,a]),(0,s.useEffect)(()=>{let e=c.current;if(!e)return;let t=t=>{0!==t.deltaY&&(e.scrollLeft+=t.deltaY,t.preventDefault())};return e.addEventListener("wheel",t),()=>e.removeEventListener("wheel",t)},[]);let m=(0,aS.MS)(aS.uN,{coordinateGetter:aE.JR}),h=(0,aS.FR)(d,m),x=(0,s.useCallback)(e=>{a[r]&&(a[r]=e,o&&o([...a]))},[a,r,o]),p=(0,s.useCallback)(e=>{a[r]&&(e.title&&(a[r].title=e.title),e.identifier&&(a[r].identifier=e.identifier),o&&o([...a]))},[a,r,o]),f=(0,s.useMemo)(()=>({replaceCurrentTab:x,changeCurrentTab:p}),[p,x]),g=(0,s.useCallback)(e=>{let{active:t,over:n}=e;if(t.id!==(null==n?void 0:n.id)){let e=a[r],s=a.findIndex(e=>e.key===t.id),l=a.findIndex(e=>e.key===(null==n?void 0:n.id)),d=(0,aE.be)(a,s,l);o&&o(d),i(d.findIndex(t=>t.key===(null==e?void 0:e.key)))}},[o,a,i,r]);return(0,n.jsx)(aI.Provider,{value:f,children:(0,n.jsx)(aS.Mp,{sensors:h,collisionDetection:aS.fp,onDragEnd:g,modifiers:[aA],children:(0,n.jsxs)("div",{className:"flex flex-col w-full h-full",children:[(0,n.jsx)("div",{className:"grow-0 shrink-0 bg-neutral-100 dark:bg-neutral-900 overflow-x-auto no-scrollbar",children:(0,n.jsxs)("div",{className:"flex h-[40px] window-tab-scrollbar",ref:c,children:[(0,n.jsx)(aE.gB,{items:a.map(e=>e.key),strategy:aE.m$,children:a.map((e,t)=>(0,n.jsx)(aL,{index:t,tabCount:a.length,tab:e,selected:t===r,onSelectChange:()=>{i(t)},onClose:l?void 0:()=>{let n=a.filter(t=>t.key!==e.key);r>=t&&i(n.length-1),o&&o(n)}},e.key))}),t&&(0,n.jsx)("div",{ref:u,style:{zIndex:50,position:"sticky"},className:"flex h-[40px] items-center border-b right-0 bg-neutral-100 dark:bg-neutral-900",children:(0,n.jsxs)(Q,{modal:!1,children:[(0,n.jsx)(J,{children:(0,n.jsxs)("div",{className:"ml-1.5 text-xs flex h-7 items-center justify-center gap-1 rounded-lg p-1.5 py-2 text-neutral-600 transition hover:bg-neutral-200 hover:text-black dark:text-neutral-400 dark:hover:bg-neutral-800 dark:hover:text-white",children:[(0,n.jsx)(ao.A,{className:"w-4 h-4"})," New"]})}),(0,n.jsx)(Z,{children:t.map((e,t)=>(0,n.jsx)($,{onClick:e.onClick,children:e.text},t))})]})}),(0,n.jsx)("div",{className:"flex h-[40px] border-b flex-1"})]})}),(0,n.jsx)("div",{className:"grow relative",children:a.map((e,t)=>(0,n.jsx)(aF.Provider,{value:{isActiveTab:t===r},children:(0,n.jsx)("div",{className:"absolute left-0 right-0 top-0 bottom-0",style:{display:t===r?"inherit":"none"},children:e.component})},e.key))})]})})})}function aO(e){let{placeholders:t,onChange:a}=e,r=Object.keys(t).length,l=Object.values(t).filter(e=>""===e).length,i=(0,s.useMemo)(()=>(0,n.jsx)("div",{className:"relative max-h-[400px] overflow-auto rounded border",children:(0,n.jsxs)("table",{className:"w-full border-separate border-spacing-0 text-sm",children:[(0,n.jsx)("thead",{className:"sticky top-0",children:(0,n.jsxs)("tr",{className:"h-[35px] bg-secondary text-xs",children:[(0,n.jsx)("th",{className:"border-r px-2 text-left",children:"Variables"}),(0,n.jsx)("th",{className:"px-2 text-left",children:"Value"})]})}),(0,n.jsx)("tbody",{children:Object.entries(t).map(e=>{let[s,r]=e;return(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"border-r border-t px-4 py-2",children:s}),(0,n.jsx)("td",{className:"border-t px-4 py-2",children:(0,n.jsx)("input",{type:"text",className:"h-full w-full border-0 bg-inherit font-mono outline-hidden",placeholder:"Please fill your value",value:null!=r?r:"",onChange:e=>{let n=e.currentTarget.value;a({...t,[s]:n})}})})]},s)})})]})}),[t,a]);return(0,n.jsxs)(te,{children:[(0,n.jsx)(tt,{children:(0,n.jsxs)("div",{className:V({variant:"ghost",size:"sm"}),children:[l>0&&(0,n.jsx)("div",{className:"flex h-full items-center justify-center pr-2",children:(0,n.jsx)("div",{className:"h-2 w-2 animate-ping rounded-full bg-red-500"})}),"Variables",(0,n.jsxs)("span",{className:"ml-1 text-xs",children:[r-l," / ",r]})]})}),(0,n.jsxs)(ta,{className:"w-[400px]",children:[i,(0,n.jsxs)("p",{className:"mt-2 text-sm",children:["Use ",(0,n.jsx)("span",{className:"bg-muted font-mono",children:"''"})," for an empty string. If the value is a number, it will automatically be cast to a number. To specify a numeric string, wrap it in single quote."]})]})]})}function aq(e){let{initialCode:t,initialName:a}=e,{databaseDriver:r,docDriver:l}=x(),{refresh:i,autoCompleteSchema:d}=eb(),[h,p]=(0,s.useState)(null!=t?t:""),f=(0,s.useRef)(null),[g,v]=(0,s.useState)(.875),[y,b]=(0,s.useState)(0),[j,N]=(0,s.useState)(0),[w,k]=(0,s.useState)(0),[S,R]=(0,s.useState)(),[T,A]=(0,s.useState)(),[_,L]=(0,s.useState)(a),{changeCurrentTab:I}=aM(),[F,M]=(0,s.useState)({});(0,s.useEffect)(()=>{let e=setTimeout(()=>{M(e=>{let t={};for(let n of eI(h,r.getFlags().dialect).filter(e=>"PLACEHOLDER"===e.type).map(e=>e.value.slice(1))){var a;t[n]=null!==(a=e[n])&&void 0!==a?a:""}return t})},1e3);return()=>clearTimeout(e)},[h,r]);let q=()=>{try{p((0,eq.GP)(h,{language:"sqlite",tabWidth:2}))}catch(e){E.oR.error(e.message)}},U=function(){var e,t;let a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=[],l=null===(t=f.current)||void 0===t?void 0:null===(e=t.view)||void 0===e?void 0:e.state;if(l){if(a)s=D(l).map(e=>e.text);else{let e=O(l);if(!e)return;let t=l.doc.sliceString(e.from,e.to);n&&0!==t.toLowerCase().indexOf("explain query plan")&&("sqlite"===r.getFlags().dialect?t="explain query plan "+t:"mysql"===r.getFlags().dialect?t="explain format=json "+t:"postgres"===r.getFlags().dialect&&(t="explain (format json) "+t)),t&&(s=[t])}if(s.length>0){A(void 0),R(void 0),k(0);for(let e=0;e<s.length;e++){let t=eI(s[e],r.getFlags().dialect);if(t.join("")===s[e]){(0,eA.z)([{name:"tokenize_mismatch",data:{token:t,finalStatements:s}}]),E.oR.error("Failed to tokenize SQL statement");return}let a=t.filter(e=>"PLACEHOLDER"===e.type).map(e=>e.value.slice(1));if(a.length>0&&a.some(e=>""===F[e])){E.oR.error("Please fill in all placeholders");return}s[e]=t.map(e=>"PLACEHOLDER"===e.type?eE(function(e){let t=e.trim();if(t.startsWith('"')&&t.endsWith('"')||t.startsWith("'")&&t.endsWith("'"))return t.slice(1,-1).toString();let a=parseFloat(t);return isNaN(a)?t.toString():a}(F[e.value.slice(1)])):e.value).join("")}e_(r,s,e=>{R(e)}).then(e=>{let{result:t,logs:a}=e;A(t);let n=!1;for(let e of a)if("create "===e.sql.trim().substring(0,7).toLowerCase()||"drop "===e.sql.trim().substring(0,5).toLowerCase()||r.getFlags().supportUseStatement&&"use "===e.sql.trim().substring(0,4).toLowerCase()){n=!0;break}n&&i()}).catch(console.error)}}},K=(0,s.useMemo)(()=>{let e=[];for(let s of null!=T?T:[]){var t,a;a=s.sql,["sqlite","mysql"].includes(r.getFlags().dialect)&&(a.toLowerCase().startsWith("explain query plan")||a.toLowerCase().startsWith("explain format=json")||a.toLowerCase().startsWith("explain (format json)"))&&e.push({component:(0,n.jsx)(e9,{data:s.result}),key:"explain_"+s.order,identifier:"explain_"+s.order,title:"Explain (Visual)",icon:eM.A}),e.push({component:(0,n.jsx)(ak,{result:s},s.order),key:"query_"+s.order,identifier:"query_"+s.order,title:"".concat(null!==(t=aU(s.sql))&&void 0!==t?t:"Query "+(s.order+1))+" (".concat(s.result.rows.length,"x").concat(s.result.headers.length,")"),icon:eD.A})}return S&&e.push({key:"summary",identifier:"summary",title:"Summary",icon:eM.A,component:(0,n.jsx)("div",{className:"w-full h-full overflow-y-auto overflow-x-hidden",children:(0,n.jsx)(e6,{progress:S})})}),(0,n.jsx)(aD,{onSelectChange:k,onTabsChange:()=>{},hideCloseButton:!0,selected:w,tabs:e},"main-window-tab")},[S,w,T,r]);return(0,n.jsxs)(en,{direction:"vertical",children:[(0,n.jsx)(es,{style:{position:"relative"},children:(0,n.jsxs)("div",{className:"absolute left-0 right-0 top-0 bottom-0 flex flex-col",children:[(0,n.jsxs)("div",{className:"border-b pl-3 pr-1 py-3 flex dark:bg-neutral-950 bg-neutral-50",children:[(0,n.jsxs)("div",{className:"text-sm shrink-0 items-center flex text-secondary-foreground p-1",children:["Unsaved Query"," /"]}),(0,n.jsxs)("div",{className:"inline-block relative",children:[(0,n.jsxs)("span",{className:"inline-block text-sm p-1 outline-hidden font-semibold min-w-[175px] border border-background opacity-0",children:["\xa0",_]}),(0,n.jsx)("input",{onBlur:e=>{I({title:e.currentTarget.value||"Unnamed Query"})},placeholder:"Please name your query",spellCheck:"false",className:"absolute top-0 right-0 left-0 bottom-0 text-sm p-1 outline-hidden font-semibold focus:border-secondary-foreground rounded bg-transparent",value:_,onChange:e=>L(e.currentTarget.value)})]}),(0,n.jsx)("div",{className:"flex-1"}),(0,n.jsx)("div",{className:"flex gap-2",children:(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsxs)("button",{onClick:()=>U(),className:o(V({size:"sm"}),"rounded-r-none"),children:[(0,n.jsx)(eO.A,{className:"w-4 h-4 mr-2"}),"Run"]}),(0,n.jsxs)(Q,{children:[(0,n.jsx)(J,{asChild:!0,children:(0,n.jsx)("button",{className:o(V({size:"sm"}),"rounded-l-none border-l"),children:(0,n.jsx)(eF.a,{size:12})})}),(0,n.jsxs)(Z,{children:[(0,n.jsx)($,{onClick:()=>U(),children:"Run Current Statement"}),(0,n.jsx)($,{onClick:()=>U(!0),children:"Run All Statements"}),(0,n.jsx)(et,{}),(0,n.jsx)($,{onClick:()=>U(!1,!0),children:"Explain Current Statement"})]})]})]})})]}),(0,n.jsx)("div",{className:"grow overflow-hidden p-2",children:(0,n.jsx)(P,{ref:f,dialect:r.getFlags().dialect,value:h,onChange:p,schema:d,fontSize:g,onFontSizeChanged:v,onCursorChange:(e,t,a)=>{b(t),N(a)},onKeyDown:e=>{C.run.match(e)?(U(),e.preventDefault()):C.format.match(e)&&(q(),e.preventDefault(),e.stopPropagation())}})}),(0,n.jsx)("div",{className:"grow-0 shrink-0",children:(0,n.jsxs)("div",{className:"flex gap-1 pb-1 px-2",children:[(0,n.jsxs)("div",{className:"grow items-center flex text-xs mr-2 gap-2 pl-4",children:[(0,n.jsxs)("div",{children:["Ln ",y]}),(0,n.jsxs)("div",{children:["Col ",j+1]})]}),(0,n.jsx)("div",{children:Object.keys(F).length>0&&(0,n.jsx)(aO,{placeholders:F,onChange:M})}),(0,n.jsxs)(c,{children:[(0,n.jsx)(u,{asChild:!0,children:(0,n.jsx)(W,{variant:"ghost",size:"sm",onClick:q,className:"text-neutral-800 dark:text-neutral-200",children:"Format"})}),(0,n.jsxs)(m,{className:"p-4",children:[(0,n.jsx)("p",{className:"mb-2",children:(0,n.jsx)("span",{className:"inline-block py-1 px-2 rounded bg-secondary text-secondary-foreground",children:C.format.toString()})}),(0,n.jsx)("p",{children:"Format SQL queries for readability"})]})]})]})})]})}),(0,n.jsx)(er,{orientation:"horizontal",withHandle:!0}),(0,n.jsx)(es,{defaultSize:50,style:{position:"relative"},children:K})]})}function aU(e){try{let t=e.replace(/\s+/g," ").trim().toLowerCase(),a=t.match(/from\s+([^\s,;]+(?:\s*,\s*[^\s,;]+)*)/i),n=t.match(/join\s+([^\s,;]+)/gi);if(n&&n.length>0)return null;if(a){let e=a[1];if(e.match(/,\s*[^\s,;]+/))return null;return e}return null}catch(e){return null}}var aK=a(62591),az=a(78842),aB=a(29010),aP=a(1234),aH=a(95316);let aX=aH.bL,aV=aH.l9;aH.YJ,aH.ZL;let aW=aH.Pb;aH.z6;let aG=s.forwardRef((e,t)=>{let{className:a,inset:s,children:r,...l}=e;return(0,n.jsxs)(aH.ZP,{ref:t,className:o("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-hidden focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",s&&"pl-8",a),...l,children:[r,(0,n.jsx)(Y.vKP,{className:"ml-auto h-4 w-4"})]})});aG.displayName=aH.ZP.displayName;let aY=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(aH.G5,{ref:t,className:o("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...s})});aY.displayName=aH.G5.displayName;let aQ=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(aH.ZL,{children:(0,n.jsx)(aH.UC,{ref:t,className:o("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...s})})});aQ.displayName=aH.UC.displayName;let aJ=s.forwardRef((e,t)=>{let{className:a,inset:s,...r}=e;return(0,n.jsx)(aH.q7,{ref:t,className:o("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-hidden focus:bg-accent focus:text-accent-foreground data-disabled:pointer-events-none data-disabled:opacity-50",s&&"pl-8",a),...r})});aJ.displayName=aH.q7.displayName;let aZ=s.forwardRef((e,t)=>{let{className:a,children:s,checked:r,...l}=e;return(0,n.jsxs)(aH.H_,{ref:t,className:o("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-hidden focus:bg-accent focus:text-accent-foreground data-disabled:pointer-events-none data-disabled:opacity-50",a),checked:r,...l,children:[(0,n.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,n.jsx)(aH.VF,{children:(0,n.jsx)(Y.Srz,{className:"h-4 w-4"})})}),s]})});aZ.displayName=aH.H_.displayName,s.forwardRef((e,t)=>{let{className:a,children:s,...r}=e;return(0,n.jsxs)(aH.hN,{ref:t,className:o("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-hidden focus:bg-accent focus:text-accent-foreground data-disabled:pointer-events-none data-disabled:opacity-50",a),...r,children:[(0,n.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,n.jsx)(aH.VF,{children:(0,n.jsx)(Y.RiX,{className:"h-4 w-4 fill-current"})})}),s]})}).displayName=aH.hN.displayName,s.forwardRef((e,t)=>{let{className:a,inset:s,...r}=e;return(0,n.jsx)(aH.JU,{ref:t,className:o("px-2 py-1.5 text-sm font-semibold text-foreground",s&&"pl-8",a),...r})}).displayName=aH.JU.displayName;let a$=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(aH.wv,{ref:t,className:o("-mx-1 my-1 h-px bg-border",a),...s})});a$.displayName=aH.wv.displayName;let a0=e=>{let{className:t,...a}=e;return(0,n.jsx)("span",{className:o("ml-auto text-xs tracking-widest text-muted-foreground",t),...a})};function a1(e){let{menu:t}=e;return t.map((e,t)=>e.separator?(0,n.jsx)(a$,{},t):"check"===e.type?(0,n.jsx)(aZ,{checked:e.checked,onClick:e.onClick,disabled:e.disabled,children:e.title},t):e.sub?(0,n.jsxs)(aW,{children:[(0,n.jsx)(aG,{inset:!0,children:e.title}),(0,n.jsx)(aY,{className:e.subWidth?"":"w-48",style:{width:e.subWidth?void 0:e.subWidth},children:(0,n.jsx)(a1,{menu:e.sub})})]},t):(0,n.jsxs)(aJ,{onClick:e.onClick,disabled:e.disabled,inset:!e.icon,children:[e.icon&&(0,n.jsx)(e.icon,{className:o("mr-2 h-4 w-4",e.destructive?"text-red-500":void 0)}),e.destructive?(0,n.jsx)("span",{className:"text-red-500",children:e.title}):e.title,e.shortcut&&(0,n.jsx)(a0,{children:e.shortcut})]},t))}function a2(){let e=(0,s.useRef)(null),[t,a]=(0,s.useState)();return(0,s.useEffect)(()=>am.listen(e=>{a(e)}),[a]),(0,s.useEffect)(()=>{if(t&&e.current){let a=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,view:window,button:2,buttons:2,clientX:t.x,clientY:t.y});e.current.dispatchEvent(a)}},[t,e]),(0,n.jsx)("div",{style:{position:"fixed",left:-20,top:-20},children:t?(0,n.jsxs)(aX,{modal:!1,onOpenChange:e=>{e||a(void 0)},children:[(0,n.jsx)(aV,{ref:e,children:(0,n.jsx)("div",{})}),(0,n.jsx)(aQ,{className:"w-64",children:(0,n.jsx)(a1,{menu:t.contextMenu})})]}):null})}a0.displayName="ContextMenuShortcut";var a4=a(15325);function a5(e){let{text:t,highlight:a}=e;if(!a)return(0,n.jsx)("span",{children:t});let s=RegExp("("+(null!=a?a:"").replace(/[.*+?^${}()|[\]\\]/g,"\\$&")+")","i"),r=t.split(s);return(0,n.jsx)("span",{children:r.map((e,t)=>e.toLowerCase()===(null!=a?a:"").toLowerCase()?(0,n.jsx)("span",{className:"bg-yellow-300 text-black",children:e},t):(0,n.jsx)("span",{children:e},t))})}function a3(e){let{depth:t}=e;return t<=0?null:Array(t).fill(!1).map((e,t)=>(0,n.jsx)("div",{className:o("w-4 shrink-0")},t))}function a8(e){let{hasCollapsed:t,collapsed:a,onClick:s}=e;return t?(0,n.jsx)("div",{onClick:s,children:a?(0,n.jsx)(as.A,{className:o("h-4 w-4")}):(0,n.jsx)(a4.A,{className:o("h-4 w-4")})}):(0,n.jsx)("div",{className:"w-4 shrink-0"})}function a6(e){let[t,a]=(0,s.useState)(!1),[r,l]=(0,s.useState)(""),[i,d]=(0,s.useState)([]),c=(0,s.useRef)(!1),{full:u,...m}=e,{onContextMenu:h}=m;return(0,n.jsxs)(aX,{modal:!1,onOpenChange:a,children:[(0,n.jsx)(aV,{asChild:!0,children:(0,n.jsx)("div",{tabIndex:0,className:o(u?"grow overflow-auto":"","select-none"),onContextMenu:e=>{if(c.current){c.current=!1;return}if(h){let t=h();0===t.length?(e.preventDefault(),e.stopPropagation()):d(t)}l("")},children:(0,n.jsx)("div",{className:"flex flex-col gap-0",children:function e(t){let{items:a,depth:r,...l}=t,{filter:i,highlight:d,stopParentPropagation:c,onContextMenu:u,onDoubleClick:m,onSelectChange:h,selectedKey:x,setContextMenu:p,contextMenuKey:f,setContextMenuKey:g,collapsedKeys:v,onCollapsedChange:y,contextOpen:b}=l;if(0===a.length)return(0,n.jsx)(s.Fragment,{});let j=a.some(e=>e.children&&e.children.length>0);return(0,n.jsx)(n.Fragment,{children:a.filter(e=>(function e(t,a){var n;return!a||a(t)||(null!==(n=t.children)&&void 0!==n?n:[]).some(t=>e(t,a))})(e,i)).map(t=>{var a,i;let N=!!t.children&&t.children.length>0,w=!!v&&v.has(t.key);return(0,n.jsxs)(s.Fragment,{children:[(0,n.jsx)("div",{onContextMenu:()=>{c.current=!0,g(t.key),u&&p(u(t))},onDoubleClick:()=>{m&&m(t)},onClick:()=>{h&&h(t.key)},children:(0,n.jsxs)("div",{className:o("flex h-8 items-center gap-0.5 px-4 text-xs text-neutral-500",x===t.key?"bg-neutral-200 text-black dark:bg-neutral-800 dark:text-white":"hover:bg-neutral-100 dark:hover:bg-neutral-900",f===t.key&&b?"border border-blue-500":"border border-transparent","w-full","justify-start","cursor-pointer"),children:[(0,n.jsx)(a3,{depth:r}),(r>0||j)&&(0,n.jsx)(a8,{hasCollapsed:N,onClick:()=>{if(y){if(v){let e=new Set(v);e.has(t.key)?e.delete(t.key):e.add(t.key),y(e)}else y(new Set([t.key]))}},collapsed:w}),t.icon&&(0,n.jsxs)("div",{className:"relative mr-1 h-4 w-4 shrink-0",children:[(0,n.jsx)(t.icon,{className:o("h-4 w-4",t.iconColor)}),t.iconBadgeColor&&(0,n.jsx)("div",{className:o("absolute -right-0.5 -bottom-0.5 h-2 w-2 rounded-full",t.iconBadgeColor)})]}),(0,n.jsxs)("div",{className:"line-clamp-1 flex-1 text-xs",children:[(0,n.jsx)(a5,{text:t.name,highlight:d}),t.badgeContent&&(0,n.jsx)("span",{className:o("ml-1 rounded p-0.5 px-1 font-mono text-xs font-normal",null!==(a=t.badgeClassName)&&void 0!==a?a:"bg-red-500 text-white"),children:t.badgeContent})]}),t.progressBarValue&&t.progressBarMax&&(0,n.jsxs)("div",{className:"text-muted-foreground relative flex h-full w-[50px] items-center",children:[(0,n.jsx)("div",{className:"h-[20px] rounded-sm border border-gray-200 bg-gray-100 dark:border-gray-700 dark:bg-gray-800",style:{width:Math.max(Math.ceil(t.progressBarValue/t.progressBarMax*100),5)+"%"}}),(0,n.jsx)("span",{className:"absolute right-0",children:t.progressBarLabel})]})]})},t.key),w&&e({...l,depth:r+1,items:null!==(i=t.children)&&void 0!==i?i:[]})]},t.key)})})}({...m,depth:0,stopParentPropagation:c,setContextMenu:d,contextMenuKey:r,contextOpen:t,setContextMenuKey:l})})})}),(0,n.jsx)(aQ,{children:(0,n.jsx)(a1,{menu:i})})]})}var a9=a(76001);let a7=tW.bL;tW.l9;let ne=tW.ZL;tW.bm;let nt=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(tW.hJ,{ref:t,className:o("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...s})});nt.displayName=tW.hJ.displayName;let na=s.forwardRef((e,t)=>{let{className:a,children:s,...r}=e;return(0,n.jsxs)(ne,{children:[(0,n.jsx)(nt,{}),(0,n.jsxs)(tW.UC,{ref:t,className:o("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...r,children:[s,(0,n.jsxs)(tW.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-hidden focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,n.jsx)(Y.MKb,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});na.displayName=tW.UC.displayName;let nn=e=>{let{className:t,...a}=e;return(0,n.jsx)("div",{className:o("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};nn.displayName="DialogHeader";let ns=e=>{let{className:t,...a}=e;return(0,n.jsx)("div",{className:o("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};ns.displayName="DialogFooter";let nr=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(tW.hE,{ref:t,className:o("text-lg font-semibold leading-none tracking-tight",a),...s})});nr.displayName=tW.hE.displayName;let nl=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(tW.VY,{ref:t,className:o("text-sm text-muted-foreground",a),...s})});nl.displayName=tW.VY.displayName;let ni=s.forwardRef((e,t)=>{let{className:a,type:s,...r}=e;return(0,n.jsx)("input",{type:s,className:o("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-xs transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-hidden focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",a),ref:t,...r})});ni.displayName="Input";var no=a(51680),nd=a(76426);function nc(e){let{schemaName:t,onClose:a}=e,{databaseDriver:r}=x(),{schema:l,refresh:i}=eb(),[o,d]=(0,s.useState)(!1),[c,u]=(0,s.useState)(""),[m,h]=(0,s.useState)({name:{new:"",old:""},createScript:"",collate:""}),p=(0,s.useMemo)(()=>r.createUpdateDatabaseSchema(m).join(";\n"),[r,m]),f=(0,s.useCallback)(()=>{d(!0),r.transaction([p]).then(()=>{i(),a()}).catch(e=>u(e.message)).finally(()=>{d(!1)})},[r,a,p,i]),g=Object.keys(l).filter(e=>e!==t).map(e=>e).includes(m.name.new||"");return(0,n.jsxs)("div",{className:"flex h-full flex-col overflow-hidden relative",children:[c&&(0,n.jsxs)("div",{className:"text-sm text-red-500 font-mono flex gap-4 justify-end items-end",children:[(0,n.jsx)(no.A,{className:"w-12 h-12"}),(0,n.jsx)("p",{children:c})]}),(0,n.jsx)("div",{className:"flex gap-2 shrink-0 grow-0 py-4 px-1 border-neutral-200 dark:border-neutral-800",children:(0,n.jsxs)("div",{className:"w-full",children:[(0,n.jsx)("div",{className:"text-xs font-medium mb-1",children:"Schema Name"}),(0,n.jsx)(ni,{placeholder:"Schema Name",value:m.name.new||m.name.old||"",onChange:e=>{h({...m,name:{...m.name,new:e.currentTarget.value}})},disabled:!!t,className:"w-full ".concat(g?"border-red-600":"")}),g&&(0,n.jsxs)("small",{className:"text-xs text-red-500",children:["The schema name `",m.name.new,"` already exists."]})]})}),(0,n.jsx)("div",{className:"w-full flex flex-col pt-3",children:(0,n.jsx)("div",{className:"grow-0 shrink-0",children:(0,n.jsx)("div",{className:"p-1 flex gap-2 justify-end",children:(0,n.jsxs)(W,{variant:"ghost",disabled:!!g,size:"sm",onClick:f,children:[o?(0,n.jsx)(tq.A,{className:"w-4 h-4 mr-2 animate-spin"}):(0,n.jsx)(nd.A,{className:"w-4 h-4 mr-2"}),"Save"]})})})})]})}function nu(e){return(0,n.jsx)(a7,{defaultOpen:!0,onOpenChange:e.onClose,children:(0,n.jsxs)(na,{children:[(0,n.jsx)(nn,{children:e.schemaName?e.schemaName+"-Schema":"New Schema/Database"}),(0,n.jsx)(nc,{schemaName:e.schemaName,onClose:e.onClose})]})})}let nm=s.forwardRef((e,t)=>{let{className:a,selected:s,...r}=e;return(0,n.jsx)("div",{ref:t,className:o("rounded-md border bg-card p-5 text-card-foreground",a,s?"border-muted-foreground shadow-lg":"","hover:ring-1"),tabIndex:0,...r})});nm.displayName="BaseNode",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("div",{className:"relative w-full overflow-auto",children:(0,n.jsx)("table",{ref:t,className:o("w-full caption-bottom text-sm",a),...s})})}).displayName="Table",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("thead",{ref:t,className:o("[&_tr]:border-b",a),...s})}).displayName="TableHeader";let nh=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("tbody",{ref:t,className:o("[&_tr:last-child]:border-0",a),...s})});nh.displayName="TableBody",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("tfoot",{ref:t,className:o("border-t bg-muted/50 font-medium last:[&>tr]:border-b-0",a),...s})}).displayName="TableFooter";let nx=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("tr",{ref:t,className:o("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...s})});nx.displayName="TableRow",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("th",{ref:t,className:o("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...s})}).displayName="TableHead";let np=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("td",{ref:t,className:o("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...s})});function nf(e){let{schemaName:t,tableName:a,children:s}=e,{databaseDriver:r}=x();return(0,n.jsxs)(aX,{children:[(0,n.jsx)(aV,{children:s}),(0,n.jsxs)(aQ,{children:[(0,n.jsx)(aJ,{onClick:()=>{ri.tabs.openBuiltinTable({tableName:a,schemaName:t})},children:"Expore Table Data"}),r.getFlags().supportCreateUpdateTable&&(0,n.jsx)(aJ,{onClick:()=>{ri.tabs.openBuiltinSchema({schemaName:t,tableName:a})},children:"Edit Table"})]})]})}function ng(e){let{column:t}=e;return(0,n.jsxs)(nx,{className:"group relative text-xs",children:[(0,n.jsxs)(np,{className:"h-[30px] p-0 pr-6 pl-2 font-mono text-sm font-light",children:[(0,n.jsx)(eG,{id:t.title,type:"target",position:ez.yX.Left,className:"h-[10px]! w-[10px]! opacity-0 group-hover:opacity-100"}),(0,n.jsxs)("div",{className:"flex h-[30px] items-center",children:[(0,n.jsxs)("div",{className:"w-6",children:[t.pk&&(0,n.jsx)(ap.A,{size:15,color:"rgb(153 27 27)"}),t.fk&&(0,n.jsx)(ap.A,{size:15,color:"rgb(245 158 11)"})]}),(0,n.jsx)("div",{className:"max-w-[120px] truncate",children:t.title})]})]}),(0,n.jsxs)(np,{className:"relative h-[30px] p-0 pr-0 text-sm font-thin",children:[(0,n.jsxs)(c,{children:[(0,n.jsx)(u,{asChild:!0,children:(0,n.jsx)("div",{className:"text-muted-foreground flex h-[30px] w-[100px] items-center justify-end pr-2 font-mono",children:(0,n.jsx)("div",{className:"truncate",children:t.type})})}),(0,n.jsx)(m,{side:"right",children:t.type})]}),(0,n.jsx)(eG,{id:t.title,type:"source",position:ez.yX.Right,className:"h-[10px]! w-[10px]! opacity-0 group-hover:opacity-100"})]})]})}function nv(e){let{data:t,selected:a}=e,s=t.schema;return(0,n.jsxs)(nm,{className:"p-0",selected:a,children:[(0,n.jsx)(nf,{tableName:t.label,schemaName:t.schemaName,children:(0,n.jsx)("h2",{className:"bg-secondary text-muted-foreground flex h-[30px] max-w-[300px] items-center justify-center rounded-tl-md rounded-tr-md p-2 text-sm transition-all hover:text-blue-600",children:t.label})}),(0,n.jsx)("table",{className:"w-full overflow-visible",children:(0,n.jsx)(nh,{children:s.map(e=>(0,n.jsx)(ng,{column:e},e.title))})})]})}np.displayName="TableCell",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("caption",{ref:t,className:o("mt-4 text-sm text-muted-foreground",a),...s})}).displayName="TableCaption";var ny=a(12807),nb=a(29501);let nj=(0,X.F)("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-hidden focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent shadow-xs hover:bg-accent hover:text-accent-foreground"},size:{default:"h-9 px-3",sm:"h-8 px-2",lg:"h-10 px-3"}},defaultVariants:{variant:"default",size:"default"}});s.forwardRef((e,t)=>{let{className:a,variant:s,size:r,...l}=e;return(0,n.jsx)(nb.b,{ref:t,className:o(nj({variant:s,size:r,className:a})),...l})}).displayName=nb.b.displayName;let nN=s.createContext({size:"default",variant:"default"}),nw=s.forwardRef((e,t)=>{let{className:a,variant:s,size:r,children:l,...i}=e;return(0,n.jsx)(ny.bL,{ref:t,className:o("flex items-center justify-center gap-1",a),...i,children:(0,n.jsx)(nN.Provider,{value:{variant:s,size:r},children:l})})});nw.displayName=ny.bL.displayName,s.forwardRef((e,t)=>{let{className:a,children:r,variant:l,size:i,...d}=e,c=s.useContext(nN);return(0,n.jsx)(ny.q7,{ref:t,className:o(nj({variant:c.variant||l,size:c.size||i}),a),...d,children:r})}).displayName=ny.q7.displayName;var nC=a(85547),nk=a(61853);a(66419);var nS=a(89832),nE=a(7859);let nR=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(nE.uB,{ref:t,className:o("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",a),...s})});nR.displayName=nE.uB.displayName;let nT=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,n.jsx)(aK.A,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,n.jsx)(nE.uB.Input,{ref:t,className:o("placeholder:text-muted-foreground flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none disabled:cursor-not-allowed disabled:opacity-50",a),...s})]})});nT.displayName=nE.uB.Input.displayName;let nA=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(nE.uB.List,{ref:t,className:o("max-h-[300px] overflow-x-hidden overflow-y-auto",a),...s})});nA.displayName=nE.uB.List.displayName;let n_=s.forwardRef((e,t)=>(0,n.jsx)(nE.uB.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));n_.displayName=nE.uB.Empty.displayName;let nL=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(nE.uB.Group,{ref:t,className:o("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",a),...s})});nL.displayName=nE.uB.Group.displayName;let nI=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(nE.uB.Separator,{ref:t,className:o("bg-border -mx-1 h-px",a),...s})});nI.displayName=nE.uB.Separator.displayName;let nF=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(nE.uB.Item,{ref:t,className:o("data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",a),...s})});nF.displayName=nE.uB.Item.displayName;var nM=a(58346);function nD(e){let{onChange:t,value:a,readonly:r}=e,{schema:l}=eb(),[i,d]=(0,s.useState)(!1);return(0,n.jsxs)(te,{open:i,onOpenChange:d,children:[(0,n.jsx)(tt,{asChild:!0,children:(0,n.jsxs)(W,{variant:"outline",role:"combobox",className:"w-[200px] justify-between",disabled:r,children:[a||"Select schema",(0,n.jsx)(nM.A,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,n.jsx)(ta,{className:"w-[200px] p-0",children:(0,n.jsxs)(nR,{children:[(0,n.jsx)(nT,{placeholder:"Search schema"}),(0,n.jsxs)(nA,{children:[(0,n.jsx)(n_,{children:"No matched schema"}),(0,n.jsx)(nL,{children:Object.keys(l).map(e=>(0,n.jsxs)(nF,{value:e,disabled:r,onSelect:()=>{t(e),d(!1)},children:[(0,n.jsx)(aw.A,{className:o("mr-2 h-4 w-4",a===e?"opacity-100":"opacity-0")}),e]},e))})]})]})})]})}function nO(e){let{children:t}=e;return(0,n.jsx)("div",{className:"flex gap-1 p-1",children:t})}function nq(){return(0,n.jsx)("div",{className:"flex-1"})}function nU(e){let{disabled:t,loading:a,icon:s,onClick:r,badge:l,text:i,tooltip:d,destructive:h}=e,x=(0,n.jsxs)("button",{className:o("flex gap-2",V({variant:"ghost",size:"sm"}),h?"text-red-500 hover:text-red-500":""),disabled:t,onClick:r,children:[a?(0,n.jsx)(tq.A,{className:"h-4 w-4 animate-spin"}):s,i&&(0,n.jsx)("span",{children:i}),l&&(0,n.jsx)("span",{className:"ml-2 h-5 w-5 rounded-full bg-red-500 leading-5 text-white",style:{fontSize:9},children:l})]});return d?(0,n.jsxs)(c,{children:[(0,n.jsx)(u,{asChild:!0,children:x}),(0,n.jsx)(m,{children:d})]}):x}var nK=a(87426),nz=a(1620);function nB(e){let t=document.createElement("a");t.setAttribute("download","outerbase_relationship_diagram.png"),t.setAttribute("href",e),t.click()}function nP(){let{getNodes:e}=(0,eK.VH)();return(0,n.jsx)(W,{variant:"ghost",size:"sm",onClick:()=>{let t=(0,ez.Jo)(e()),a=(0,ez.R4)(t,1024,768,.5,2,0),n=document.querySelector(".react-flow__viewport");n&&(0,nz.$E)(n,{backgroundColor:"#1a365d",width:1024,height:768,style:{width:String(1024),height:String(768),transform:"translate(".concat(a.x,"px, ").concat(a.y,"px) scale(").concat(a.zoom,")")}}).then(nB)},className:"download-btn",children:(0,n.jsx)(nK.C,{size:15})})}function nH(e,t,a){var n,s,r,l,i,o,d;let c=[],u=new Set,m=new Set;for(let a of e[t])if("table"===a.type){for(let e of(null===(n=a.tableSchema)||void 0===n?void 0:n.columns)||[])e.constraint&&e.constraint.foreignKey&&(u.add(a.name),u.add(e.constraint.foreignKey.foreignTableName||""),m.add("".concat(a.name,".").concat(e.name)),c.push({type:"smoothstep",markerEnd:{type:ez.TG.ArrowClosed,width:14,height:14},id:"".concat(a.name,"-").concat(e.constraint.foreignKey.foreignTableName),source:a.name,target:e.constraint.foreignKey.foreignTableName||"",sourceHandle:e.name,targetHandle:e.constraint.foreignKey.foreignColumns?e.constraint.foreignKey.foreignColumns[0]:"",animated:!0,style:{strokeWidth:2}}));for(let e of(null===(s=a.tableSchema)||void 0===s?void 0:s.constraints)||[])if(e.foreignKey&&e.foreignKey.foreignTableName!==a.name&&1===(null!==(r=e.foreignKey.foreignColumns)&&void 0!==r?r:[]).length){u.add(a.name),u.add(e.foreignKey.foreignTableName||"");let t=e.foreignKey.columns?e.foreignKey.columns[0]:"";m.add("".concat(a.name,".").concat(t)),c.push({type:"smoothstep",markerEnd:{type:ez.TG.ArrowClosed,width:14,height:14},id:"".concat(a.name,"-").concat(e.foreignKey.foreignTableName),source:a.name,target:e.foreignKey.foreignTableName||"",sourceHandle:t,targetHandle:e.foreignKey.foreignColumns?e.foreignKey.foreignColumns[0]:"",animated:!0,style:{strokeWidth:2}})}}let h=e[t].filter(e=>"table"===e.type&&u.has(e.name)),x=e[t].filter(e=>"table"===e.type&&!u.has(e.name)),p=function(e,t,a){let n=new(eP()).graphlib.Graph().setDefaultEdgeLabel(()=>({}));return n.setGraph(a),t.forEach(e=>n.setEdge(e.source,e.target)),e.forEach(e=>{var t,a,s,r;return n.setNode(e.id,{...e,width:null!==(s=null===(t=e.measured)||void 0===t?void 0:t.width)&&void 0!==s?s:0,height:null!==(r=null===(a=e.measured)||void 0===a?void 0:a.height)&&void 0!==r?r:0})}),eP().layout(n),{nodes:e.map(e=>{var t,a,s,r;let l=n.node(e.id),i=l.x-(null!==(s=null===(t=e.measured)||void 0===t?void 0:t.width)&&void 0!==s?s:0)/2,o=l.y-(null!==(r=null===(a=e.measured)||void 0===a?void 0:a.height)&&void 0!==r?r:0)/2;return{...e,position:{x:i,y:o}}}),edges:t}}(h.map(e=>{var a,n;return{id:String(e.name),type:"databaseSchema",position:{x:0,y:0},measured:{width:300,height:32*((null===(a=e.tableSchema)||void 0===a?void 0:a.columns.length)||0)+32},data:{label:e.name,schemaName:t,schema:null===(n=e.tableSchema)||void 0===n?void 0:n.columns.map(t=>{var a;return{title:t.name,type:t.type,pk:!!t.pk,fk:m.has("".concat(e.name,".").concat(t.name)),unique:!!(null===(a=t.constraint)||void 0===a?void 0:a.unique)}})}}}),c,{rankdir:a||"LR",marginx:50,marginy:50}),f=0===p.nodes.length?0:(null!==(l=Math.max(...p.nodes.map(e=>e.position.x)))&&void 0!==l?l:0)+50+300,g=0===p.nodes.length?0:null!==(i=Math.min(...p.nodes.map(e=>e.position.y)))&&void 0!==i?i:0,v=Math.ceil(Math.sqrt(300*x.reduce((e,t)=>{var a;return e=e+32*((null===(a=t.tableSchema)||void 0===a?void 0:a.columns.length)||0)+32+50},0))/300),y=Array.from({length:v}).map(()=>0),b=Array.from({length:v}).map(()=>[]);for(let e of x){let a=y.indexOf(Math.min(...y)),n=32*((null===(o=e.tableSchema)||void 0===o?void 0:o.columns.length)||0)+32,s=f+50+300*a,r=g+y[a];y[a]+=n+50,b[a].push({id:String(e.name),type:"databaseSchema",position:{x:s,y:r},measured:{width:300,height:n},data:{label:e.name,schemaName:t,schema:null===(d=e.tableSchema)||void 0===d?void 0:d.columns.map(t=>{var a;return{title:t.name,type:t.type,pk:!!t.pk,fk:m.has("".concat(e.name,".").concat(t.name)),unique:!!(null===(a=t.constraint)||void 0===a?void 0:a.unique)}})}})}return{initialNodes:[...p.nodes,...b.flat()],initialEdges:p.edges}}function nX(){let[e,t,a]=(0,eK.ck)([]),[r,l,i]=(0,eK.fM)([]),{schema:o,currentSchemaName:d,refresh:c}=eb(),[u]=(0,s.useState)(o),[m,h]=(0,s.useState)(d);return(0,s.useEffect)(()=>{if(m){let{initialEdges:e,initialNodes:a}=nH(u,m);t(a),l(e)}},[u,m,t,l]),(0,n.jsxs)("div",{className:"relative flex h-full flex-col overflow-hidden",children:[(0,n.jsx)("div",{className:"border-b pb-1",children:(0,n.jsx)("h1",{className:"text-primary mb-1 p-4 text-lg font-semibold",children:"Entity Relationship Diagram"})}),(0,n.jsx)("div",{className:"shrink-0 grow-0 border-b border-neutral-200 dark:border-neutral-800",children:(0,n.jsxs)(nO,{children:[(0,n.jsx)(W,{variant:"ghost",size:"sm",onClick:c,children:(0,n.jsx)(nS.A,{className:"h-4 w-4 text-green-600"})}),(0,n.jsx)(W,{variant:"ghost",size:"sm",onClick:()=>{if(m){let{initialEdges:e,initialNodes:a}=nH(u,m);t(a),l(e)}},children:(0,n.jsx)(nC.p,{size:15})}),(0,n.jsx)(W,{variant:"ghost",size:"sm",onClick:()=>{if(m){let{initialEdges:e,initialNodes:a}=nH(u,m,"TB");t(a),l(e)}},children:(0,n.jsx)(nk.N,{size:15})}),(0,n.jsx)("div",{className:"mx-1",children:(0,n.jsx)(tV,{orientation:"vertical"})}),(0,n.jsx)(nP,{}),(0,n.jsx)("div",{className:"mx-1",children:(0,n.jsx)(tV,{orientation:"vertical"})}),(0,n.jsx)(nD,{value:m,onChange:e=>{h(e)}}),!1]})}),m&&(0,n.jsx)("div",{className:"relative flex-1 overflow-hidden",children:(0,n.jsxs)(eK.Gc,{nodes:e,edges:r,onNodesChange:a,onEdgesChange:i,fitView:!0,nodeTypes:{databaseSchema:nv},children:[(0,n.jsx)(eK.VS,{}),(0,n.jsx)(eK.H2,{}),(0,n.jsx)(eK.of,{})]})})]})}function nV(){return(0,n.jsx)(eK.Ln,{children:(0,n.jsx)(nX,{})})}var nW=a(30227);let nG=new au,nY=new au,nQ=new au;function nJ(e){return Object.freeze({generate:t=>{let a=[e.name,e.key(t)].filter(Boolean).join("-");return{...e.generate(t),key:a,identifier:a,type:e.name}},replace(t){let a=[e.name,e.key(t)].filter(Boolean).join("-");nY.send({...e.generate(t),key:a,identifier:a,type:e.name})},open(t){let a=[e.name,e.key(t)].filter(Boolean).join("-");nG.send({...e.generate(t),key:a,identifier:a,type:e.name})},close(t){let a=[e.name,e.key(t)].filter(Boolean).join("-");ri.tabs.close([a])}})}let nZ=nJ({name:"erd",key:()=>"",generate:()=>({title:"Relational Diagram",component:(0,n.jsx)(nV,{}),icon:nW.M})});var n$=a(86352);let n0=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(n$.bL,{ref:t,className:o("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow-sm focus-visible:outline-hidden focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...s,children:(0,n.jsx)(n$.C1,{className:o("flex items-center justify-center text-current"),children:(0,n.jsx)(Y.Srz,{className:"h-4 w-4"})})})});function n1(e){let{items:t,headers:a,extractKey:r,renderRow:l,selectedItems:i,onSelectedItemChanged:d,disabledSelection:c,forceShowSelectedItem:u}=e,m=t.length===i.length,[h,x]=(0,s.useState)(!1),p=(0,s.useCallback)(()=>{m?d([]):d([...t])},[m,t,d]);(0,s.useEffect)(()=>{0===i.length&&x(!1)},[i.length]);let f=(0,s.useMemo)(()=>0===i.length?null:h?(0,n.jsx)("span",{className:"cursor-pointer text-blue-600 underline",onClick:()=>x(!1),children:"Show all items"}):(0,n.jsx)("span",{className:"cursor-pointer text-blue-600 underline",onClick:()=>{x(!0)},children:"Show only the selected items"}),[i,h]);return(0,n.jsxs)("table",{className:"w-full border-separate border-spacing-0 text-sm",children:[(0,n.jsxs)("thead",{className:"sticky top-0",children:[(0,n.jsxs)("tr",{className:"h-[35px] bg-secondary text-xs",children:[!c&&(0,n.jsx)("th",{className:"border-b border-r px-2 text-left"}),a.map(e=>(0,n.jsx)("th",{className:"border-b border-r px-2 text-left",style:{width:e.width},children:e.text},e.key))]}),!c&&(0,n.jsxs)("tr",{className:"h-[40px] bg-background",children:[(0,n.jsx)("th",{className:"w-[40px] items-center justify-center border-b border-r",children:(0,n.jsx)(n0,{checked:m,onCheckedChange:p,disabled:c})}),(0,n.jsx)("th",{className:"border-b px-2 text-left font-normal",colSpan:a.length,children:(0,n.jsx)("div",{className:"flex",children:(0,n.jsxs)("div",{className:"flex flex-1 items-center gap-4 text-xs font-semibold",children:[(0,n.jsxs)("span",{children:[i.length," out of ",t.length," item",t.length>1&&"s"," selected"]}),f]})})})]})]}),(0,n.jsx)("tbody",{className:"font-mono",children:t.map(e=>{let t=r(e),a=!!i.find(e=>r(e)===t);return u&&!a||h&&!a?null:(0,n.jsxs)("tr",{onClick:c?void 0:()=>{a?d(i.filter(e=>r(e)!==t)):d([...i,e])},className:o("h-[40px] cursor-pointer hover:bg-accent",a?"text-primary":"text-gray-400 dark:text-gray-600"),children:[!c&&(0,n.jsx)("td",{className:"flex h-[40px] items-center justify-center border-b border-r",children:(0,n.jsx)(n0,{checked:a})}),l(e)]},t)})})]})}n0.displayName=n$.bL.displayName;var n2=a(16592),n4=a(63357),n5=a(25444),n3=a(52461);function n8(e){let{selectedItems:t,onClose:a,onConfirm:r}=e,[l,i]=(0,s.useState)("");return(0,n.jsx)(a7,{open:!0,onOpenChange:e=>{e||a()},children:(0,n.jsxs)(na,{children:[(0,n.jsx)(nr,{children:"Are you sure?"}),(0,n.jsxs)("div",{className:"text-sm",children:["You are about to drop the following tables.",(0,n.jsx)("div",{className:"font-mono gap-2 flex flex-wrap my-2",children:t.map(e=>(0,n.jsx)("div",{className:"p-1 bg-muted rounded",children:e.name},e.name))}),(0,n.jsxs)("p",{className:"text-2xl text-primary font-serif my-2 mt-8",children:["ln(x) + e",(0,n.jsx)("sup",{children:"x-1"})," - cos(x) = 0"]}),(0,n.jsx)("p",{className:"my-2",children:"Solve this equaltion or type confirm"}),(0,n.jsx)(ni,{className:"bg-surface",placeholder:"Type confirm",value:l,onKeyDown:e=>{"Enter"===e.key&&"confirm"===l&&r()},onChange:e=>{i(e.currentTarget.value)}})]}),(0,n.jsx)(ns,{children:(0,n.jsx)(W,{variant:"destructive",onClick:()=>{"confirm"===l&&r()},children:"Confirm"})})]})})}function n6(){let{databaseDriver:e}=x(),{schema:t,currentSchemaName:a,refresh:r}=eb(),[l]=(0,s.useState)(t),[i]=(0,s.useState)(a),[o,d]=(0,s.useState)([]),[c,u]=(0,s.useState)([]),[m,h]=(0,s.useState)({}),[p,f]=(0,s.useState)(null),[g,v]=(0,s.useState)(!1),[y,b]=(0,s.useState)(!1);(0,s.useEffect)(()=>{d([]),u(l[i].sort((e,t)=>e.name.localeCompare(t.name)))},[l,i]);let j=(0,s.useCallback)(()=>{b(!0),f("drop")},[]),N=(0,s.useCallback)(()=>{b(!0),f("empty")},[]),w=(0,s.useCallback)(async t=>{if(!p)return;let n={};for(let s of t)if("drop"===p)try{n={...n,[s.name]:"Dropping..."},h(n),await e.dropTable(a,s.name),n={...n,[s.name]:"Dropped"},h(n)}catch(e){h(n={...n,[s.name]:"Failed"})}else if("empty"===p)try{n={...n,[s.name]:"Emptying..."},h(n),await e.emptyTable(a,s.name),n={...n,[s.name]:"Emptied"},h(n)}catch(e){h(n={...n,[s.name]:"Failed"})}v(!0),r()},[p,a,e,r]),C=(0,s.useCallback)(e=>{let t=m[e.name]||"",a=null;return"Failed"===t?a=(0,n.jsx)(n2.J,{size:16,className:"text-red-500 mr-2 inline-block"}):t.includes("...")?a=(0,n.jsx)(n4.y,{size:16,className:"mr-2 animate-spin inline-block"}):("Dropped"===t||"Emptied"===t)&&(a=(0,n.jsx)(n5.J,{size:16,className:"text-green-500 mr-2 inline-block"})),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("td",{className:"py-2 px-2 h-[40px] w-[300px] border-b",children:[(0,n.jsx)(a9.X,{size:16,className:"mr-2 inline-block"}),e.name]}),(0,n.jsx)("td",{className:"py-2 px-2 h-[40px] w-[100px] border-b capitalize",children:e.type}),(0,n.jsxs)("td",{className:"py-2 px-2 h-[40px] border-b",children:[a,t]})]})},[m]),k=(0,s.useCallback)(e=>e.name,[]);return(0,n.jsxs)("div",{className:"flex h-full flex-col overflow-hidden",children:[y&&(0,n.jsx)(n8,{selectedItems:o,onClose:()=>{b(!1),f(null)},onConfirm:()=>{b(!1),w(o)}}),(0,n.jsxs)("div",{className:"border-b pb-1",children:[(0,n.jsx)("h1",{className:"text-lg font-semibold text-primary p-4 mb-1 border-b",children:"Drop & Empty Multiple Tables"}),(0,n.jsx)("div",{className:"px-1",children:(0,n.jsxs)(nO,{children:[(0,n.jsx)(nU,{disabled:0===o.length||g,icon:(0,n.jsx)(n3.l,{size:16,className:"text-red-500"}),text:"Drop Selected Table",onClick:j,destructive:!0}),(0,n.jsx)(nU,{text:"Empty Selected Table",disabled:0===o.length||g,onClick:N,destructive:!0})]})})]}),(0,n.jsx)("div",{className:"flex-1 overflow-scroll relative",children:(0,n.jsx)(n1,{headers:[{key:"name",text:"Name",width:"300px"},{key:"type",text:"Type",width:"100px"},{key:"status",text:""}],items:c,extractKey:k,renderRow:C,selectedItems:o,onSelectedItemChanged:d,forceShowSelectedItem:!y&&!!p,disabledSelection:!y&&!!p})})]})}var n9=a(60126);let n7=nJ({name:"mass-drop-table",key:()=>"",generate:()=>({title:"Mass Drop Tables",component:(0,n.jsx)(n6,{}),icon:n9.V})});var se=a(53203);let st=2,sa=nJ({name:"query",key:e=>(null==e?void 0:e.saved)?e.saved.key:window.crypto.randomUUID(),generate:e=>{var t,a;let s=(null==e?void 0:e.saved)?null!==(t=e.name)&&void 0!==t?t:"Query":"Query "+(st++).toString(),r=(null==e?void 0:e.saved)?(0,n.jsx)(aq,{initialName:s,initialCode:e.saved.sql,initialSavedKey:e.saved.key,initialNamespace:e.saved.namespaceName}):(0,n.jsx)(aq,{initialName:s});return{title:null!==(a=null==e?void 0:e.name)&&void 0!==a?a:"Query",component:r,icon:se.t}}});var sn=a(22783);function ss(){return(0,n.jsxs)("div",{className:"absolute left-0 right-0 top-0 bottom-0 z-10",children:[(0,n.jsx)("div",{className:"absolute left-0 right-0 top-0 bottom-0 opacity-50 bg-gray-600"}),(0,n.jsx)("div",{className:"absolute left-0 right-0 top-0 bottom-0 flex justify-center items-center",children:(0,n.jsxs)("div",{className:"p-5 bg-white rounded-lg justify-center items-center flex flex-col",children:[(0,n.jsx)(sn.A,{className:"animate-spin text-2xl mb-2"}),(0,n.jsx)("div",{className:"text-sm",children:"Loading"})]})})]})}var sr=a(83572);let sl=sr.bL;sr.l9;let si=sr.ZL,so=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(sr.hJ,{className:o("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...s,ref:t})});so.displayName=sr.hJ.displayName;let sd=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsxs)(si,{children:[(0,n.jsx)(so,{}),(0,n.jsx)(sr.UC,{ref:t,className:o("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...s})]})});sd.displayName=sr.UC.displayName;let sc=e=>{let{className:t,...a}=e;return(0,n.jsx)("div",{className:o("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};sc.displayName="AlertDialogFooter";let su=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(sr.hE,{ref:t,className:o("text-lg font-semibold",a),...s})});su.displayName=sr.hE.displayName;let sm=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(sr.VY,{ref:t,className:o("text-sm text-muted-foreground",a),...s})});sm.displayName=sr.VY.displayName;let sh=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(sr.rc,{ref:t,className:o(V(),a),...s})});sh.displayName=sr.rc.displayName;let sx=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(sr.ZD,{ref:t,className:o(V({variant:"outline"}),"mt-2 sm:mt-0",a),...s})});sx.displayName=sr.ZD.displayName;var sp=a(35629);function sf(e){let{schema:t,previewScript:a,onClose:r,fetchTable:l}=e,{databaseDriver:i}=x(),{refresh:o}=eb(),[d,c]=(0,s.useState)(!1),[u,m]=(0,s.useState)(""),{replaceCurrentTab:h}=aM(),p=(0,s.useCallback)(()=>{c(!0),i.transaction(a).then(()=>{if(t.name.new!==t.name.old)o(),h({component:(0,n.jsx)(s3,{tableName:t.name.new,schemaName:t.schemaName}),key:"_schema_"+t.name.new,identifier:"_schema_"+t.name.new,title:"Edit "+t.name.new,icon:sp.A});else if(t.name.old&&t.schemaName){var e,a;l(t.schemaName,(null===(e=t.name)||void 0===e?void 0:e.new)||(null===(a=t.name)||void 0===a?void 0:a.old)||"").then(r)}}).catch(e=>m(e.message)).finally(()=>{c(!1)})},[r,i,t,l,a,h,o]);return(0,n.jsx)(sl,{open:!0,onOpenChange:r,children:(0,n.jsxs)(sd,{children:[(0,n.jsx)(su,{children:"Preview"}),u&&(0,n.jsxs)("div",{className:"text-sm text-red-500 font-mono flex gap-4 justify-end items-end",children:[(0,n.jsx)(no.A,{className:"w-12 h-12"}),(0,n.jsx)("p",{children:u})]}),(0,n.jsx)("p",{children:"Are you sure you want to run this change?"}),(0,n.jsx)(e3,{code:a.join(";\n")}),(0,n.jsxs)(sc,{children:[(0,n.jsx)(sx,{children:"Cancel"}),(0,n.jsxs)(W,{onClick:p,children:[d?(0,n.jsx)(tq.A,{className:"w-4 h-4 mr-2 animate-spin"}):(0,n.jsx)(nd.A,{className:"w-4 h-4 mr-2"}),"Continue"]})]})]})})}var sg=a(62582),sv=a(96758),sy=a(66329);function sb(e){var t,a,r,l;let{constraint:i,disabled:o,onChange:d}=e,c=(0,s.useMemo)(()=>(null==i?void 0:i.defaultValue)!==void 0&&(null==i?void 0:i.defaultValue)!==null?i.defaultValue.toString():(null==i?void 0:i.defaultExpression)!==void 0?null==i?void 0:i.defaultExpression:(null==i?void 0:i.autoIncrement)?(0,n.jsx)("span",{children:"Auto Increment"}):(0,n.jsx)("span",{className:"text-gray-500",children:"No Default"}),[i]),u=(0,s.useCallback)(e=>{e&&d({defaultExpression:void 0,defaultValue:void 0,autoIncrement:e})},[d]),m=(0,s.useCallback)(e=>{e&&d({defaultExpression:void 0,defaultValue:void 0,autoIncrement:void 0})},[d]),h=(0,s.useCallback)(e=>{e&&d({autoIncrement:void 0,defaultExpression:void 0,defaultValue:""})},[d]),x=(0,s.useCallback)(e=>{d({autoIncrement:void 0,defaultExpression:void 0,defaultValue:e.currentTarget.value})},[d]),p=(0,s.useCallback)(e=>{e&&d({autoIncrement:void 0,defaultExpression:"",defaultValue:void 0})},[d]),f=(0,s.useCallback)(e=>{d({autoIncrement:void 0,defaultExpression:e.currentTarget.value,defaultValue:void 0})},[d]),g=(null==i?void 0:i.defaultValue)===void 0&&(null==i?void 0:i.defaultExpression)===void 0&&!(null==i?void 0:i.autoIncrement);return(0,n.jsxs)(te,{children:[(0,n.jsx)(tt,{className:"h-full flex w-full",children:(0,n.jsxs)("div",{className:"flex text-left px-2 py-2 text-sm h-full bg-background",children:[(0,n.jsx)("div",{className:"grow w-[150px] overflow-hidden mr-2",children:c||"EMPTY STRING"}),(0,n.jsx)("div",{className:"text-gray-400 flex items-center",children:(0,n.jsx)(nM.A,{size:14})})]})}),(0,n.jsx)(ta,{children:(0,n.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(n0,{id:"no-default-value",disabled:o,checked:g,onCheckedChange:m}),(0,n.jsx)(tg,{htmlFor:"no-default-value",children:"No Default Value"})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(n0,{id:"auto-increment",disabled:o,checked:!!(null==i?void 0:i.autoIncrement),onCheckedChange:u}),(0,n.jsx)(tg,{htmlFor:"auto-increment",children:"Autoincrement"})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(n0,{id:"custom-value",disabled:o,checked:(null==i?void 0:i.defaultValue)!==void 0,onCheckedChange:h}),(0,n.jsx)(tg,{htmlFor:"custom-value",children:"Custom Value"})]}),(0,n.jsx)("div",{className:"flex mt-2 mb-2",children:(0,n.jsx)(ni,{readOnly:o,placeholder:"Default Value",value:null!==(r=null==i?void 0:null===(t=i.defaultValue)||void 0===t?void 0:t.toString())&&void 0!==r?r:"",onChange:x})}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(n0,{id:"custom-expression",disabled:o,checked:(null==i?void 0:i.defaultExpression)!==void 0,onCheckedChange:p}),(0,n.jsx)(tg,{htmlFor:"custom-expression",children:"Custom Expression"})]}),(0,n.jsx)("div",{className:"flex mt-2 mb-2",children:(0,n.jsx)(ni,{readOnly:o,placeholder:"Expression",value:null!==(l=null==i?void 0:null===(a=i.defaultExpression)||void 0===a?void 0:a.toString())&&void 0!==l?l:"",onChange:f})})]})})]})}var sj=a(85311);function sN(e){let{value:t,onChange:a,disabled:s}=e;return(0,n.jsxs)(to,{value:t,onValueChange:a,children:[(0,n.jsx)(tc,{className:"bg-background",disabled:s,children:(0,n.jsx)(td,{placeholder:"Conflict"})}),(0,n.jsxs)(th,{children:[(0,n.jsx)(tx,{value:"ROLLBACK",children:"Rollback"}),(0,n.jsx)(tx,{value:"ABORT",children:"Abort"}),(0,n.jsx)(tx,{value:"FAIL",children:"Fail"}),(0,n.jsx)(tx,{value:"IGNORE",children:"Ignore"}),(0,n.jsx)(tx,{value:"REPLACE",children:"Replace"})]})]})}function sw(e){let{constraint:t,disabled:a,onChange:s}=e;return(0,n.jsxs)(te,{children:[(0,n.jsx)(tt,{children:(0,n.jsx)("span",{className:"p-1 shadow-sm border rounded block bg-green-200 dark:bg-green-600",children:(0,n.jsx)(sj.A,{className:"w-4 h-4"})})}),(0,n.jsx)(ta,{children:(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)("div",{className:"font-semibold text-sm",children:"Primary Key"}),(0,n.jsxs)(to,{value:t.primaryKeyOrder,disabled:a,onValueChange:e=>{s({constraint:{primaryKeyOrder:e}})},children:[(0,n.jsx)(tc,{className:"bg-background",children:(0,n.jsx)(td,{placeholder:"Order"})}),(0,n.jsxs)(th,{children:[(0,n.jsx)(tx,{value:"ASC",children:"ASC"}),(0,n.jsx)(tx,{value:"DESC",children:"DESC"})]})]}),(0,n.jsx)(sN,{value:t.primaryKeyConflict,disabled:a,onChange:e=>{s({constraint:{primaryKeyConflict:e}})}}),(0,n.jsx)(W,{size:"sm",className:"mt-4",variant:"destructive",disabled:a,onClick:()=>{s({constraint:{primaryKey:void 0,primaryKeyConflict:void 0,primaryKeyOrder:void 0}})},children:"Remove Constraint"})]})})]})}var sC=a(26039);function sk(e){let{constraint:t,disabled:a,onChange:s}=e;return(0,n.jsxs)(te,{children:[(0,n.jsx)(tt,{children:(0,n.jsx)("span",{className:"p-1 shadow-sm border rounded block bg-yellow-200 dark:bg-yellow-600",children:(0,n.jsx)(sC.A,{className:"w-4 h-4"})})}),(0,n.jsx)(ta,{children:(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)("div",{className:"font-semibold text-sm",children:"Unique"}),(0,n.jsx)(sN,{value:t.uniqueConflict,disabled:a,onChange:e=>{s({constraint:{uniqueConflict:e}})}}),(0,n.jsx)(W,{size:"sm",className:"mt-4",variant:"destructive",disabled:a,onClick:()=>{s({constraint:{unique:void 0,uniqueConflict:void 0}})},children:"Remove Constraint"})]})})]})}function sS(e){let{value:t,tableName:a,schemaName:r,onChange:l,disabled:i}=e,{databaseDriver:d}=x(),[c,u]=(0,s.useState)(!1),[m,h]=(0,s.useState)();return(0,s.useEffect)(()=>{a&&d.tableSchema(r,a).then(h).catch(()=>{h({tableName:a,schemaName:r,columns:[],pk:[],autoIncrement:!1,constraints:[]})})},[r,a,d]),(0,n.jsxs)(e7.AM,{open:c,onOpenChange:u,children:[(0,n.jsx)(e7.Wv,{disabled:i,children:(0,n.jsxs)(W,{variant:"outline",className:"justify-between w-full",children:[null!=t?t:"No column selected",(0,n.jsx)(nM.A,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,n.jsx)(ta,{className:"w-[250px] p-0",children:(0,n.jsxs)(nR,{children:[(0,n.jsx)(nT,{placeholder:"Search column name..."}),(0,n.jsx)(n_,{children:"No column found."}),(0,n.jsx)(nL,{className:"max-h-[250px] overflow-y-auto",children:null==m?void 0:m.columns.map(e=>(0,n.jsxs)(nF,{value:e.name,onSelect:()=>{l(e.name),u(!1)},children:[(0,n.jsx)(aw.A,{className:o("mr-2 h-4 w-4",t===e.name?"opacity-100":"opacity-0")}),e.name]},e.name))})]})})]})}var sE=a(6235);function sR(e){var t;let{value:a,onChange:r,schemaName:l,disabled:i,borderless:d}=e,[c,u]=(0,s.useState)(!1),{schema:m,refresh:h}=eb();return(0,n.jsxs)(te,{open:c,onOpenChange:u,children:[(0,n.jsx)(tt,{asChild:!0,disabled:i,children:d?(0,n.jsxs)("div",{className:"flex w-full items-center justify-between px-2",children:[null!=a?a:"No table selected",(0,n.jsx)(nM.A,{className:"ml-2 h-3 w-3 shrink-0 opacity-50"})]}):(0,n.jsxs)("div",{className:o(V({variant:"outline"}),"flex w-full justify-between"),children:[null!=a?a:"No table selected",(0,n.jsx)(nM.A,{className:"ml-2 h-3 w-3 shrink-0 opacity-50"})]})}),(0,n.jsxs)(ta,{className:"w-[250px] p-0",children:[(0,n.jsxs)(nR,{children:[(0,n.jsx)(nT,{placeholder:"Search table name..."}),(0,n.jsx)(n_,{children:"No table found."}),(0,n.jsx)(nL,{className:"max-h-[250px] overflow-y-auto",children:(null!==(t=m[l])&&void 0!==t?t:[]).map(e=>(0,n.jsxs)(nF,{value:e.name,onSelect:()=>{r(e.name),u(!1)},children:[(0,n.jsx)(aw.A,{className:o("mr-2 h-4 w-4",a===e.name?"opacity-100":"opacity-0")}),e.name]},e.name))})]}),(0,n.jsxs)("div",{className:"p-1",children:[(0,n.jsx)(tV,{}),(0,n.jsxs)(W,{variant:"link",className:"w-full",size:"sm",onClick:()=>{h()},children:[(0,n.jsx)(sE.A,{className:"mr-2 h-4 w-4"})," Refresh"]})]})]})]})}function sT(e){var t;let{constraint:a,disabled:s,schemaName:r,onChange:l}=e;return(0,n.jsxs)(te,{children:[(0,n.jsx)(tt,{children:(0,n.jsx)("span",{className:"p-1 shadow-sm border rounded block bg-blue-300 dark:bg-blue-600",children:(0,n.jsx)(tU.A,{className:"w-4 h-4"})})}),(0,n.jsx)(ta,{children:(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)("div",{className:"font-semibold text-sm",children:"Foreign Key"}),(0,n.jsx)(tV,{}),(0,n.jsxs)("div",{className:"flex flex-col gap-2 mt-2",children:[(0,n.jsx)(tg,{className:"text-xs font-normal",children:"Foreign Table Name"}),(0,n.jsx)(sR,{schemaName:r,value:a.foreignTableName,disabled:s,onChange:e=>{l({constraint:{foreignKey:{...a,foreignTableName:e}}})}})]}),a.foreignTableName&&(0,n.jsxs)("div",{className:"flex flex-col gap-2 mt-2",children:[(0,n.jsx)(tg,{className:"text-xs font-normal",children:"Foreign Column Name"}),(0,n.jsx)(sS,{value:(null!==(t=a.foreignColumns)&&void 0!==t?t:[void 0])[0],disabled:s,onChange:e=>{l({constraint:{foreignKey:{...a,foreignColumns:[e]}}})},schemaName:r,tableName:a.foreignTableName})]}),(0,n.jsx)(W,{size:"sm",className:"mt-4",variant:"destructive",disabled:s,onClick:()=>{l({constraint:{foreignKey:void 0}})},children:"Remove Constraint"})]})})]})}let sA=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("textarea",{className:o("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-xs placeholder:text-muted-foreground focus-visible:outline-hidden focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",a),ref:t,...s})});function s_(e){var t;let{constraint:a,disabled:s,onChange:r}=e;return(0,n.jsxs)(te,{children:[(0,n.jsx)(tt,{children:(0,n.jsx)("span",{className:"p-1 shadow-sm border rounded block",children:(0,n.jsx)(ag.A,{className:"w-4 h-4"})})}),(0,n.jsx)(ta,{children:(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)("div",{className:"font-semibold text-sm",children:"Generating Function"}),(0,n.jsx)(sA,{rows:4,disabled:s,placeholder:"Generate Expression",className:"font-mono bg-background",onChange:e=>{r({constraint:{generatedExpression:e.currentTarget.value}})},value:null!==(t=a.generatedExpression)&&void 0!==t?t:""}),(0,n.jsxs)(to,{value:null==a?void 0:a.generatedType,onValueChange:e=>{r({constraint:{generatedType:e}})},children:[(0,n.jsx)(tc,{className:"bg-background",children:(0,n.jsx)(td,{placeholder:"Select datatype"})}),(0,n.jsxs)(th,{children:[(0,n.jsx)(tx,{value:"VIRTUAL",children:"Virtual"}),(0,n.jsx)(tx,{value:"STORED",children:"Stored"})]})]}),(0,n.jsx)(W,{size:"sm",className:"mt-4",variant:"destructive",disabled:s,onClick:()=>{r({constraint:{generatedExpression:void 0,generatedType:void 0}})},children:"Remove Constraint"})]})})]})}function sL(e){var t;let{constraint:a,disabled:s,onChange:r}=e;return(0,n.jsxs)(te,{children:[(0,n.jsx)(tt,{children:(0,n.jsx)("span",{className:"p-1 shadow-sm border rounded block",children:(0,n.jsx)(aw.A,{className:"w-4 h-4"})})}),(0,n.jsx)(ta,{children:(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)("div",{className:"font-semibold text-sm",children:"Check"}),(0,n.jsx)(sA,{rows:4,placeholder:"Check Expression",className:"font-mono bg-background",disabled:s,value:null!==(t=a.checkExpression)&&void 0!==t?t:"",onChange:e=>{r({constraint:{checkExpression:e.currentTarget.value}})}}),(0,n.jsx)(W,{size:"sm",className:"mt-4",variant:"destructive",disabled:s,onClick:()=>{r({constraint:{checkExpression:void 0}})},children:"Remove Constraint"})]})})]})}sA.displayName="Textarea";var sI=a(3513);function sF(e){let{items:t,onChange:a}=e;return t.map(e=>(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-sm font-bold py-1 px-4 bg-accent mb-1",children:e.name}),(0,n.jsx)("div",{className:"flex flex-col",children:e.suggestions.map(e=>{var t;let s=null!==(t=e.parameters)&&void 0!==t?t:[],r=(0,n.jsx)("span",{children:e.name.toUpperCase()});return s.length>0&&(r=(0,n.jsxs)(n.Fragment,{children:[e.name.toUpperCase(),(0,n.jsx)("strong",{className:"ml-0.5",children:"("}),(0,n.jsx)("span",{className:"text-muted-foreground",children:s.map(e=>e.name).join(", ")}),(0,n.jsx)("strong",{children:")"})]})),(0,n.jsx)("div",{className:"py-0.5 px-3 pl-8 cursor-pointer hover:bg-muted",onPointerDown:e=>{e.preventDefault()},onClick:()=>{s.length>0?a("".concat(e.name.toUpperCase(),"(").concat(s.map(e=>e.default).join(","),")")):a("".concat(e.name.toUpperCase()))},children:r},e.name)})})]},e.name))}function sM(e){let{value:t,onChange:a,suggestions:r}=e,[l,i]=(0,s.useState)(!1),{parsedType:o,parsedParameters:d}=(0,s.useMemo)(()=>{var e;let a=t.match(/([a-zA-Z]+)(\((.*)\))?/);if(!a)return{parsedType:""};let n=a[1];return{parsedType:null!=n?n:"",parsedParameters:null===(e=a[3])||void 0===e?void 0:e.split(",").map(e=>e.trim())}},[t]),c=r.map(e=>({...e,suggestions:e.suggestions.filter(e=>e.name.toLowerCase().startsWith(o.toLowerCase())&&"uuid"!==e.name).map(e=>["enum","set"].includes(e.name)?{...e,parameters:[{name:"",default:"'Y','N'"}]}:e)})).filter(e=>e.suggestions.length>0),u=(0,n.jsx)(sF,{items:c,onChange:a});if(1===c.length&&1===c[0].suggestions.length&&c[0].suggestions[0].name.toLowerCase()===o.toLowerCase()){let e=c[0].suggestions[0];u=(0,n.jsxs)("div",{className:"p-4",children:[(0,n.jsxs)("div",{className:"text-lg font-semibold",children:[e.name.toUpperCase(),e.parameters&&e.parameters.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("strong",{children:"("}),(0,n.jsx)("span",{className:"text-muted-foreground",children:null==e?void 0:e.parameters.map(e=>e.name).join(", ")}),(0,n.jsx)("strong",{children:")"})]})]}),"string"==typeof e.description&&(0,n.jsx)("div",{className:"text-sm my-1 font-sans",children:e.description}),"function"==typeof e.description&&(0,n.jsx)("div",{className:"text-sm my-1 font-sans",dangerouslySetInnerHTML:{__html:e.description(o,d)}}),e.parameters&&(0,n.jsx)("ul",{className:"flex flex-col gap-1 my-2 text-sm",children:e.parameters.map(e=>(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{className:"font-semibold",children:e.name}),(0,n.jsx)("p",{className:"text-muted-foreground",children:e.description})]},e.name))})]})}return(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("input",{className:"p-2 text-sm outline-hidden w-[150px] bg-inherit",onFocus:()=>i(!0),onBlur:()=>{i(!1)},value:t,onChange:e=>{a(e.target.value)}}),l&&(0,n.jsxs)(te,{open:l,modal:!1,children:[(0,n.jsx)(tt,{}),(0,n.jsx)(ta,{className:"w-[300px] max-h-[300px] p-0 overflow-y-auto mt-2 font-mono",onOpenAutoFocus:e=>e.preventDefault(),children:u})]})]})}function sD(e){let{value:t,onChange:a,disabled:s}=e;return(0,n.jsx)("input",{value:t||"",placeholder:"Collation",disabled:s,list:"collation-list",className:"p-2 text-xs outline-hidden w-[150px] bg-inherit",spellCheck:!1,onChange:e=>a(e.currentTarget.value)})}var sO=a(73875),sq=a.n(sO);function sU(e){return!ab()(e.old,e.new)}function sK(e){var t;let{value:a,onChange:s,disabled:r}=e,{databaseDriver:l}=x();if("dropdown"===l.columnTypeSelector.type&&l.columnTypeSelector.dropdownOptions){let e=l.columnTypeSelector.dropdownNormalized&&l.columnTypeSelector.dropdownNormalized(a)||a;return(0,n.jsxs)(to,{value:e,onValueChange:s,disabled:r,children:[(0,n.jsx)(tc,{className:"bg-inherit border-0 rounded-none shadow-none text-sm",children:(0,n.jsx)(td,{placeholder:"Select datatype"})}),(0,n.jsx)(th,{children:l.columnTypeSelector.dropdownOptions.map(e=>(0,n.jsx)(tx,{value:e.value,children:e.text},e.value))})]})}return(0,n.jsx)(sM,{onChange:s,value:a,suggestions:null!==(t=l.columnTypeSelector.typeSuggestions)&&void 0!==t?t:[]})}function sz(e){var t,a,r,l,i,d,c;let{value:u,idx:m,schemaName:h,onChange:x,options:p,disabledEditExistingColumn:f}=e,{setNodeRef:g,attributes:v,listeners:y,transform:b,transition:j,setActivatorNodeRef:N}=(0,aE.gl)({id:u.key,disabled:!!u.old}),w=!!f&&!!u.old,C={transform:sy.Ks.Transform.toString(b),transition:j},k=(0,s.useCallback)(e=>{x(t=>{if(t){var a,n,s;let r=[...null!==(a=null==t?void 0:t.columns)&&void 0!==a?a:[]],l=r[m];if(l.new)return(l.new=null===e?null:{...l.new,...e,constraint:(null==e?void 0:e.constraint)?{...null===(n=l.new)||void 0===n?void 0:n.constraint,...null==e?void 0:e.constraint}:null===(s=l.new)||void 0===s?void 0:s.constraint},l.new||l.old)?{...t,columns:r}:{...t,columns:r.filter((e,t)=>t!==m)}}return t})},[m,x]),S=u.new||u.old;if(!S)return null;let E="";return null===u.new?E="bg-red-400 dark:bg-red-800":null===u.old?E="bg-green-500 dark:bg-green-800":sU(u)&&(E="bg-yellow-400"),(0,n.jsxs)("tr",{style:C,...v,ref:g,className:null===u.new?"bg-red-100 dark:bg-red-400 dark:text-black":"bg-background",children:[(0,n.jsx)("td",{ref:N,...y,className:o("border-l border-t border-b"),children:(0,n.jsx)("div",{className:o("w-[12px] h-[30px] ml-1 rounded",E)})}),(0,n.jsx)("td",{className:"border-r border-t border-b",children:(0,n.jsx)("input",{value:S.name,onChange:e=>k({name:e.currentTarget.value}),className:"p-2 text-sm outline-hidden w-[150px] bg-inherit",spellCheck:!1})}),(0,n.jsx)("td",{className:"border",children:(0,n.jsx)(sK,{value:S.type,onChange:e=>k({type:e}),disabled:w})}),(0,n.jsx)("td",{className:"border",children:(0,n.jsx)(sb,{onChange:e=>k({constraint:e}),constraint:S.constraint,disabled:w})}),(0,n.jsx)("td",{className:"border text-center w-[50px]",children:(0,n.jsx)(n0,{disabled:w,checked:!(null===(t=S.constraint)||void 0===t?void 0:t.notNull),onCheckedChange:e=>k({constraint:{notNull:!e}})})}),(0,n.jsx)("td",{className:"border px-2",children:(0,n.jsxs)("div",{className:"flex gap-2",children:[(null===(a=S.constraint)||void 0===a?void 0:a.primaryKey)&&(0,n.jsx)(sw,{constraint:S.constraint,disabled:w,onChange:k}),(null===(r=S.constraint)||void 0===r?void 0:r.unique)&&(0,n.jsx)(sk,{constraint:S.constraint,disabled:w,onChange:k}),(null===(l=S.constraint)||void 0===l?void 0:l.checkExpression)!==void 0&&(0,n.jsx)(sL,{constraint:S.constraint,disabled:w,onChange:k}),(null===(i=S.constraint)||void 0===i?void 0:i.generatedExpression)!==void 0&&(0,n.jsx)(s_,{constraint:S.constraint,disabled:w,onChange:k}),(null===(d=S.constraint)||void 0===d?void 0:d.foreignKey)&&h&&(0,n.jsx)(sT,{constraint:S.constraint.foreignKey,disabled:w,onChange:k,schemaName:h}),(0,n.jsxs)(Q,{children:[(0,n.jsx)(J,{asChild:!0,children:(0,n.jsx)("button",{className:"p-1 shadow-sm border rounded",children:(0,n.jsx)(ao.A,{className:"w-4 h-4"})})}),(0,n.jsxs)(Z,{children:[(0,n.jsx)(ee,{children:"Constraint"}),(0,n.jsx)(et,{}),(0,n.jsx)($,{inset:!0,disabled:w,onClick:()=>{k({constraint:{primaryKey:!0}})},children:"Primary Key"}),(0,n.jsx)($,{inset:!0,disabled:w,onClick:()=>{k({constraint:{unique:!0}})},children:"Unique"}),(0,n.jsx)($,{inset:!0,disabled:w,onClick:()=>{k({constraint:{checkExpression:""}})},children:"Check Constraint"}),(0,n.jsx)($,{inset:!0,disabled:w,onClick:()=>{k({constraint:{foreignKey:{}}})},children:"Foreign Key"}),(0,n.jsx)($,{inset:!0,disabled:w,onClick:()=>{k({constraint:{generatedType:"VIRTUAL",generatedExpression:""}})},children:"Virtuality"})]})]})]})}),p.collations.length>0&&(0,n.jsx)("td",{className:"border",children:(0,n.jsx)(sD,{value:null===(c=S.constraint)||void 0===c?void 0:c.collate,onChange:e=>{k({constraint:{...S.constraint,collate:e||void 0}})}})}),(0,n.jsx)("td",{className:"px-1 border",children:(0,n.jsx)("button",{className:"p-1",onClick:()=>{k(null)},children:(0,n.jsx)(ad.A,{className:"w-4 h-4 text-red-500"})})})]})}function sB(e){let{columns:t,onChange:a,schemaName:r,onAddColumn:l,disabledEditExistingColumn:i,options:d}=e,c="text-xs p-2 text-left bg-secondary border",u=(0,s.useCallback)(e=>{let{active:n,over:s}=e;if(n.id!==(null==s?void 0:s.id)){let e=t.findIndex(e=>e.key===n.id),r=t.findIndex(e=>e.key===(null==s?void 0:s.id));if(t[r].old)return;let l=(0,aE.be)(t,e,r);a(e=>({...e,columns:l}))}},[t,a]),m=(0,s.useMemo)(()=>{let e=7;return d.collations.length>0&&e++,e},[d]);return(0,n.jsxs)("div",{className:"p-4",children:[d.collations.length>0&&(0,n.jsx)("datalist",{id:"collation-list",className:"hidden",children:d.collations.map(e=>(0,n.jsx)("option",{value:e},e))}),(0,n.jsx)(aS.Mp,{onDragEnd:u,modifiers:[sI.FN],children:(0,n.jsxs)("table",{className:"w-full rounded overflow-hidden",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:o(c,"w-[20px]")}),(0,n.jsx)("th",{className:o(c,"w-[100px]"),children:"Name"}),(0,n.jsx)("th",{className:o(c,"w-[150px]"),children:"Type"}),(0,n.jsx)("th",{className:o(c,"w-[150px]"),children:"Default"}),(0,n.jsx)("th",{className:o(c,"w-[50px]"),children:"Null"}),(0,n.jsx)("th",{className:o(c),children:"Constraint"}),d.collations.length>0&&(0,n.jsx)("th",{className:o(c,"w-[160px]"),children:"Collation"}),(0,n.jsx)("th",{className:o(c,"w-[30px]")})]})}),(0,n.jsx)("tbody",{children:(0,n.jsx)(aE.gB,{items:t.map(e=>e.key),strategy:aE._G,children:t.map((e,t)=>(0,n.jsx)(sz,{idx:t,value:e,onChange:a,schemaName:r,disabledEditExistingColumn:i,options:d},e.key))})}),(0,n.jsx)("tfoot",{children:(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:m,className:"px-4 py-2 border",children:(0,n.jsxs)(W,{size:"sm",onClick:l,children:[(0,n.jsx)(ao.A,{className:"w-4 h-4 mr-1"})," Add Column"]})})})})]})})]})}var sP=a(9805),sH=a(25917);function sX(e){let{value:t,columns:a,onChange:r,disabled:l}=e,[i,o]=(0,s.useState)(!1);return(0,n.jsxs)("div",{className:"flex gap-2",children:[t.map((e,a)=>(0,n.jsxs)("div",{className:"px-2 bg-secondary rounded flex items-center",children:[(0,n.jsx)("span",{className:"p-1",children:e}),!l&&(0,n.jsx)("span",{className:"p-1 rounded-full ml-1 cursor-pointer hover:bg-red-400",onClick:()=>{r(t.filter(t=>t!==e))},children:(0,n.jsx)(aR.A,{className:"w-3 h-3"})})]},a)),!l&&(0,n.jsxs)(te,{open:i,onOpenChange:o,children:[(0,n.jsx)(tt,{children:(0,n.jsx)("button",{className:"p-1 bg-secondary rounded",children:(0,n.jsx)(ao.A,{className:"w-4 h-4"})})}),(0,n.jsx)(ta,{className:"w-[250px] p-0",children:(0,n.jsxs)(nR,{children:[(0,n.jsx)(nT,{placeholder:"Search column name..."}),(0,n.jsx)(n_,{children:"No column found."}),(0,n.jsx)(nL,{className:"max-h-[250px] overflow-y-auto",children:a.filter(e=>!t.includes(e)).map(e=>(0,n.jsx)(nF,{value:e,onSelect:()=>{o(!1),r([...t,e])},children:e},e))})]})})]})]})}let sV=(0,s.createContext)({columns:[]});function sW(){return(0,s.useContext)(sV)}function sG(e){let{children:t,value:a}=e;return(0,n.jsx)(sV.Provider,{value:{columns:a},children:t})}function sY(e){let{constraint:t,onChange:a,disabled:s}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("td",{className:"border p-2",children:[(0,n.jsx)(aw.A,{className:"mr-2 inline h-4 w-4"})," Check"]}),(0,n.jsx)("td",{className:"border",colSpan:2,children:(0,n.jsx)("input",{onChange:e=>{a({...t,checkExpression:e.currentTarget.value})},readOnly:s,value:t.checkExpression,className:"w-full p-2 font-mono outline-hidden"})})]})}function sQ(e){var t,a,r,l,i;let{constraint:o,onChange:d,disabled:c,schemaName:u}=e,{columns:m}=sW(),{schema:h}=eb(),x=(0,s.useMemo)(()=>[...new Set(m.map(e=>{var t,a,n,s;return null!==(s=null!==(n=null===(t=e.new)||void 0===t?void 0:t.name)&&void 0!==n?n:null===(a=e.old)||void 0===a?void 0:a.name)&&void 0!==s?s:""}))],[m]),p=(0,s.useMemo)(()=>{var e,t,a,n;let s=null===(e=o.foreignKey)||void 0===e?void 0:e.foreignTableName;if(s){let e=(null!==(t=h[u])&&void 0!==t?t:[]).find(e=>"table"===e.type&&e.name===s);if(e)return(null!==(n=null===(a=e.tableSchema)||void 0===a?void 0:a.columns)&&void 0!==n?n:[]).map(e=>e.name)}return[]},[o,u,h]),f=(0,s.useCallback)(e=>{d({...o,foreignKey:{...o.foreignKey,columns:e}})},[d,o]),g=(0,s.useCallback)(e=>{d({...o,foreignKey:{...o.foreignKey,foreignColumns:e}})},[d,o]),v=(0,s.useCallback)(e=>{d({...o,foreignKey:{...o.foreignKey,foreignTableName:e}})},[d,o]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("td",{className:"border p-2",children:[(0,n.jsx)(tU.A,{className:"mr-2 inline h-4 w-4"}),"Foreign Key"]}),(0,n.jsx)("td",{className:"border",children:(0,n.jsx)(sR,{borderless:!0,schemaName:u,disabled:c,onChange:v,value:null===(t=o.foreignKey)||void 0===t?void 0:t.foreignTableName})}),(0,n.jsx)("td",{className:"border",children:(0,n.jsxs)("div",{className:"flex items-center gap-2 p-1 px-2",children:[(0,n.jsx)(sX,{disabled:c,value:null!==(l=null===(a=o.foreignKey)||void 0===a?void 0:a.columns)&&void 0!==l?l:[],columns:x,onChange:f}),"|",(0,n.jsx)(sX,{disabled:c,value:null!==(i=null===(r=o.foreignKey)||void 0===r?void 0:r.foreignColumns)&&void 0!==i?i:[],columns:p,onChange:g})]})})]})}function sJ(e){var t;let{constraint:a,onChange:r,disabled:l}=e,{columns:i}=sW(),o=(0,s.useMemo)(()=>[...new Set(i.map(e=>{var t,a,n,s;return null!==(s=null!==(n=null===(t=e.new)||void 0===t?void 0:t.name)&&void 0!==n?n:null===(a=e.old)||void 0===a?void 0:a.name)&&void 0!==s?s:""}))],[i]),d=(0,s.useCallback)(e=>{r({...a,primaryColumns:e})},[r,a]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("td",{className:"border p-2",children:[(0,n.jsx)(af.A,{className:"mr-2 inline h-4 w-4"}),"Primary Key"]}),(0,n.jsx)("td",{className:"border",colSpan:2,children:(0,n.jsx)("div",{className:"flex gap-2 p-1 px-2",children:(0,n.jsx)(sX,{disabled:l,value:null!==(t=a.primaryColumns)&&void 0!==t?t:[],columns:o,onChange:d})})})]})}function sZ(e){var t;let{constraint:a,onChange:r,disabled:l}=e,{columns:i}=sW(),o=(0,s.useMemo)(()=>[...new Set(i.map(e=>{var t,a,n,s;return null!==(s=null!==(n=null===(t=e.new)||void 0===t?void 0:t.name)&&void 0!==n?n:null===(a=e.old)||void 0===a?void 0:a.name)&&void 0!==s?s:""}))],[i]),d=(0,s.useCallback)(e=>{r({...a,uniqueColumns:e})},[r,a]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("td",{className:"border p-2",children:[(0,n.jsx)(sP.A,{className:"mr-2 inline h-4 w-4"}),"Unique"]}),(0,n.jsx)("td",{className:"border",colSpan:2,children:(0,n.jsx)("div",{className:"flex gap-2 p-1 px-2",children:(0,n.jsx)(sX,{disabled:l,value:null!==(t=a.uniqueColumns)&&void 0!==t?t:[],columns:o,onChange:d})})})]})}function s$(e){let{children:t,idx:a,onChange:r}=e,l=(0,s.useCallback)(()=>{r(e=>{let t=[...e.constraints],n=t[a];return(null==n?void 0:n.old)?n&&(n.new=null):t=e.constraints.filter((e,t)=>t!==a),{...e,constraints:t}})},[r,a]);return(0,n.jsxs)("tr",{className:"text-sm",children:[t,(0,n.jsx)("td",{className:"border",children:(0,n.jsx)("button",{className:"p-1",onClick:l,children:(0,n.jsx)(ad.A,{className:"h-4 w-4 text-red-500"})})})]})}function s0(e){var t;let{onChange:a,schemaName:r,constraint:l,disabled:i}=e,o=(0,s.useCallback)(e=>{a(t=>({...t,constraints:t.constraints.map(t=>t===l?{...t,new:e}:t)}))},[a,l]),d=null!==(t=l.new)&&void 0!==t?t:l.old;return d?d.foreignKey&&r?(0,n.jsx)(sQ,{disabled:i,constraint:d,onChange:o,schemaName:r}):d.primaryKey?(0,n.jsx)(sJ,{disabled:i,constraint:d,onChange:o}):d.unique?(0,n.jsx)(sZ,{disabled:i,constraint:d,onChange:o}):void 0!==d.checkExpression?(0,n.jsx)(sY,{disabled:i,constraint:d,onChange:o}):(0,n.jsx)("td",{colSpan:4}):null}function s1(e){let{constraint:t,onChange:a,idx:s,schemaName:r,disabled:l}=e;return(0,n.jsx)(s$,{idx:s,onChange:a,children:(0,n.jsx)(s0,{constraint:t,onChange:a,idx:s,schemaName:r,disabled:l})})}function s2(e){let{constraints:t,onChange:a,schemaName:r,disabled:l}=e,i="text-xs p-2 text-left bg-secondary border",d=(0,s.useCallback)(e=>{a(t=>({...t,constraints:[...t.constraints,{id:window.crypto.randomUUID(),new:e,old:null}]}))},[a]);return(0,n.jsx)("div",{className:"px-4 py-2",children:(0,n.jsxs)("table",{className:"w-full",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:o(i,"w-[175px]"),children:"Constraints"}),(0,n.jsx)("th",{className:o(i,"w-[200px]")}),(0,n.jsx)("th",{className:i}),(0,n.jsx)("th",{className:o(i,"w-[30px]")})]})}),(0,n.jsxs)("tbody",{children:[t.map((e,t)=>(0,n.jsx)(s1,{idx:t,constraint:e,onChange:a,disabled:l,schemaName:r},t)),!l&&(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:4,className:"border px-4 py-2",children:(0,n.jsxs)(Q,{children:[(0,n.jsx)(J,{asChild:!0,children:(0,n.jsxs)(W,{size:"sm",children:[(0,n.jsx)(sH.A,{className:"mr-1 h-4 w-4"}),"Add Constraint"]})}),(0,n.jsxs)(Z,{children:[(0,n.jsx)($,{inset:!0,onClick:()=>{d({primaryKey:!0})},children:"Primary Key"}),(0,n.jsx)($,{inset:!0,onClick:()=>{d({unique:!0})},children:"Unique"}),(0,n.jsx)($,{inset:!0,onClick:()=>{d({checkExpression:""})},children:"Check Constraint"}),(0,n.jsx)($,{inset:!0,onClick:()=>{d({foreignKey:{columns:[]}})},children:"Foreign Key"})]})]})})})]})]})})}function s4(e){var t,a,r;let{value:l,onChange:i,onSave:o,onDiscard:d}=e,{databaseDriver:c}=x(),u=""===l.name.old,m=(0,s.useCallback)(()=>{var e,t;let a=0===l.columns.length?{name:"id",type:null!==(e=c.columnTypeSelector.idTypeName)&&void 0!==e?e:"INTEGER",constraint:{primaryKey:!0}}:{name:"column",type:null!==(t=c.columnTypeSelector.textTypeName)&&void 0!==t?t:"TEXT",constraint:{}};i({...l,columns:[...l.columns,{key:window.crypto.randomUUID(),old:null,new:a}]})},[l,i,c]),h=function(e){if(e.name.new!==e.name.old)return!0;for(let t of e.columns)if(sU(t))return!0;return!1}(l),p=(0,s.useMemo)(()=>c.createUpdateTableSchema(l).join(";\n"),[l,c]),f=(0,s.useMemo)(()=>({collations:c.getCollationList()}),[c]);return(0,n.jsxs)("div",{className:"w-full h-full flex flex-col",children:[(0,n.jsxs)("div",{className:"grow-0 shrink-0",children:[(0,n.jsxs)("div",{className:"p-1 flex gap-2",children:[(0,n.jsxs)(W,{variant:"ghost",onClick:o,disabled:!h||!(null===(t=l.name)||void 0===t?void 0:t.new)||!l.schemaName,size:"sm",children:[(0,n.jsx)(nd.A,{className:"w-4 h-4 mr-2"}),"Save"]}),(0,n.jsx)(W,{size:"sm",variant:"ghost",onClick:d,disabled:!h,className:"text-red-500",children:"Discard Change"}),(0,n.jsx)("div",{children:(0,n.jsx)(tV,{orientation:"vertical"})}),(0,n.jsxs)(W,{variant:"ghost",onClick:m,size:"sm",children:[(0,n.jsx)(ao.A,{className:"w-4 h-4 mr-1"}),"Add Column"]}),(0,n.jsx)("div",{children:(0,n.jsx)(tV,{orientation:"vertical"})}),(0,n.jsxs)(te,{children:[(0,n.jsx)(tt,{children:(0,n.jsxs)("div",{className:V({size:"sm",variant:"ghost"}),children:[(0,n.jsx)(sg.A,{className:"w-4 h-4 mr-1"}),"SQL Preview"]})}),(0,n.jsxs)(ta,{style:{width:500},children:[(0,n.jsx)("div",{className:"text-xs font-semibold mb-1",children:"SQL Preview"}),(0,n.jsx)("div",{style:{maxHeight:400},className:"overflow-y-auto",children:(0,n.jsx)(e3,{code:p})})]})]}),l.createScript&&(0,n.jsxs)(te,{children:[(0,n.jsx)(tt,{children:(0,n.jsxs)("div",{className:V({size:"sm",variant:"ghost"}),children:[(0,n.jsx)(sg.A,{className:"w-4 h-4 mr-1"}),"Create Script"]})}),(0,n.jsxs)(ta,{style:{width:500},children:[(0,n.jsxs)(W,{variant:"outline",size:"sm",onClick:()=>{var e;E.oR.success("Copied create script successfully"),window.navigator.clipboard.writeText(null!==(e=l.createScript)&&void 0!==e?e:"")},children:[(0,n.jsx)(sv.A,{className:"w-4 h-4 mr-2"}),"Copy"]}),(0,n.jsx)("div",{style:{maxHeight:400},className:"overflow-y-auto mt-2",children:(0,n.jsx)(e3,{code:l.createScript})})]})]})]}),(0,n.jsxs)("div",{className:"flex items-center mx-3 mt-3 mb-4 ml-5 gap-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-xs font-medium mb-1",children:"Table Name"}),(0,n.jsx)(ni,{placeholder:"Table Name",value:null!==(r=null!==(a=l.name.new)&&void 0!==a?a:l.name.old)&&void 0!==r?r:"",onChange:e=>{i({...l,name:{...l.name,new:e.currentTarget.value}})},className:"w-[200px]"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-xs font-medium mb-1",children:"Schema"}),(0,n.jsx)(nD,{readonly:!u,value:l.schemaName,onChange:e=>{i({...l,schemaName:e})}})]})]}),(0,n.jsx)(tV,{})]}),(0,n.jsxs)("div",{className:"grow overflow-y-auto",children:[(0,n.jsx)(sB,{columns:l.columns,onChange:i,onAddColumn:m,schemaName:l.schemaName,options:f,disabledEditExistingColumn:!c.getFlags().supportModifyColumn}),(0,n.jsx)(sG,{value:l.columns,children:(0,n.jsx)(s2,{schemaName:l.schemaName,constraints:l.constraints,onChange:i,disabled:!u})})]})]})}let s5={name:{old:"",new:""},columns:[],constraints:[],createScript:""};function s3(e){let{schemaName:t,tableName:a}=e,{databaseDriver:r}=x(),[l,i]=(0,s.useState)({...s5,schemaName:t}),[o,d]=(0,s.useState)(!!a),[c,u]=(0,s.useState)(!1),m=(0,s.useCallback)(async(e,t)=>{r.tableSchema(e,t).then(t=>{var a;i({schemaName:e,name:{old:t.tableName,new:t.tableName},columns:t.columns.map(e=>({key:window.crypto.randomUUID(),old:e,new:sq()(e)})),constraints:(null!==(a=t.constraints)&&void 0!==a?a:[]).map(e=>({id:window.crypto.randomUUID(),old:e,new:sq()(e)})),createScript:t.createScript})}).catch(console.error).finally(()=>d(!1))},[r,i]);(0,s.useEffect)(()=>{a&&t&&m(t,a).then().catch(console.error)},[m,t,a]);let h=(0,s.useMemo)(()=>r.createUpdateTableSchema(l),[l,r]),p=(0,s.useCallback)(()=>u(e=>!e),[u]),f=(0,s.useCallback)(()=>{i(e=>({name:{...e.name,new:e.name.old},columns:e.columns.map(e=>({key:e.key,old:e.old,new:sq()(e.old)})).filter(e=>e.old),constraints:e.constraints.map(e=>({id:window.crypto.randomUUID(),old:e.old,new:sq()(e.old)}))}))},[i]);return o?(0,n.jsx)("div",{children:(0,n.jsx)(ss,{})}):(0,n.jsxs)(n.Fragment,{children:[c&&(0,n.jsx)(sf,{fetchTable:m,onClose:p,schema:l,previewScript:h}),(0,n.jsx)(s4,{value:l,onChange:i,onSave:p,onDiscard:f})]})}let s8=nJ({name:"schema",key:e=>(null==e?void 0:e.tableName)?"".concat(e.schemaName,"-").concat(e.tableName):"create",generate:e=>({title:(null==e?void 0:e.tableName)?e.tableName:"New Table",component:(0,n.jsx)(s3,{tableName:null==e?void 0:e.tableName,schemaName:null==e?void 0:e.schemaName}),icon:sp.A})});var s6=a(76872),s9=a(98944),s7=a(87081),re=a(41598),rt=a(10503);async function ra(e){let{driver:t,tableName:a,tableSchema:n,data:s}=e,r=function(e){let{tableSchema:t,data:a}=e,n=a.getChangedRows(),s=[];for(let e of n){let a=e.change;if(a){let n=t.pk.reduce((t,a)=>(t[a]=e.raw[a],t),{});e.isNewRow?s.push({row:e,plan:{operation:"INSERT",values:a,autoIncrementPkColumn:t.autoIncrement?t.pk[0]:void 0,pk:t.pk}}):e.isRemoved?s.push({row:e,plan:{operation:"DELETE",where:n}}):s.push({row:e,plan:{operation:"UPDATE",where:n,values:a}})}}return s}({tableSchema:n,data:s});try{let e=await t.updateTableData(n.schemaName,a,r.map(e=>e.plan),n);s.applyChanges(r.map((t,a)=>{var n,s;return{row:t.row,updated:null!==(s=null===(n=e[a])||void 0===n?void 0:n.record)&&void 0!==s?s:{}}}))}catch(e){return{errorMessage:e.message}}return{}}var rn=a(84873),rs=a(22187);function rr(e){let{schemaName:t,tableName:a}=e,{updateTableSchema:r}=ef(),{schema:l}=eb(),{databaseDriver:i}=x(),[d,h]=(0,s.useState)(),[p,f]=(0,s.useState)(null),[g,v]=(0,s.useState)(!1),[y,b]=(0,s.useState)(),[j,N]=(0,s.useState)(),[w,k]=(0,s.useState)(),[S,E]=(0,s.useState)([]),[R,T]=(0,s.useState)(0),[A,_]=(0,s.useState)(""),[L,I]=(0,s.useState)(""),[F,M]=(0,s.useState)("0"),[D,O]=(0,s.useState)("50"),[q,U]=(0,s.useState)(0),[K,z]=(0,s.useState)(50),[B,P]=(0,s.useState)(!1),[H,X]=(0,s.useState)(1),[V,G]=(0,s.useState)(0),[Y]=(0,s.useState)(()=>l);(0,s.useEffect)(()=>{(async()=>{v(!0);try{let{data:e,schema:n}=await i.selectTable(t,a,{whereRaw:A,limit:K,offset:q,orderBy:S}),s=aj.createFromResult({driver:i,result:e,tableSchema:n,schemas:Y});s.setSql("SELECT * FROM "+a+";"),b(s),k(e.stat),N(n),r(a,n.columns),G(Date.now()),T(0),h(void 0)}catch(e){h(e.toString())}finally{v(!1)}})().then().catch(console.error)},[i,a,t,S,r,k,A,q,K,H,Y]),(0,s.useEffect)(()=>{if(y){let e=e=>{T(e.getChangedRows().length)};return y.addChangeListener(e),()=>y.removeChangeListener(e)}},[y]);let{columnIndexList:Q,filterColumnButton:J}=function(e){var t;let{state:a}=e,r=null!==(t=null==a?void 0:a.getHeaders())&&void 0!==t?t:[],[l,i]=(0,s.useState)([]),d=r.length-l.length;(0,s.useEffect)(()=>{if(a)return i(a.getHeaders().map((e,t)=>t))},[a]);let c=(0,n.jsxs)(te,{children:[(0,n.jsx)(tt,{asChild:!0,children:(0,n.jsxs)(W,{variant:"ghost",size:"sm",children:[(0,n.jsx)(rn.A,{className:"mr-2 h-4 w-4"}),"Columns",!!d&&(0,n.jsx)("span",{className:"ml-2 h-4 w-4 rounded-full bg-primary text-[10px] text-primary text-primary-foreground",children:d})]})}),(0,n.jsx)(ta,{className:"p-0",children:(0,n.jsxs)(nR,{children:[(0,n.jsx)(nT,{placeholder:"Search column here"}),!!d&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("button",{onClick:()=>{i(r.map((e,t)=>t))},className:"relative mx-1 my-1 flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm font-semibold outline-hidden hover:bg-secondary aria-selected:bg-accent aria-selected:text-accent-foreground data-disabled:pointer-events-none data-disabled:opacity-50",children:[(0,n.jsx)(rs.A,{className:"mr-2 h-4 w-4"}),"Select all columns"]}),(0,n.jsx)(nI,{})]}),(0,n.jsx)(nL,{className:"max-h-[400px] overflow-y-auto",children:r.map((e,t)=>{let a=l.includes(t);return(0,n.jsxs)(nF,{value:e.display.text,onSelect:()=>{if(a)i(l.filter(e=>e!==t));else{let e=new Set(l);e.add(t);let a=Array.from(e);a.sort((e,t)=>e-t),i(a)}},children:[(0,n.jsx)(aw.A,{className:o("mr-2 h-4 w-4",a?"opacity-100":"opacity-0")}),e.display.text]},e.name)})})]})})]});return{columnIndexList:l,filterColumnButton:c}}({state:y}),Z=(0,s.useCallback)(()=>{j&&y&&(P(!0),ra({driver:i,tableName:a,tableSchema:j,data:y}).then(e=>{let{errorMessage:t}=e;t&&f(t)}).catch(console.error).finally(()=>P(!1)))},[i,a,j,y,f]),$=(0,s.useCallback)(()=>{y&&y.disardAllChange()},[y]),ee=(0,s.useCallback)(()=>{y&&y.insertNewRow()},[y]),et=(0,s.useCallback)(()=>{y&&y.getSelectedRowIndex().forEach(e=>{y.removeRow(e)})},[y]),{isActiveTab:ea}=(0,s.useContext)(aF);return(0,s.useEffect)(()=>{if(ea){let e=e=>{C.commit.match(e)?(Z(),e.preventDefault(),e.stopPropagation()):C.discard.match(e)&&($(),e.preventDefault(),e.stopPropagation())};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)}},[ea,Z,$]),(0,n.jsxs)("div",{className:"flex h-full w-full flex-col overflow-hidden",children:[p&&(0,n.jsx)(sl,{open:!0,children:(0,n.jsxs)(sd,{title:"Error",children:[(0,n.jsx)(sr.r7,{children:"Error"}),(0,n.jsxs)(sm,{children:[p," "]}),(0,n.jsx)(sc,{children:(0,n.jsx)(sh,{onClick:()=>f(null),children:"Continue"})})]})}),(0,n.jsx)("div",{className:"shrink-0 grow-0 border-b border-neutral-200 py-2 dark:border-neutral-800",children:(0,n.jsxs)(nO,{children:[(0,n.jsx)(nU,{text:"Commit",icon:(0,n.jsx)(s6.A,{className:"h-4 w-4"}),tooltip:"Commit your changes (".concat(C.commit.toString(),")"),disabled:!R||B,loading:B,onClick:Z,badge:R?R.toString():""}),(0,n.jsx)(nU,{text:"Discard Change",tooltip:"Dicard all changes (".concat(C.discard.toString(),")"),destructive:!0,disabled:!R,onClick:$}),(0,n.jsx)("div",{className:"mx-1",children:(0,n.jsx)(tV,{orientation:"vertical"})}),J,(0,n.jsx)("div",{className:"mx-1",children:(0,n.jsx)(tV,{orientation:"vertical"})}),(0,n.jsx)(W,{variant:"ghost",size:"sm",onClick:ee,children:(0,n.jsx)(ao.A,{className:"h-4 w-4 text-green-600"})}),(0,n.jsx)(W,{variant:"ghost",size:"sm",onClick:et,children:(0,n.jsx)(s9.A,{className:"h-4 w-4 text-red-600"})}),(0,n.jsx)(W,{variant:"ghost",size:"sm",onClick:()=>X(e=>e+1),disabled:g,children:(0,n.jsx)(nS.A,{className:"h-4 w-4 text-green-600"})}),(0,n.jsx)("div",{className:"mx-2 flex grow",children:(0,n.jsxs)("div",{className:"flex w-full items-center overflow-hidden rounded bg-secondary",children:[(0,n.jsx)("div",{className:"flex h-full items-center bg-neutral-200 px-2 text-sm text-gray-500 dark:bg-neutral-800",children:(0,n.jsx)(s7.A,{className:"h-4 w-4 text-black dark:text-white"})}),(0,n.jsx)("input",{type:"text",placeholder:"eg: id=5",value:L,onChange:e=>I(e.currentTarget.value),onKeyDown:e=>{"Enter"===e.key&&_(e.currentTarget.value)},className:"h-full grow bg-inherit p-1 pl-2 pr-2 font-mono text-sm outline-hidden"})]})}),(0,n.jsx)("div",{children:(0,n.jsx)(tV,{orientation:"vertical"})}),(0,n.jsx)(W,{variant:"ghost",size:"sm",disabled:0===q||g,onClick:()=>{U(q-K),M((q-K).toString())},children:(0,n.jsx)(re.A,{className:"h-4 w-4"})}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsxs)(c,{children:[(0,n.jsx)(u,{children:(0,n.jsx)("input",{value:D,onChange:e=>O(e.currentTarget.value),onBlur:e=>{try{let t=parseInt(e.currentTarget.value);t!==K&&z(t)}catch(e){O(K.toString())}},style:{width:50},className:"h-full rounded bg-neutral-200 p-1 pl-2 pr-2 text-xs dark:bg-neutral-800",alt:"Limit"})}),(0,n.jsx)(m,{children:"Limit"})]}),(0,n.jsxs)(c,{children:[(0,n.jsx)(u,{children:(0,n.jsx)("input",{value:F,onChange:e=>M(e.currentTarget.value),onBlur:e=>{try{let t=parseInt(e.currentTarget.value);t!==q&&U(t)}catch(e){M(q.toString())}},style:{width:50},className:"h-full rounded bg-neutral-200 p-1 pl-2 pr-2 text-xs dark:bg-neutral-800",alt:"Offset"})}),(0,n.jsx)(m,{children:"Offset"})]})]}),(0,n.jsx)(W,{variant:"ghost",size:"sm",disabled:g,children:(0,n.jsx)(rt.A,{className:"h-4 w-4",onClick:()=>{U(q+K),M((q+K).toString())}})})]})}),(0,n.jsxs)("div",{className:"relative grow overflow-hidden",children:[g&&(0,n.jsx)(ss,{}),d&&(0,n.jsx)("div",{className:"p-5 text-red-500",children:(0,n.jsx)("pre",{children:d})}),y&&!d?(0,n.jsx)(ax,{data:y,tableName:a,sortColumns:S,onSortColumnChange:E,visibleColumnIndexList:Q},V):null]}),w&&y&&(0,n.jsxs)("div",{className:"flex shrink-0 justify-between border-t",children:[(0,n.jsxs)("div",{className:"flex p-1",children:[(0,n.jsx)(e8,{stats:w}),(0,n.jsx)("div",{children:(0,n.jsx)(tk,{data:y})})]}),(0,n.jsx)("div",{className:"p-1 pr-3",children:(0,n.jsx)(aC,{data:y})})]})]})}let rl=nJ({name:"table",key:e=>e.schemaName+"-"+(null==e?void 0:e.tableName),generate:e=>({title:e.tableName,component:(0,n.jsx)(rr,{tableName:e.tableName,schemaName:e.schemaName}),icon:a9.X})}),ri={tabs:{openBuiltinQuery:sa.open,openBuiltinTable:rl.open,openBuiltinSchema:s8.open,openBuiltinERD:nZ.open,openBuiltinMassDropTable:n7.open,close:e=>{nQ.send(e)}}};class ro{}class rd extends ro{cleanup(){}}var rc=a(81383),ru=a(41436),rm=a.n(ru);function rh(e){let{onSave:t,onDiscard:a,isExecuting:s,disabled:r,previewScript:l}=e;return(0,n.jsxs)("div",{className:"p-1 flex gap-2",children:[(0,n.jsxs)(W,{variant:"ghost",onClick:t,disabled:r,size:"sm",children:[s?(0,n.jsx)(tq.A,{className:"w-4 h-4 mr-2 animate-spin"}):(0,n.jsx)(nd.A,{className:"w-4 h-4 mr-2"}),"Save"]}),(0,n.jsx)(W,{size:"sm",variant:"ghost",onClick:a,disabled:r,className:"text-red-500",children:"Discard Change"}),(0,n.jsx)("div",{children:(0,n.jsx)(tV,{orientation:"vertical"})}),(0,n.jsxs)(te,{children:[(0,n.jsx)(tt,{children:(0,n.jsxs)("div",{className:V({size:"sm",variant:"ghost"}),children:[(0,n.jsx)(sg.A,{className:"w-4 h-4 mr-1"}),"SQL Preview"]})}),(0,n.jsxs)(ta,{style:{width:500},children:[(0,n.jsx)("div",{className:"text-xs font-semibold mb-1",children:"SQL Preview"}),(0,n.jsx)("div",{style:{maxHeight:400},className:"overflow-y-auto",children:(0,n.jsx)(e3,{code:l})})]})]})]})}function rx(e){let{refresh:t}=eb(),{databaseDriver:a}=x(),[r,l]=(0,s.useState)(!1),[i,o]=(0,s.useState)(""),d=(0,s.useCallback)(()=>{l(!0),a.transaction(e.previewScript).then(()=>{var a;t(),rv.replace({schemaName:e.trigger.schemaName,name:null!==(a=e.trigger.name)&&void 0!==a?a:"",tableName:e.trigger.tableName}),e.onClose()}).catch(e=>o(e.message)).finally(()=>{l(!1)})},[a,e,t]);return(0,n.jsx)(sl,{open:!0,onOpenChange:e.onClose,children:(0,n.jsxs)(sd,{children:[(0,n.jsx)(su,{children:"Preview"}),i&&(0,n.jsxs)("div",{className:"text-sm text-red-500 font-mono flex gap-4 justify-end items-end",children:[(0,n.jsx)(no.A,{className:"w-12 h-12"}),(0,n.jsx)("p",{children:i})]}),(0,n.jsx)("p",{children:"Are you sure you want to run this change?"}),(0,n.jsx)(e3,{code:e.previewScript.join(";\n")}),(0,n.jsxs)(sc,{children:[(0,n.jsx)(sx,{children:"Cancel"}),(0,n.jsxs)(W,{onClick:d,children:[r?(0,n.jsx)(tq.A,{className:"w-4 h-4 mr-2 animate-spin"}):(0,n.jsx)(nd.A,{className:"w-4 h-4 mr-2"}),"Continue"]})]})]})})}function rp(e){var t,a;let{value:r,onChange:l}=e,{databaseDriver:i}=x(),{autoCompleteSchema:o,schema:d}=eb(),c=(0,s.useMemo)(()=>{var e;let t=d[r.schemaName];if(!t)return o;let a=null===(e=t.find(e=>e.name.toLowerCase()===r.tableName.toLowerCase()))||void 0===e?void 0:e.tableSchema;if(!a)return o;let n=a.columns.map(e=>e.name);return{...o,NEW:n,OLD:n}},[o,r.schemaName,r.tableName,d]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"px-4 py-2 flex flex-row gap-2",children:(0,n.jsx)(ni,{value:r.name,placeholder:"Trigger Name",onChange:e=>l((0,rc.jM)(r,t=>{t.name=e.currentTarget.value}))})}),(0,n.jsx)("div",{className:"px-4 py-2 flex flex-col gap-2",children:(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("div",{className:"w-[200px]",children:(0,n.jsxs)(to,{value:null!==(t=null==r?void 0:r.when)&&void 0!==t?t:"BEFORE",onValueChange:e=>l((0,rc.jM)(r,t=>{t.when=e})),children:[(0,n.jsx)(tc,{children:(0,n.jsx)(td,{placeholder:"When"})}),(0,n.jsxs)(th,{children:[(0,n.jsx)(tx,{value:"BEFORE",children:"Before"}),(0,n.jsx)(tx,{value:"AFTER",children:"After"}),(0,n.jsx)(tx,{value:"INSTEAD_OF",children:"Instead Of"})]})]})}),(0,n.jsx)("div",{className:"w-[200px]",children:(0,n.jsxs)(to,{value:null==r?void 0:r.operation,onValueChange:e=>{l((0,rc.jM)(r,t=>{t.operation=e}))},children:[(0,n.jsx)(tc,{children:(0,n.jsx)(td,{placeholder:"Operation"})}),(0,n.jsxs)(th,{children:[(0,n.jsx)(tx,{value:"INSERT",children:"Insert"}),(0,n.jsx)(tx,{value:"UPDATE",children:"Update"}),(0,n.jsx)(tx,{value:"DELETE",children:"Delete"})]})]})}),(0,n.jsx)("div",{className:"w-[200px]",children:(0,n.jsx)(nD,{value:r.schemaName,onChange:e=>{l((0,rc.jM)(r,t=>{t.schemaName=e}))}})}),(0,n.jsx)("div",{className:"w-[200px]",children:(0,n.jsx)(sR,{schemaName:r.schemaName,value:r.tableName,onChange:e=>{l((0,rc.jM)(r,t=>{t.tableName=e}))}})})]})}),(0,n.jsx)("div",{className:"grow overflow-hidden",children:(0,n.jsxs)("div",{className:"h-full",children:[(0,n.jsx)("div",{className:"text-xs my-2 mx-4",children:'Trigger statement: (eg: "SET NEW.columnA = TRIM(OLD.columnA)")'}),(0,n.jsx)(P,{value:null!==(a=null==r?void 0:r.statement)&&void 0!==a?a:"",dialect:i.getFlags().dialect,schema:c,onChange:e=>l((0,rc.jM)(r,t=>{t.statement=e}))})]})})]})}let rf={name:"",operation:"INSERT",when:"BEFORE",tableName:"",whenExpression:"",statement:"",schemaName:""};function rg(e){let{name:t,schemaName:a,tableName:r}=e,{databaseDriver:l}=x(),[i,o]=(0,s.useState)(!1),[d,c]=(0,s.useState)(!!t),[u,m]=(0,s.useState)(()=>(0,rc.jM)(rf,e=>{e.tableName=null!=r?r:"",e.schemaName=null!=a?a:""})),[h,p]=(0,s.useState)(u),f=!rm()(u,h),g=(0,s.useMemo)(()=>{let e=l.dropTrigger(h.schemaName,t),a=l.createTrigger(h);return t?[e,a]:[a]},[h,l,t]);(0,s.useEffect)(()=>{t&&a&&l.trigger(a,t).then(e=>{p(e),m(e)}).finally(()=>c(!1))},[t,a,l]);let v=(0,s.useCallback)(()=>{o(!i)},[i]);return d?(0,n.jsx)(ss,{}):(0,n.jsxs)("div",{className:"flex flex-col overflow-hidden w-full h-full",children:[i&&(0,n.jsx)(rx,{onClose:v,previewScript:g,trigger:h}),(0,n.jsx)(rh,{onSave:v,onDiscard:()=>{p(u)},disabled:!f,previewScript:g.join(";\n")}),(0,n.jsx)(rp,{value:h,onChange:p})]})}let rv=nJ({name:"trigger",key:e=>"".concat(e.schemaName,".").concat(e.name),generate:e=>{var t,a,s;return{title:e.name||"New Trigger",component:(0,n.jsx)(rg,{schemaName:null!==(t=e.schemaName)&&void 0!==t?t:"",name:null!==(a=e.name)&&void 0!==a?a:"",tableName:null!==(s=e.tableName)&&void 0!==s?s:""}),icon:az.A}}});class ry extends rd{init(e){e.registerCreateResourceMenu({key:"trigger",title:"Create Trigger",onClick:()=>{rv.open({})}}),e.registerResourceContextMenu(e=>{if("trigger"===e.type)return{key:"trigger",title:"Edit Trigger",onClick:()=>{rv.open({schemaName:e.schemaName,name:e.name,tableName:e.tableName})}}},"modification")}constructor(...e){super(...e),this.extensionName="trigger-editor"}}function rb(e){return e.sort((e,t)=>e.name.localeCompare(t.name))}function rj(e){let{search:t}=e,{databaseDriver:a}=x(),{extensions:r}=eu(),[l,i]=(0,s.useState)(""),{refresh:o,schema:d,currentSchemaName:c}=eb(),[u,m]=(0,s.useState)(null),[h,p]=(0,s.useState)(()=>new Set);(0,s.useEffect)(()=>{i("")},[i,t]);let f=(0,s.useCallback)(e=>{let t=null==e?void 0:e.name,n=(null==e?void 0:e.type)==="table",s={title:"Create",sub:[a.getFlags().supportCreateUpdateTable&&{title:"Create Table",onClick:()=>{var t;ri.tabs.openBuiltinSchema({schemaName:null!==(t=null==e?void 0:e.schemaName)&&void 0!==t?t:c})}},...r.getResourceCreateMenu()].filter(Boolean)},l=e?[n&&a.getFlags().supportCreateUpdateTable?{title:"Edit Table",onClick:()=>{var t;ri.tabs.openBuiltinSchema({schemaName:null!==(t=null==e?void 0:e.schemaName)&&void 0!==t?t:c,tableName:null==e?void 0:e.name})}}:void 0,...r.getResourceContextMenu(e,"modification")].filter(Boolean):[];return[s,{title:"Copy Name",disabled:!t,onClick:()=>{window.navigator.clipboard.writeText(null!=t?t:"")}},{separator:!0},...l,l.length>0?{separator:!0}:void 0,{title:"Refresh",onClick:()=>o()}].filter(Boolean)},[o,a,c,r]),g=(0,s.useMemo)(()=>{let e=rb(Object.entries(d).map(e=>{let[t,a]=e,n=Math.max(...a.map(e=>{var t,a,n;return null!==(n=null===(a=e.tableSchema)||void 0===a?void 0:null===(t=a.stats)||void 0===t?void 0:t.sizeInByte)&&void 0!==n?n:0}));return{data:{type:"schema",schemaName:t},icon:aP.A,name:t,iconBadgeColor:t===c?"bg-green-600":void 0,key:t.toString(),children:rb(function(e){let t=e.reduce((e,t)=>(e[t.name]=t,e),{}),a=["_config","_content","_data","_docsize","_idx"],n=new Set;for(let r of e){var s;(null===(s=r.data.tableSchema)||void 0===s?void 0:s.fts5)&&(r.children=a.map(e=>t[r.data.name+e]).filter(Boolean),a.forEach(e=>n.add(r.data.name+e)),r.badgeContent="fts5")}return e.filter(e=>!n.has(e.data.name))}(function(e){let t=e.filter(e=>"trigger"===e.data.type).reduce((e,t)=>{var a,n,s;return e[null!==(a=t.data.tableName)&&void 0!==a?a:""]=[...null!==(s=e[null!==(n=t.data.tableName)&&void 0!==n?n:""])&&void 0!==s?s:[],t],e},{}),a=e.filter(e=>"trigger"!==e.data.type);for(let e of a)if("table"===e.data.type&&t[e.data.name]){var n,s;e.children=[...null!==(n=e.children)&&void 0!==n?n:[],...null!==(s=t[e.name])&&void 0!==s?s:[]]}return a}(a.map(e=>{var t,a,s,r;let l=a9.X,i="";return"trigger"===e.type?(l=az.A,i="text-purple-500"):"view"===e.type&&(l=aB.A,i="text-green-600 dark:text-green-300"),{data:e,icon:l,iconColor:i,key:e.schemaName+"."+e.name,name:e.name,progressBarMax:n,progressBarValue:null===(a=e.tableSchema)||void 0===a?void 0:null===(t=a.stats)||void 0===t?void 0:t.sizeInByte,progressBarLabel:function(e){if(e)return 0x3e700000<e?(e/0x40000000).toFixed(1)+" GB":0x6400000<e?(e/1048576).toFixed(0)+" MB":102400<e?(e/1048576).toFixed(1)+" MB":1024<e?Math.floor(e/1024)+" KB":"1 KB"}(null===(r=e.tableSchema)||void 0===r?void 0:null===(s=r.stats)||void 0===s?void 0:s.sizeInByte)}}))))}}));if(a.getFlags().optionalSchema){var t;return 1===e.length?null!==(t=e[0].children)&&void 0!==t?t:[]:e}return e},[d,c,a]),v=(0,s.useCallback)(e=>!t||e.name.toLowerCase().indexOf(t.toLowerCase())>=0,[t]);return(0,n.jsxs)(n.Fragment,{children:[u&&(0,n.jsx)(nu,{schemaName:u,onClose:()=>m(null)}),(0,n.jsx)(a6,{full:!0,filter:v,highlight:t,items:g,collapsedKeys:h,onCollapsedChange:p,onContextMenu:e=>f(null==e?void 0:e.data),selectedKey:l,onSelectChange:i,onDoubleClick:e=>{var t,n,s,r;"table"===e.data.type||"view"===e.data.type?ri.tabs.openBuiltinTable({schemaName:null!==(t=e.data.schemaName)&&void 0!==t?t:"",tableName:e.data.name}):"trigger"===e.data.type?rv.open({schemaName:null!==(n=e.data.schemaName)&&void 0!==n?n:"",name:null!==(s=e.name)&&void 0!==s?s:"",tableName:null!==(r=e.data.tableName)&&void 0!==r?r:""}):"schema"===e.data.type&&a.getFlags().supportUseStatement&&a.query("USE "+a.escapeId(e.name)).then(()=>{o()})}})]})}var rN=a(29919);function rw(){let[e,t]=(0,s.useState)(""),{databaseDriver:a}=x(),{currentSchemaName:r}=eb(),[l,i]=(0,s.useState)(!1),{extensions:d}=eu(),c=(0,s.useMemo)(()=>{let e=[],t=a.getFlags();return t.supportCreateUpdateTable&&e.push({title:"Create Table",key:"create-table",onClick:()=>{ri.tabs.openBuiltinSchema({schemaName:r})}}),t.supportCreateUpdateDatabase&&e.push({title:"Create Database/Schema",key:"create-schema",onClick:()=>{i(!0)}}),[...e,...d.getResourceCreateMenu()]},[a,r,d]),u=(0,s.useMemo)(()=>0===c.length?null:1===c.length?(0,n.jsx)("button",{className:o(V({size:"icon"}),"rounded-full h-8 w-8 bg-neutral-800 dark:bg-neutral-200"),onClick:c[0].onClick,children:(0,n.jsx)(rN.F,{size:16,weight:"bold"})}):(0,n.jsxs)(Q,{children:[(0,n.jsx)(J,{asChild:!0,children:(0,n.jsx)("button",{className:o(V({size:"icon"}),"rounded-full h-8 w-8 bg-neutral-800 dark:bg-neutral-200"),children:(0,n.jsx)(rN.F,{size:16,weight:"bold"})})}),(0,n.jsx)(Z,{side:"bottom",align:"start",children:c.map(e=>(0,n.jsx)($,{onClick:e.onClick,children:e.title},e.title))})]}),[c]);return(0,n.jsxs)("div",{className:"flex flex-col overflow-hidden grow",children:[l&&(0,n.jsx)(nu,{onClose:()=>{i(!1)}}),(0,n.jsxs)("div",{className:"p-4 pb-2 flex flex-col",children:[(0,n.jsxs)("div",{className:"flex justify-between mb-5 items-center",children:[(0,n.jsx)("h1",{className:"text-xl font-medium text-primary",children:"Tables"}),u]}),(0,n.jsxs)("div",{className:"overflow-hidden cursor-text items-center has-disabled:cursor-not-allowed has-disabled:opacity-50 has-focus:outline-neutral-400/70 has-enabled:active:outline-neutral-400/70 dark:has-focus:outline-neutral-600 dark:has-enabled:active:outline-neutral-600 flex w-full rounded-md bg-white px-3 py-2.5 text-base text-neutral-900 outline outline-1 outline-neutral-200 focus:outline-neutral-400/70 disabled:cursor-not-allowed disabled:opacity-50 dark:bg-neutral-900 dark:text-white dark:outline-neutral-800 dark:focus:outline-neutral-600 h-[32px]",children:[(0,n.jsx)("div",{className:"text-sm h-full flex items-center",children:(0,n.jsx)(aK.A,{className:"text-neutral-500 ",style:{width:14,height:14}})}),(0,n.jsx)("input",{type:"text",className:"bg-transparent flex-1 p-2 pl-2 pr-2 outline-hidden text-sm font-light h-full grow placeholder:text-neutral-500",value:e,placeholder:"Search tables",onChange:e=>{t(e.currentTarget.value)}})]})]}),(0,n.jsx)(rj,{search:e})]})}function rC(e){let{tabs:t}=e,[a,r]=(0,s.useState)(0),[l,i]=(0,s.useState)(()=>{let e=Array(t.length).fill(!1);return e[0]=!0,e}),d=eu(),h=(0,s.useMemo)(()=>"red"===d.color?"border-l-8 border-red-400 dark:border-red-800":"blue"===d.color?"border-l-8 border-blue-400 dark:border-blue-800":"green"===d.color?"border-l-8 border-green-400 dark:border-green-800":"yellow"===d.color?"border-l-8 border-yellow-400 dark:border-yellow-800":"purple"===d.color?"border-l-8 border-purple-400 dark:border-purple-800":"gray"===d.color?"border-l-8 border-gray-400 dark:border-gray-800":"",[d.color]);return(0,n.jsxs)("div",{className:o("flex h-full bg-neutral-50 dark:bg-neutral-950",h),children:[(0,n.jsx)("div",{className:o("shrink-0"),children:(0,n.jsx)("div",{className:"flex h-full flex-col gap-4 border-r border-neutral-200 p-3 dark:border-neutral-800",children:t.map((e,t)=>{let{key:s,name:d,icon:h,onClick:x}=e;return(0,n.jsxs)(c,{children:[(0,n.jsx)(u,{asChild:!0,children:(0,n.jsx)("button",{onClick:()=>{if(x){x();return}l[t]||(l[t]=!0,i([...l])),t!==a&&r(t)},className:o("cursor flex h-10 w-10 cursor-pointer flex-col items-center justify-center gap-0.5 text-neutral-400 hover:text-neutral-900 dark:text-neutral-600 dark:hover:text-neutral-100",a===t?"rounded-xl bg-neutral-200 text-neutral-900 dark:bg-neutral-800 dark:text-neutral-100":void 0),children:h})}),(0,n.jsx)(m,{side:"right",children:d})]},s)})})}),(0,n.jsx)("div",{className:"relative flex h-full grow overflow-hidden",children:t.filter(e=>e.content).map((e,t)=>{let s=a===t;return(0,n.jsx)("div",{style:{contentVisibility:s?"auto":"hidden",zIndex:s?0:-1,position:"absolute",display:"flex",left:0,right:0,bottom:0,top:0},children:l[t]&&e.content},e.key)})})]})}function rk(){return(0,n.jsxs)("div",{className:"flex flex-col grow p-2",children:[(0,n.jsx)(aN,{text:"Relational Diagram",onClick:()=>{ri.tabs.openBuiltinERD({})},icon:nW.M}),(0,n.jsx)(aN,{text:"Drop & Empty Multiple Tables",onClick:()=>{ri.tabs.openBuiltinMassDropTable({})},icon:n9.V})]})}var rS=a(86404);let rE="saved-query-";var rR=a(92875),rT=a(82715);function rA(e){let{onCreated:t,onClose:a}=e,{docDriver:r}=x(),[l,i]=(0,s.useState)(""),[o,d]=(0,s.useState)(""),c=(0,s.useCallback)(()=>{r&&(l&&l.length>2?r.createNamespace(l).then(e=>{t(e),a()}).catch(e=>{d(e.message)}):d("The namespace name must be at least 3 characters long"))},[r,l,t,a]);return(0,n.jsx)(a7,{open:!0,onOpenChange:e=>{e||a()},children:(0,n.jsxs)(na,{children:[(0,n.jsx)(nr,{children:"Create Namespace"}),(0,n.jsx)(nl,{children:"A namespace is similar to a folder that groups your work together. It helps you organize and arrange your queries"}),(0,n.jsx)(ni,{placeholder:"Please enter namespace",autoFocus:!0,value:l,onChange:e=>i(e.currentTarget.value)}),o&&(0,n.jsx)("div",{className:"text-xs text-red-500 -mt-2",children:o}),(0,n.jsx)(ns,{children:(0,n.jsx)(W,{onClick:c,children:"Create"})})]})})}function r_(e){let{doc:t,onClose:a,onComplete:r}=e,{docDriver:l}=x(),[i,o]=(0,s.useState)(!1),d=(0,s.useCallback)(()=>{l&&(o(!0),l.removeDoc(t.id).then(()=>{a(),r()}).finally(()=>{o(!1)}))},[t,l,a,r]);return(0,n.jsx)(a7,{open:!0,onOpenChange:e=>{e||a()},children:(0,n.jsxs)(na,{children:[(0,n.jsxs)(nr,{children:["Delete ",'"'.concat(t.name,'"')]}),(0,n.jsxs)(nl,{children:["Are you sure you want to delete ",(0,n.jsx)("strong",{children:t.name})]}),(0,n.jsxs)(ns,{children:[(0,n.jsx)(W,{variant:"secondary",onClick:a,disabled:i,children:"Cancel"}),(0,n.jsx)(W,{variant:"destructive",disabled:i,onClick:d,children:"Delete"})]})]})})}function rL(e){let{onClose:t,onComplete:a,value:r}=e,{docDriver:l}=x(),[i,o]=(0,s.useState)(!1),d=(0,s.useCallback)(()=>{l&&(o(!0),l.getDocs().then(e=>{l.removeNamespace(r.id).then(()=>{var n,s;t(),a(null!==(s=null===(n=e.find(e=>e.namespace.id===r.id))||void 0===n?void 0:n.docs)&&void 0!==s?s:[])}).finally(()=>{o(!1)})}).catch(console.error))},[r,l,t,a]);return(0,n.jsx)(a7,{open:!0,onOpenChange:e=>{e||t()},children:(0,n.jsxs)(na,{children:[(0,n.jsxs)(nr,{children:["Delete ",'"'.concat(r.name,'"')]}),(0,n.jsxs)(nl,{children:["Are you sure you want to delete ",(0,n.jsx)("strong",{children:r.name})]}),(0,n.jsxs)(ns,{children:[(0,n.jsx)(W,{variant:"secondary",onClick:t,disabled:i,children:"Cancel"}),(0,n.jsx)(W,{variant:"destructive",disabled:i,onClick:d,children:"Delete"})]})]})})}function rI(){let{docDriver:e}=x(),[t,a]=(0,s.useState)(),[r,l]=(0,s.useState)(new Set),[i,d]=(0,s.useState)(!1),[c,u]=(0,s.useState)(),[m,h]=(0,s.useState)(),[p,f]=(0,s.useState)([]),g=(0,s.useCallback)(()=>{e&&e.getDocs().then(e=>f(e.map(e=>({data:{type:"namespace",data:e.namespace},key:e.namespace.id,icon:rR.v,name:e.namespace.name,children:e.docs.map(e=>({key:e.id,data:{type:"doc",data:e},icon:se.t,name:e.name}))})))).catch(console.error)},[e]);(0,s.useEffect)(()=>{if(g(),e){let t=()=>{g()};return e.addChangeListener(t),()=>e.removeChangeListener(t)}},[g,e]);let v=null;return m&&(v=(0,n.jsx)(r_,{doc:m,onClose:()=>{h(void 0)},onComplete:()=>{e&&(g(),ri.tabs.close([rE+m.id]))}})),c&&(v=(0,n.jsx)(rL,{onClose:()=>u(void 0),onComplete:t=>{e&&(ri.tabs.close(t.map(e=>rE+e.id)),g())},value:c})),i&&(v=(0,n.jsx)(rA,{onCreated:g,onClose:()=>d(!1)})),(0,n.jsxs)(n.Fragment,{children:[v,(0,n.jsxs)("div",{className:"flex grow flex-col",children:[(0,n.jsxs)("div",{className:"mx-2 mb-5 flex items-center justify-between px-2 pt-4",children:[(0,n.jsx)("h1",{className:"text-xl font-medium text-primary",children:"Queries"}),(0,n.jsxs)(Q,{modal:!1,children:[(0,n.jsx)(J,{asChild:!0,children:(0,n.jsx)("button",{className:o(V({size:"icon"}),"h-8 w-8 rounded-full bg-neutral-800 dark:bg-neutral-200"),children:(0,n.jsx)(rN.F,{size:16,weight:"bold"})})}),(0,n.jsxs)(Z,{children:[(0,n.jsx)($,{onClick:()=>d(!0),children:"New Folder"}),(0,n.jsx)($,{onClick:()=>{ri.tabs.openBuiltinQuery({})},children:"New Query"})]})]})]}),(0,n.jsx)(a6,{full:!0,items:p,selectedKey:t,onSelectChange:a,collapsedKeys:r,onCollapsedChange:l,onDoubleClick:e=>{"doc"===e.data.type&&ri.tabs.openBuiltinQuery({name:e.name,saved:{key:e.key,sql:e.data.data.content,namespaceName:e.data.data.namespace.name}})},onContextMenu:e=>{let t=[];return(null==e?void 0:e.data.type)==="namespace"?t=[...t,{title:"Rename",disabled:!e},{title:"Remove",icon:rT.A,destructive:!0,disabled:!e,onClick:()=>{e&&u(e.data.data)}}]:(null==e?void 0:e.data.type)==="doc"&&(t=[...t,{title:"Remove",onClick:()=>{e&&h(e.data.data)},icon:rT.A,destructive:!0,disabled:!e}]),t}})]})]})}function rF(){let[e,t]=(0,s.useState)(25);(0,s.useEffect)(()=>{t(300/window.innerWidth*100)},[]);let{databaseDriver:a,docDriver:r}=x(),{extensions:l,containerClassName:i}=eu(),[d,c]=(0,s.useState)(0),{currentSchemaName:u}=eb(),[m,h]=(0,s.useState)(()=>[{title:"Query",identifier:"query",key:"query",component:(0,n.jsx)(aq,{initialName:"Query"}),icon:se.t,type:"query"}]),p=(0,s.useCallback)(e=>{h(t=>{let a=t.findIndex(t=>t.identifier===e.key);return a>=0?(c(a),t):(c(t.length),[...t,e])})},[]),f=(0,s.useCallback)(e=>{h(t=>{let a=t.findIndex(t=>t.identifier===e.key);return a>=0?(c(a),t):t.map((t,a)=>a===d?e:t)})},[d]),g=(0,s.useCallback)(e=>{e&&h(t=>{let a=t[d],n=t.filter(t=>!(null==e?void 0:e.includes(t.identifier)));if(a){let e=n.findIndex(e=>e.identifier===a.identifier);e<0?c(Math.min(d,n.length-1)):c(e)}return n})},[d]);(0,s.useEffect)(()=>nG.listen(p),[p]),(0,s.useEffect)(()=>nQ.listen(g),[g]),(0,s.useEffect)(()=>nY.listen(f),[f]);let v=(0,s.useMemo)(()=>[{key:"database",name:"Schema",content:(0,n.jsx)(rw,{}),icon:(0,n.jsx)(a9.X,{weight:"light",size:24})},r?{key:"saved",name:"Queries",content:(0,n.jsx)(rI,{}),icon:(0,n.jsx)(se.t,{weight:"light",size:24})}:void 0,{key:"tools",name:"Tools",content:(0,n.jsx)(rk,{}),icon:(0,n.jsx)(rS._,{weight:"light",size:24})},...l.getSidebars()].filter(Boolean),[r,l]),y=(0,s.useMemo)(()=>[{text:"New Query",onClick:()=>{ri.tabs.openBuiltinQuery({})}},a.getFlags().supportCreateUpdateTable?{text:"New Table",onClick:()=>{ri.tabs.openBuiltinSchema({schemaName:u})}}:void 0].filter(Boolean),[u,a]),b=(0,s.useRef)("");return(0,s.useEffect)(()=>{let e=m[d];e&&e.key!==b.current&&(b.current&&(0,eA.z)([{name:"page_view",data:{path:(0,eA.i)(window.location.pathname),tab:e.type,tab_key:e.key}}]),b.current=e.key)},[m,d,b]),(0,n.jsx)("div",{className:o("flex h-screen w-screen flex-col",i),children:(0,n.jsxs)(en,{direction:"horizontal",children:[(0,n.jsx)(es,{minSize:5,defaultSize:e,children:(0,n.jsx)(rC,{tabs:v})}),(0,n.jsx)(er,{withHandle:!0}),(0,n.jsx)(es,{defaultSize:100-e,children:(0,n.jsx)(aD,{menu:y,tabs:m,selected:d,onSelectChange:c,onTabsChange:h})})]})})}function rM(){let{databaseDriver:e}=x();return(0,s.useEffect)(()=>()=>{e.close()},[e]),(0,n.jsx)(ej,{children:(0,n.jsx)(rF,{})})}function rD(){let{name:e}=eu();return(0,s.useEffect)(()=>{document.title=e+" - Outerbase Studio"},[e]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eg,{children:(0,n.jsx)(d,{children:(0,n.jsx)(rM,{})})}),(0,n.jsx)(a2,{})]})}function rO(){return(0,n.jsx)(rD,{})}class rq{getMetadata(e){return this.metadata[e]}getMetadataList(){return structuredClone(this.metadata)}setMetadata(e,t){this.metadata[e]=t}getStatments(){return this.statements}updateStatements(e){this.statements=e}getType(){return this.type}constructor(e,t){this.type=e,this.statements=t,this.metadata={}}}let rU=(0,s.createContext)({showDialog:ed()});function rK(e){var t;let{children:a}=e,[r,l]=(0,s.useState)(null),[i,o]=(0,s.useState)(""),[d,c]=(0,s.useState)(!1),u=(0,s.useCallback)(()=>{o(""),l(null)},[]);return(0,n.jsxs)(rU.Provider,{value:{showDialog:l},children:[a,r&&(0,n.jsx)(a7,{open:null!==r,onOpenChange:e=>{e||u()},children:(0,n.jsxs)(na,{children:[(0,n.jsx)(nn,{className:(null==r?void 0:r.destructive)?"text-red-500":"",children:(0,n.jsx)(nr,{children:r.title})}),i&&(0,n.jsx)("div",{className:"text-sm text-red-500 font-mono flex gap-4 items-end",children:(0,n.jsx)("p",{children:i})}),(0,n.jsx)("div",{children:r.content}),r.previewCode&&(0,n.jsx)(e3,{code:r.previewCode}),(0,n.jsx)(nl,{className:"flex flex-col gap-2"}),(0,n.jsxs)(ns,{children:[null===(t=r.actions)||void 0===t?void 0:t.map(e=>(0,n.jsxs)(W,{className:r.destructive?"bg-red-500 text-white":"",disabled:d,onClick:()=>{c(!0),e.onClick().then(()=>{u(),e.onComplete&&e.onComplete()}).catch(e=>{e instanceof Error?o(e.message):o("An error occurred")}).finally(()=>{c(!1)})},children:[d&&(0,n.jsx)(tq.A,{className:"w-4 h-4 mr-2 animate-spin"}),e.icon&&!d&&(0,n.jsx)(e.icon,{className:"w-4 h-4 mr-2"}),e.text]},e.text)),(0,n.jsx)(W,{disabled:d,variant:"secondary",onClick:()=>{u()},children:"Close"})]})]})})]})}function rz(e){let{driver:t,collaboration:a,name:r,color:l,onBack:i,extensions:o,containerClassName:d,docDriver:c}=e,u=(0,s.useRef)(o);(0,s.useEffect)(()=>{u.current=o},[o]);let m=(0,s.useMemo)(()=>new Proxy(t,{get(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];let[n,s]=t;return"query"===s?async e=>{let t=new rq("query",[e]);return u.current&&await u.current.beforeQuery(t),await n.query(t.getStatments()[0])}:"transaction"===s||"batch"===s?async e=>{let t=new rq(s,[...e]);return u.current&&await u.current.beforeQuery(t),await n.transaction(t.getStatments())}:Reflect.get(...t)}}),[t,u]),h=(0,s.useMemo)(()=>null!=o?o:new ei([]),[o]);(0,s.useEffect)(()=>()=>h.cleanup(),[h]);let x=(0,s.useMemo)(()=>({name:r,color:l,onBack:i,extensions:h,containerClassName:d}),[r,l,i,h,d]);return(0,n.jsx)(p,{driver:m,collaborationDriver:a,docDriver:c,children:(0,n.jsx)(em,{config:x,children:(0,n.jsx)(rK,{children:(0,n.jsx)(t3,{children:(0,n.jsx)(rO,{})})})})})}class rB extends rd{init(e){e.registerQueryHeaderContextMenu(e=>{if(e.metadata.referenceTo)return{key:"foreign-key-indicator",title:"",component:(0,n.jsx)("div",{className:"p-2",children:(0,n.jsxs)("div",{className:"rounded bg-yellow-200 p-2 text-xs text-black",children:[(0,n.jsx)("h2",{className:"font-semibold",children:"Foreign Key"}),(0,n.jsxs)("p",{className:"mt-1 font-mono",children:[e.metadata.referenceTo.table,".",e.metadata.referenceTo.column]})]})})}}),e.registerQueryHeaderContextMenu(e=>{var t,a,s;let r=null===(s=e.metadata)||void 0===s?void 0:null===(a=s.columnSchema)||void 0===a?void 0:null===(t=a.constraint)||void 0===t?void 0:t.generatedExpression;if(r)return{key:"generated-expression",title:"",component:r?(0,n.jsx)("div",{className:"p-2",children:(0,n.jsxs)("div",{className:"rounded bg-blue-200 p-2 text-xs text-black",children:[(0,n.jsx)("h2",{className:"font-semibold",children:"Generated Expression"}),(0,n.jsx)("pre",{className:"text-sm",children:(0,n.jsx)("code",{children:r})})]})}):void 0}})}constructor(...e){super(...e),this.extensionName="column-descriptor"}}var rP=a(60472);function rH(e){let{open:t,onClose:a,driver:r,onSuccess:l,selectedTermDefinition:i}=e,[o,d]=(0,s.useState)(!1),[c,u]=(0,s.useState)(!1),[m,h]=(0,s.useState)({id:"",name:"",otherName:"",definition:""}),x=(0,s.useCallback)(()=>{u(!1),d(!1),a(!1),h({id:"",name:"",otherName:"",definition:""})},[a]);(0,s.useEffect)(()=>{i?h(i):x()},[i,x]);let p=(0,s.useCallback)(()=>{u(!0);let e={...m,id:(null==i?void 0:i.id)||String(1e3*Date.now())};null==r||r.updateTermDefinition(e).then(()=>l()).finally(()=>x())},[m,r,l,x,i]),f=(0,s.useCallback)((e,t)=>{h(a=>({...a,[t]:e}))},[]);return(0,n.jsx)(a7,{open:t,onOpenChange:a,children:(0,n.jsxs)(na,{className:"sm:max-w-[425px]",children:[(0,n.jsxs)(nn,{children:[(0,n.jsx)(nr,{children:i?"Edit Term":"Add Term"}),(0,n.jsx)(nl,{children:i?"Modify the existing term definition.":"Add terms to your Data Dictionary to help your team and AI understand important business terminology."})]}),(0,n.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,n.jsxs)("div",{className:"items-center gap-4",children:[(0,n.jsxs)(tg,{className:"text-right text-xs",children:["Dictionary Term ",(0,n.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,n.jsx)(ni,{value:m.name,placeholder:"Add a name",className:"col-span-3",onChange:e=>f(e.currentTarget.value,"name")})]}),(0,n.jsxs)("div",{className:"items-center gap-4",children:[(0,n.jsx)(tg,{className:"text-right text-xs",children:"Other Names"}),(0,n.jsx)(ni,{value:m.otherName,className:"col-span-3",placeholder:"Add other names",onChange:e=>f(e.currentTarget.value,"otherName")})]}),(0,n.jsxs)("div",{className:"items-center gap-4",children:[(0,n.jsxs)(tg,{className:"text-right text-xs",children:["Definition ",(0,n.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,n.jsx)(sA,{rows:4,value:m.definition,className:"col-span-3",placeholder:"Add a definition",onChange:e=>f(e.currentTarget.value,"definition")})]})]}),(0,n.jsxs)(ns,{children:[(0,n.jsxs)(W,{disabled:c||!m.name||!m.definition,onClick:p,type:"submit",children:[c&&(0,n.jsx)(tq.A,{className:"mr-1 h-4 w-4 animate-spin"}),i?"Save Change":"Add Entry"]}),i&&(0,n.jsxs)(W,{disabled:o,onClick:function(){i&&(d(!0),null==r||r.deleteTermDefinition(i.id).then(()=>l()).finally(()=>x()))},variant:"destructive",children:[o&&(0,n.jsx)(tq.A,{className:"mr-1 h-4 w-4 animate-spin"}),"Delete"]}),(0,n.jsx)(nq,{})]})]})})}var rX=a(5565);function rV(){let{resolvedTheme:e}=(0,B.D)(),t=(0,s.useMemo)(()=>[{src:"/extension/term-".concat(e,".png"),title:"Create a term",describtion:"Start by adding a term or acronym your organization regularly uses."},{src:"/extension/definition-".concat(e,".png"),title:"Add a definition",describtion:"Give your term context and define it using plaintext or SQL."},{src:"/extension/chart-".concat(e,".png"),title:"Reference your entry",describtion:"Now, your entry can be referenced while chatting with EZQL."}],[e]);return(0,n.jsx)("div",{className:"grid grid-cols-1 gap-10 md:grid-cols-2 lg:grid-cols-3",children:t.map((e,t)=>(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"dark:bg-primary-foreground bg-accent relative mt-10 mb-10 h-[280px] flex-1 items-center justify-center rounded-md border p-[10px] pb-0",children:(0,n.jsx)("div",{className:"relative h-full w-full overflow-hidden rounded-md",children:(0,n.jsx)(rX.default,{src:e.src,alt:e.title,layout:"fill",objectFit:"cover"})})}),(0,n.jsxs)("div",{className:"flex gap-2 text-xl font-semibold",children:[(0,n.jsx)("div",{className:"bg-accent h-[32px] w-[32px] rounded text-center dark:bg-neutral-900",children:t+1}),e.title]}),(0,n.jsx)("div",{className:"mt-1 ml-10 text-sm font-normal",children:e.describtion})]},t))})}var rW=a(10507);function rG(e){let{data:t,onSelect:a}=e;return(0,n.jsx)("div",{className:"mt-10",children:null==t?void 0:t.map(e=>(0,n.jsxs)("div",{onClick:()=>a(e),className:"bg-accent mt-3 flex rounded-xl border p-5 hover:bg-gray-200 dark:bg-neutral-900 dark:hover:bg-neutral-800",children:[(0,n.jsxs)("div",{className:"gap-5",children:[(0,n.jsx)("div",{className:"text-lg font-bold",children:e.name}),(0,n.jsx)("div",{children:e.definition}),e.otherName&&(0,n.jsxs)("div",{className:"mt-3 text-sm",children:["Also known as: ",e.otherName]})]}),(0,n.jsx)("div",{className:"flex-1"}),(0,n.jsx)(rW.A,{size:18})]},e.id))})}function rY(){let{extensions:e}=eu(),t=e.getExtension("data-catalog"),a=null==t?void 0:t.driver,[r,l]=(0,s.useState)(!1),[i,o]=(0,s.useState)(()=>(null==a?void 0:a.getTermDefinitions())||[]),[d,c]=(0,s.useState)();function u(){l(!0),c(void 0)}return a?(0,n.jsxs)("div",{className:"flex h-full flex-1 flex-col",children:[(0,n.jsx)("div",{className:"border-b p-1",children:(0,n.jsxs)(nO,{children:[(0,n.jsx)("div",{children:"Data Catalog"}),(0,n.jsx)(nq,{}),(0,n.jsx)(W,{size:"sm",onClick:u,children:"Add Entry"}),(0,n.jsx)(rH,{selectedTermDefinition:d,open:r,onClose:l,driver:a,onSuccess:function(){o((null==a?void 0:a.getTermDefinitions())||[])}})]})}),(0,n.jsxs)("div",{className:"flex-1 gap-5 overflow-scroll p-10 pb-0",children:[(0,n.jsxs)("div",{className:"w-[450px]",children:[(0,n.jsx)("div",{className:"text-3xl font-bold",children:(null==i?void 0:i.length)===0?"Get started with Data Catalog":"Definitions"}),(0,n.jsx)("div",{className:"text-sm",children:(null==i?void 0:i.length)===0?" Provide explanations for terminology in your schema. EZQL will use this to make running queries more efficient and accurate.":"Defined terms to be used in your product."})]}),(null==i?void 0:i.length)===0?(0,n.jsx)(rV,{}):(0,n.jsx)(rG,{data:i,onSelect:e=>{c(e),l(!0)}}),(0,n.jsx)(W,{className:"mt-10 mb-10",onClick:u,children:(null==i?void 0:i.length)===0?"Create your first entry":"Add Entry"})]})]}):(0,n.jsx)("div",{children:"Missing driver"})}var rQ=a(18369);let rJ=rQ.bL,rZ=rQ.R6,r$=rQ.Ke;var r0=a(80368),r1=a(97752),r2=a(65992),r4=a(83047),r5=a(85348);function r3(e){var t,a;let{driver:r,schemaName:l,tableName:i,columnName:o,onClose:d}=e,c=r.getColumn(l,i,o),{databaseDriver:u}=x(),[m,h]=(0,s.useState)(null!==(t=null==c?void 0:c.definition)&&void 0!==t?t:""),[p,f]=(0,s.useState)((null!==(a=null==c?void 0:c.samples)&&void 0!==a?a:[]).join(",")),[g,v]=(0,s.useState)(!1),[y,b]=(0,s.useState)(!1),j=(0,s.useCallback)(()=>{b(!0),u.query("SELECT DISTINCT ".concat(u.escapeId(o)," FROM ").concat(u.escapeId(l),".").concat(u.escapeId(i)," LIMIT 10")).then(e=>{f(e.rows.map(e=>e[o]).join(", "))}).finally(()=>b(!1))},[u,o,l,i]),N=(0,s.useCallback)(()=>{var e;v(!0),r.updateColumn(l,i,o,{definition:m,samples:p&&p.trim()?p.split(",").map(e=>e.trim()):[],hideFromEzql:null!==(e=null==c?void 0:c.hideFromEzql)&&void 0!==e&&e}).then(e=>{console.log(e)}).finally(()=>{v(!1),d()})},[r,c,p,o,d,l,i,m]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(nn,{children:[(0,n.jsx)(nr,{children:"Column Metadata"}),(0,n.jsx)(nl,{children:"Add metadata to this column to help your team and AI understand its purpose. Include detailed descriptions and examples of sample data to make the data more clear and easier to use."})]}),(0,n.jsxs)("div",{className:"mt-2 flex flex-col gap-4",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)(tg,{children:"Column Description"}),(0,n.jsx)(sA,{rows:4,value:m,onChange:e=>h(e.currentTarget.value),placeholder:"Please provide the definition of a column. This is intended to enhance AI functionality."})]}),(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,n.jsx)(tg,{children:"Sample Data"}),(0,n.jsx)("div",{children:(0,n.jsxs)(W,{size:"sm",variant:"outline",onClick:j,children:[y?(0,n.jsx)(tq.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,n.jsx)(r5.a,{className:"mr-2 h-4 w-4"}),"Automatically Generate Sample Data"]})})]}),(0,n.jsx)(sA,{rows:4,value:p,onChange:e=>f(e.currentTarget.value),placeholder:"Please provide the definition of a column. This is intended to enhance AI functionality."})]})]}),(0,n.jsx)(ns,{children:(0,n.jsxs)(W,{disabled:g,onClick:N,children:[g&&(0,n.jsx)(tq.A,{className:"mr-1 h-4 w-4 animate-spin"}),"Save"]})})]})}function r8(e){var t;let{column:a,table:r,driver:l,search:i,hasDefinitionOnly:d}=e,c=l.getColumn(r.schemaName,r.tableName,a.name),u=null==c?void 0:c.definition,m=null!==(t=null==c?void 0:c.samples)&&void 0!==t?t:[],[h,x]=(0,s.useState)(!1),[p,f]=(0,s.useState)(!1),[g,v]=(0,s.useState)(()=>(null==c?void 0:c.hideFromEzql)||!0),y=(0,s.useCallback)(()=>{v(!g),x(!0),l.updateColumn(r.schemaName,r.tableName,a.name,{...c,hideFromEzql:!g}).finally(()=>{x(!1)})},[l,r,g,c,a]);return d&&!u?null:(0,n.jsxs)("div",{className:o("border-accent flex border-t pt-2 pb-2 text-sm",g?"opacity-100":"opacity-50"),children:[(0,n.jsx)(W,{disabled:h,onClick:y,size:"icon",variant:"ghost",children:g?(0,n.jsx)(r2.A,{className:"text-black dark:text-green-500"}):(0,n.jsx)(r4.A,{className:"text-gray-400"})}),(0,n.jsx)("div",{className:"flex w-[150px] items-center p-2",children:(0,n.jsx)(a5,{text:a.name,highlight:i})}),(0,n.jsx)("div",{className:"text-muted-foreground flex-1 p-2",children:u||"No description"}),(0,n.jsx)("div",{className:"w-[150px] p-2",children:m.length>0&&(0,n.jsxs)("span",{className:"bg-secondary rounded p-1 px-2 text-xs",children:[m.length," sample data"]})}),(0,n.jsxs)(Q,{children:[(0,n.jsx)(J,{asChild:!0,disabled:!g,children:(0,n.jsx)(W,{size:"icon",variant:"ghost",children:(0,n.jsx)(r0.A,{className:"h-4 w-4"})})}),(0,n.jsxs)(Z,{align:"end",className:"p-2",children:[(0,n.jsxs)($,{className:"gap-5",onClick:()=>{f(!0)},children:["Edit Column",(0,n.jsx)("div",{className:"flex-1"}),(0,n.jsx)(rW.A,{className:"h-4 w-4"})]}),(0,n.jsx)(et,{}),(0,n.jsxs)($,{className:"gap-5",onClick:y,children:["Hide from EZQL",(0,n.jsx)("div",{className:"flex-1"}),(0,n.jsx)(r1.A,{className:"h-4 w-4"})]})]})]}),(0,n.jsx)(a7,{open:p,onOpenChange:f,children:(0,n.jsx)(na,{children:p&&(0,n.jsx)(r3,{driver:l,schemaName:r.schemaName,tableName:r.tableName,columnName:a.name,onClose:()=>f(!1)})})})]},a.name)}function r6(e){let{virtualKeyColumn:t,virtualKeySchema:a,virtualKeyTable:r,flags:l,onEditRelationship:i,onDeletRelatinship:d}=e,[c,u]=(0,s.useState)((null==l?void 0:l.isActive)||!0);return(0,n.jsxs)("div",{className:o("border-accent flex border-t pt-2 pb-2 text-sm",c?"opacity-100":"opacity-50"),children:[(0,n.jsx)(W,{onClick:()=>u(!c),size:"icon",variant:"ghost",children:c?(0,n.jsx)(r2.A,{className:"text-black dark:text-green-500"}):(0,n.jsx)(r4.A,{className:"text-gray-400"})}),(0,n.jsx)("div",{className:"flex w-[150px] items-center p-2",children:t}),(0,n.jsx)("div",{className:"flex w-[150px] items-center p-2",children:a}),(0,n.jsx)("div",{className:"flex w-[150px] items-center p-2",children:r}),(0,n.jsx)("div",{className:"flex-1"}),(0,n.jsxs)(Q,{children:[(0,n.jsx)(J,{asChild:!0,children:(0,n.jsx)(W,{size:"icon",variant:"ghost",children:(0,n.jsx)(r0.A,{className:"h-4 w-4"})})}),(0,n.jsxs)(Z,{align:"end",className:"p-2",children:[(0,n.jsxs)($,{className:"gap-5",onClick:i,children:["Edit Relationship",(0,n.jsx)("div",{className:"flex-1"}),(0,n.jsx)(rW.A,{className:"h-4 w-4"})]}),(0,n.jsx)(et,{}),(0,n.jsxs)($,{className:"gap-5",onClick:d,children:["Delete Virtual FK",(0,n.jsx)("div",{className:"flex-1"}),(0,n.jsx)(rT.A,{className:"h-4 w-4"})]})]})]})]})}function r9(e){let{tableName:t,schemaName:a,driver:r,column:l,onClose:i}=e,[o,d]=(0,s.useState)(!1),[c,u]=(0,s.useState)(null==l?void 0:l.virtualKeySchema),[m,h]=(0,s.useState)(null==l?void 0:l.virtualKeyTable),[x,p]=(0,s.useState)(null==l?void 0:l.virtualKeyColumn);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(nn,{children:[(0,n.jsxs)(nr,{children:["Add Relationship to ",t]}),(0,n.jsx)(nl,{children:"Use virtual relationships to connect fields that don't have a direct foreign key link. For example, if two tables should be related by email or title but don't have a formal foreign key, use these virtual relationships to link them."})]}),(0,n.jsxs)("div",{className:"mt-2 flex flex-col gap-4",children:[(0,n.jsx)("div",{className:"flex flex-col gap-2",children:(0,n.jsx)(tg,{children:"Column"})}),(0,n.jsx)(sS,{value:c,schemaName:a,tableName:t,onChange:u}),(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)("div",{className:"flex items-center justify-between gap-2",children:(0,n.jsx)(tg,{children:"Relationship Table"})}),(0,n.jsx)(sR,{value:m,schemaName:a,onChange:h})]}),(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)("div",{className:"flex items-center justify-between gap-2",children:(0,n.jsx)(tg,{children:"Relationship Column"})}),(0,n.jsx)(sS,{value:x,schemaName:a,tableName:t,onChange:p})]})]}),(0,n.jsxs)(ns,{children:[(0,n.jsxs)(W,{variant:"ghost",disabled:!x||!c||!m,onClick:()=>{d(!0);let e=r.getTable(a,t),n=[...(null==e?void 0:e.virtualJoin)||[]],s={id:(null==l?void 0:l.id)||new Date().toISOString(),schema:a,tableName:t,columnName:x||"",virtualKeyColumn:x||"",virtualKeySchema:c||"",virtualKeyTable:m||""};if(null==l?void 0:l.id){let e=n.findIndex(e=>e.id===l.id);e>-1&&(n[e]=s)}else n.push(s);let o={...e,virtualJoin:n};null==r||r.updateTable(a,t,o).then(e=>console.log("Updated successfully:",e)).catch(e=>{console.error("Error updating virtual join:",e)}).finally(()=>{d(!1),i()})},children:[o&&(0,n.jsx)(tq.A,{className:"mr-1 h-4 w-4 animate-spin"}),l?"Edit Relationship":"Create Virtual Join"]}),(0,n.jsx)("div",{className:"flex-1"})]})]})}function r7(e){var t;let{table:a,driver:r,search:l,hasDefinitionOnly:i}=e,d=r.getTable(a.schemaName,a.tableName),[c,u]=(0,s.useState)(!0),[m,h]=(0,s.useState)(),[x,p]=(0,s.useState)(!1),[f,g]=(0,s.useState)((null==d?void 0:d.definition)||""),v=(0,s.useCallback)(()=>{f&&f.trim()&&f!==(null==d?void 0:d.definition)&&r.updateTable(null==a?void 0:a.schemaName,a.tableName,{...d,definition:f})},[r,a,f,d]),y=(0,s.useCallback)(e=>{var t;let n=null==d?void 0:null===(t=d.virtualJoin)||void 0===t?void 0:t.filter(t=>t.id!==e);r.updateTable(null==a?void 0:a.schemaName,a.tableName,{...d,virtualJoin:n}).then(()=>{console.log("deleted sucessful")})},[r,d,a]),b=(0,s.useMemo)(()=>l&&l.toLowerCase()!==a.tableName.toLowerCase()?a.columns.filter(e=>e.name.toLowerCase().includes(l.toLowerCase())):a.columns,[l,a]),j=(0,s.useMemo)(()=>!l||a.tableName.toLowerCase().includes(null==l?void 0:l.toLowerCase()),[l,a]);return i&&0===a.columns.map(e=>{let t=r.getColumn(a.schemaName,a.tableName,e.name);return!!(null==t?void 0:t.definition)}).filter(Boolean).length||!j&&0===b.length&&l?null:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a7,{open:x,onOpenChange:p,children:(0,n.jsx)(na,{children:(0,n.jsx)(r9,{driver:r,column:m,tableName:a.tableName,schemaName:a.schemaName,onClose:()=>{p(!1),h(void 0)}})})}),(0,n.jsx)(rJ,{open:c,onOpenChange:u,children:(0,n.jsxs)("div",{className:"rounded-xl border border-neutral-200 bg-white/50 p-3 hover:border-neutral-300 hover:bg-white dark:border-neutral-800/50 dark:bg-neutral-900 dark:text-white dark:hover:border-neutral-800 dark:hover:bg-neutral-800",children:[(0,n.jsxs)("div",{className:"flex p-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"font-bold",children:a.tableName}),(0,n.jsx)("input",{value:f,placeholder:"No description",onBlur:v,onChange:e=>{e.preventDefault(),g(e.currentTarget.value)},className:"h-[30px] w-[150px] p-0 text-[13px] focus-visible:outline-none"})]}),(0,n.jsx)(rZ,{className:"flex-1"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsxs)(Q,{children:[(0,n.jsx)(J,{asChild:!0,children:(0,n.jsx)(W,{size:"icon",variant:"ghost",children:(0,n.jsx)(r0.A,{className:"h-4 w-4"})})}),(0,n.jsxs)(Z,{align:"end",className:"p-2",children:[(0,n.jsxs)($,{className:"gap-5",onClick:()=>{u(!0)},children:["Edit Metadata",(0,n.jsx)("div",{className:"flex-1"}),(0,n.jsx)(rW.A,{className:"h-4 w-4"})]}),(0,n.jsx)(et,{}),(0,n.jsxs)($,{onClick:()=>p(!0),className:"gap-5",children:["Add Virtaul Join",(0,n.jsx)("div",{className:"flex-1"}),(0,n.jsx)(r1.A,{className:"h-4 w-4"})]})]})]}),(0,n.jsx)(rZ,{children:(0,n.jsx)(as.A,{className:o("h-4 w-4 transform transition-transform duration-200",c?"rotate-180":"rotate-0")})})]})]}),(0,n.jsxs)(r$,{children:[b.map(e=>(0,n.jsx)(r8,{table:a,column:e,driver:r,search:l,hasDefinitionOnly:i},e.name)),(null==d?void 0:d.virtualJoin)&&d.virtualJoin.length>0&&(0,n.jsxs)("div",{className:"rounded-xl border border-neutral-200 p-3 hover:bg-white dark:border-neutral-800/50 dark:bg-neutral-950 dark:text-white",children:[(0,n.jsx)("div",{className:"p-3 font-bold",children:"Relationship"}),(0,n.jsx)("div",{className:"",children:null===(t=d.virtualJoin)||void 0===t?void 0:t.map(e=>(0,n.jsx)(r6,{...e,onEditRelationship:()=>{p(!0),h(e)},onDeletRelatinship:()=>{y(e.id)}},e.id))})]})]})]})})]})}function le(){let{currentSchemaName:e,schema:t}=eb(),[a,r]=(0,s.useState)(""),[l,i]=(0,s.useState)(!1),[o,d]=(0,s.useState)(e),{extensions:c}=eu(),u=c.getExtension("data-catalog"),m=null==u?void 0:u.driver,h=(0,s.useMemo)(()=>{if(!o)return[];let e=(t[o]||[]).filter(e=>"table"===e.type).map(e=>e.tableSchema).filter(Boolean);return e.sort((e,t)=>e.tableName.localeCompare(t.tableName)),e},[t,o]);return m?(0,n.jsxs)("div",{className:"flex h-full flex-1 flex-col overflow-hidden",children:[(0,n.jsx)("div",{className:"border-b p-1",children:(0,n.jsxs)(nO,{children:[(0,n.jsx)(nD,{value:o,onChange:d}),(0,n.jsxs)("div",{className:"ml-2 flex items-center gap-2",children:[(0,n.jsx)(n0,{checked:l,onCheckedChange:()=>i(!l)}),(0,n.jsx)("label",{className:"text-sm",children:"Definition only?"})]}),(0,n.jsx)(nq,{}),(0,n.jsx)("div",{children:(0,n.jsx)(ni,{value:a,onChange:e=>{r(e.currentTarget.value)},placeholder:"Search tables, columns"})})]})}),(0,n.jsx)("div",{className:"flex flex-1 flex-col gap-4 overflow-y-auto p-4",children:h.map(e=>(0,n.jsx)(r7,{search:a,table:e,driver:m,hasDefinitionOnly:l},e.tableName))})]}):(0,n.jsx)("div",{children:"Missing driver"})}var lt=a(48173),la=a.n(lt);function ln(e){let{text:t,onClick:a,icon:s,href:r,selected:l}=e,i="flex p-2 pl-4 text-xs hover:cursor-pointer hover:bg-secondary",d=(0,n.jsxs)(n.Fragment,{children:[s?(0,n.jsx)(s,{className:"mr-2 h-4 w-4"}):(0,n.jsx)("span",{className:"mr-2 h-4 w-4"}),t]});return r?r.startsWith("https://")?(0,n.jsx)(la(),{href:r,className:i,target:"_blank",children:d}):(0,n.jsx)(la(),{href:r,className:i,children:d}):(0,n.jsx)("button",{className:o(i,l?"bg-selected":""),onClick:a,children:d})}function ls(e){let{text:t}=e;return(0,n.jsx)("div",{className:"mt-2 flex p-2 pl-4 text-xs font-bold",children:t})}var lr=a(23500);function ll(){return(0,n.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,n.jsx)(ls,{text:"Data Catalog"}),(0,n.jsx)(ln,{text:"Data Catalog",onClick:()=>lo.open({}),icon:lr.W}),(0,n.jsx)(ln,{text:"Data Model",onClick:()=>ld.open({}),icon:lr.W})]})}function li(e){var t;let{schemaName:a,tableName:r,columnName:l,driver:i}=e,o=i.getColumn(a,r,l),[d,c]=(0,s.useState)(null!==(t=null==o?void 0:o.definition)&&void 0!==t?t:""),[u,m]=(0,s.useState)(!1),h=(0,s.useCallback)(()=>{var e,t;m(!0),i.updateColumn(a,r,l,{definition:d,hideFromEzql:null!==(e=null==o?void 0:o.hideFromEzql)&&void 0!==e&&e,samples:null!==(t=null==o?void 0:o.samples)&&void 0!==t?t:[]}).then().catch().finally(()=>m(!1))},[i,d,o,a,r,l]);return(0,n.jsxs)("div",{className:"flex flex-col gap-2 border-b p-2 text-sm",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("h2",{className:"text-xs font-semibold",children:"Data Catalog"}),(0,n.jsxs)("button",{className:"bg-primary text-primary-foreground flex cursor-pointer items-center rounded p-1 px-3 text-xs",onClick:h,disabled:u,children:[u&&(0,n.jsx)(tq.A,{className:"mr-1 h-3 w-3 animate-spin"}),"Save"]})]}),(0,n.jsx)(sA,{placeholder:"Please provide the definition of a column. This is intended to enhance AI functionality.",className:"resize-none",rows:4,value:d,onChange:e=>c(e.currentTarget.value)})]})}let lo=nJ({key:()=>"data-catalog",name:"Data Catalog",generate:()=>({icon:rP.E,title:"Data Catalog",component:(0,n.jsx)(rY,{})})}),ld=nJ({key:()=>"data-catalog-model",name:"Data Model",generate:()=>({icon:rP.E,title:"Data Model",component:(0,n.jsx)(le,{})})});class lc extends rd{init(e){this.driver.load().then().catch(),e.registerSidebar({key:"data-catalog",name:"Data Catalog",icon:(0,n.jsx)(rP.E,{className:"h-6 w-6"}),content:(0,n.jsx)(ll,{})}),e.registerQueryHeaderContextMenu(e=>{let t=e.metadata.from;if(t)return{key:"data-catalog",title:"",component:(0,n.jsx)(li,{schemaName:t.schema,tableName:t.table,columnName:t.column,driver:this.driver})}})}constructor(e){super(),this.driver=e,this.extensionName="data-catalog"}}class lu{async delay(){this.options.delay&&await new Promise(e=>setTimeout(e,this.options.delay))}async load(){return await this.delay(),{schemas:this.schemas,dataCatalog:this.dataCatalog}}async updateColumn(e,t,a,n){await this.delay();let s=e.toLowerCase(),r=t.toLowerCase(),l=a.toLowerCase();this.schemas[s]||(this.schemas[s]={});let i=this.schemas[s];i[r]||(i[r]={schemaName:s,tableName:r,columns:{},definition:""});let o=i[r];o.columns[l]||(o.columns[l]={name:l,definition:"",samples:[],hideFromEzql:!1});let d=o.columns[l];return o.columns[l]={...d,...n},o.columns[l]}async updateTable(e,t,a){await this.delay();let n=e.toLowerCase(),s=t.toLowerCase();this.schemas[n]||(this.schemas[n]={});let r=this.schemas[n];r[s]||(r[s]={schemaName:n,tableName:s,columns:{},definition:"",virtualJoin:[]});let l=r[s];return r[s]={...l,...a},r[s]}getColumn(e,t,a){let n=a.toLowerCase(),s=this.getTable(e,t);return null==s?void 0:s.columns[n]}getTable(e,t){let a=e.toLowerCase(),n=t.toLowerCase();if(!this.schemas[a])return;let s=this.schemas[a];if(s[n])return s[n]}getTermDefinitions(){return this.dataCatalog?this.dataCatalog:[]}async updateTermDefinition(e){await this.delay(),this.dataCatalog||(this.dataCatalog=[]);let t=this.dataCatalog,a=t.findIndex(t=>t.id===e.id);return -1!==a?t[a]={...t[a],...e}:t.unshift(e),e}async deleteTermDefinition(e){if(await this.delay(),!this.dataCatalog)return!1;let t=this.dataCatalog,a=t.length;return this.dataCatalog=t.filter(t=>t.id!==e),t.length<a}constructor(e,t,a){this.schemas=e,this.options=a,this.dataCatalog=t}}class lm extends rd{init(e){e.registerBeforeQuery(async e=>{let t=e.getStatments();1===t.length?(console.group("Query"),console.info("%c".concat(t[0]),"color:#e67e22")):(console.group("Transaction"),t.forEach(e=>console.log("%c".concat(e),"color:#e67e22"))),console.groupEnd()})}constructor(...e){super(...e),this.extensionName="query-history-console-log"}}function lh(e){let{onSave:t,onDiscard:a,isExecuting:s,disabled:r,previewScript:l}=e;return(0,n.jsxs)("div",{className:"p-1 flex gap-2",children:[(0,n.jsxs)(W,{variant:"ghost",onClick:t,disabled:r,size:"sm",children:[s?(0,n.jsx)(tq.A,{className:"w-4 h-4 mr-2 animate-spin"}):(0,n.jsx)(nd.A,{className:"w-4 h-4 mr-2"}),"Save"]}),(0,n.jsx)(W,{size:"sm",variant:"ghost",onClick:a,disabled:r,className:"text-red-500",children:"Discard Change"}),(0,n.jsx)("div",{children:(0,n.jsx)(tV,{orientation:"vertical"})}),(0,n.jsxs)(te,{children:[(0,n.jsx)(tt,{children:(0,n.jsxs)("div",{className:V({size:"sm",variant:"ghost"}),children:[(0,n.jsx)(sg.A,{className:"w-4 h-4 mr-1"}),"SQL Preview"]})}),(0,n.jsxs)(ta,{style:{width:500},children:[(0,n.jsx)("div",{className:"text-xs font-semibold mb-1",children:"SQL Preview"}),(0,n.jsx)("div",{style:{maxHeight:400},className:"overflow-y-auto",children:(0,n.jsx)(e3,{code:l})})]})]})]})}function lx(e){var t;let{value:a,onChange:r}=e,{databaseDriver:l}=x(),{autoCompleteSchema:i,schema:o}=eb(),d=(0,s.useMemo)(()=>(o[a.schemaName],i),[i,o,a.schemaName]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"px-4 py-2 flex flex-row gap-2",children:[(0,n.jsx)(ni,{value:a.name,placeholder:"View Name",onChange:e=>r((0,rc.jM)(a,t=>{t.name=e.currentTarget.value}))}),(0,n.jsx)("div",{className:"w-[200px]",children:(0,n.jsx)(nD,{value:a.schemaName,onChange:e=>{r((0,rc.jM)(a,t=>{t.schemaName=e}))}})})]}),(0,n.jsx)("div",{className:"grow overflow-hidden",children:(0,n.jsx)("div",{className:"h-full",children:(0,n.jsx)(P,{value:null!==(t=null==a?void 0:a.statement)&&void 0!==t?t:"",dialect:l.getFlags().dialect,schema:d,onChange:e=>r((0,rc.jM)(a,t=>{t.statement=e}))})})})]})}let lp={name:"",statement:"",schemaName:""};function lf(e){let{showDialog:t}=(0,s.useContext)(rU),{refresh:a,currentSchemaName:r}=eb(),{databaseDriver:l}=x(),[i,o]=(0,s.useState)(!!e.name),[d,c]=(0,s.useState)(()=>(0,rc.jM)(lp,t=>{var a,n;t.schemaName=null!==(n=null!==(a=e.schemaName)&&void 0!==a?a:r)&&void 0!==n?n:""})),[u,m]=(0,s.useState)(d),[h,p]=(0,s.useState)(!1),f=!rm()(d,u),g=(0,s.useMemo)(()=>{let t=l.dropView(u.schemaName,e.name),a=l.createView(u);return e.name?[t,a]:[a]},[u,l,e.name]);(0,s.useEffect)(()=>{e.schemaName&&e.name&&l.view(e.schemaName,e.name).then(e=>{m(e),c(e)}).finally(()=>o(!1))},[e.name,e.schemaName,l]);let v=(0,s.useCallback)(async()=>{p(!0),u.schemaName!==r&&l.getFlags().supportUseStatement?(await l.query("USE "+l.escapeId(u.schemaName)),await l.transaction(g),""!==r&&await l.query("USE "+l.escapeId(r))):await l.transaction(g)},[r,l,g,u.schemaName]),y=(0,s.useCallback)(()=>{t({title:e.name?"Edit View":"Create View",content:(0,n.jsx)("p",{children:"Are you sure you want to run this change?"}),previewCode:g.join(";\n"),actions:[{text:"Continue",icon:h?tq.A:nd.A,onClick:v,onComplete:()=>{a(),lg.replace({schemaName:u.schemaName,name:u.name}),p(!1)}}]})},[t,e.name,g,h,v,a,u.name,u.schemaName]);return i?(0,n.jsx)(ss,{}):(0,n.jsxs)("div",{className:"flex h-full w-full flex-col overflow-hidden",children:[(0,n.jsx)(lh,{onSave:y,onDiscard:()=>{m(d)},disabled:!f,previewScript:g.join(";\n")}),(0,n.jsx)(lx,{value:u,onChange:m})]})}let lg=nJ({name:"view",key:e=>"".concat(e.schemaName,".").concat(e.name),generate:e=>{var t;return{title:e.name||"New View",component:(0,n.jsx)(lf,{schemaName:e.schemaName,name:null!==(t=e.name)&&void 0!==t?t:""}),icon:aB.A}}});class lv extends rd{init(e){e.registerCreateResourceMenu({key:"view",title:"Create View",onClick:()=>{lg.open({})}}),e.registerResourceContextMenu(e=>{if("view"===e.type)return{key:"view",title:"Edit View",onClick:()=>{lg.open({schemaName:e.schemaName,name:e.name})}}},"modification")}constructor(...e){super(...e),this.extensionName="view-editor"}}class ly{expectKeyword(e){let t="Expect ".concat(e," keywords, but not found");if(!this.ptr||!this.matchKeyword(e))throw Error(t);this.ptr=this.ptr.nextSibling}expectKeywordOptional(e){this.ptr&&this.matchKeyword(e)&&this.next()}expectKeywordsOptional(e){var t;if(0!==e.length&&this.matchKeyword(null!==(t=e[0])&&void 0!==t?t:""))for(let t of(this.next(),e.slice(1)))this.expectKeyword(t)}consumeIdentifier(){if(this.ptr){let e=ek(this.read());return this.next(),e}return""}readKeyword(){if(this.ptr&&"Keyword"===this.ptr.type.name){let e=this.read();return this.next(),e}return""}next(){var e,t;this.ptr=null!==(t=null===(e=this.ptr)||void 0===e?void 0:e.nextSibling)&&void 0!==t?t:null}matchKeyword(e){return(!this.ptr||"Keyword"===this.ptr.type.name)&&this.read().toUpperCase()===e.toUpperCase()}matchKeywords(e){if(this.ptr&&"Keyword"!==this.ptr.type.name)return!1;let t=this.read().toUpperCase();return e.some(e=>e.toUpperCase()===t)}match(e){return!!this.ptr&&this.read().toUpperCase()===e.toUpperCase()}read(){var e;return(null===(e=this.ptr)||void 0===e?void 0:e.node)?this.sql.substring(this.ptr.node.from,this.ptr.node.to):""}node(){var e;return null===(e=this.ptr)||void 0===e?void 0:e.node}type(){var e;return null===(e=this.ptr)||void 0===e?void 0:e.type.name}enterParens(){var e;return(null===(e=this.ptr)||void 0===e?void 0:e.firstChild)&&"("===this.ptr.firstChild.name&&this.ptr.firstChild.nextSibling?new ly(this.ptr.firstChild.nextSibling.cursor(),this.sql):null}end(){return null===this.ptr}constructor(e,t){this.sql="",this.ptr=e.node,this.sql=t}}function lb(e){if(e.matchKeyword("ON")&&(e.next(),e.matchKeyword("CONFLICT")&&(e.next(),!e.end()))){let t=e.read().toUpperCase();return e.next(),t}}function lj(e){let t=[];for(;!e.end()&&(t.push(e.consumeIdentifier()),e.match(","));)e.next();return t}function lN(e,t){if(t.matchKeyword("CONSTRAINT")){t.next();let a=t.consumeIdentifier();return{...lN(e,t),name:a}}if(t.matchKeyword("PRIMARY")){let a,n;let s=!1;if(t.next(),!t.matchKeyword("KEY"))throw Error("PRIMARY must follow by KEY");t.next();let r=t.enterParens();r&&(n=lj(r),t.next()),t.matchKeyword("ASC")?(a="ASC",t.next()):t.matchKeyword("DESC")&&(a="DESC",t.next());let l=lb(t);return t.matchKeyword("AUTOINCREMENT")&&(s=!0,t.next()),{primaryKey:!0,primaryKeyOrder:a,primaryColumns:n,autoIncrement:s,primaryKeyConflict:l,...lN(e,t)}}if(t.matchKeyword("NOT")){if(t.next(),!t.match("NULL"))throw Error("NOT should follow by NULL");return t.next(),{notNull:!0,notNullConflict:lb(t),...lN(e,t)}}if(t.matchKeyword("UNIQUE")){let a;t.next();let n=t.enterParens();return n&&(a=lj(n),t.next()),{unique:!0,uniqueConflict:lb(t),uniqueColumns:a,...lN(e,t)}}if(t.matchKeyword("DEFAULT")){let a,n;return t.next(),"String"===t.type()?(a=t.read().slice(1,-1),t.next()):"Operator"===t.type()?t.match("+")?(t.next(),a=Number(t.read()),t.next()):t.match("-")&&(t.next(),a=-Number(t.read()),t.next()):"Number"===t.type()?(a=Number(t.read()),t.next()):"Parens"===t.type()?n=t.read():(t.match("current_timestamp")||t.match("current_time")||t.match("current_date")||t.match("true")||t.match("false")||t.match("null"))&&(n=t.read()),{defaultValue:a,defaultExpression:n,...lN(e,t)}}if(t.matchKeyword("CHECK")){t.next();let a=t.read();return t.next(),{checkExpression:a,...lN(e,t)}}if(t.matchKeyword("COLLATE")){t.next();let a=t.read();return t.next(),{collate:a,...lN(e,t)}}else if(t.matchKeyword("FOREIGN")){var a,n,s,r;if(t.next(),!t.match("KEY"))throw Error("FOREIGN should follow by KEY");t.next();let l=t.enterParens();if(!l)throw Error("FOREIGN KEY should follow by column list");let i=lj(l);t.next();let o=lN(e,t);return{foreignKey:{foreignSchemaName:e,foreignTableName:null!==(s=null==o?void 0:null===(a=o.foreignKey)||void 0===a?void 0:a.foreignTableName)&&void 0!==s?s:"",foreignColumns:null!==(r=null==o?void 0:null===(n=o.foreignKey)||void 0===n?void 0:n.foreignColumns)&&void 0!==r?r:[],columns:i}}}else if(t.matchKeyword("REFERENCES")){t.next();let a=t.consumeIdentifier(),n=[];for(;!t.end()&&"Parens"!==t.type()&&!t.match(",");)t.next();let s=t.enterParens();return s&&(n=lj(s)),{foreignKey:{foreignSchemaName:e,foreignTableName:a,foreignColumns:n},...lN(e,t)}}else if(t.match("GENERATED")){if(t.next(),!t.match("ALWAYS"))throw Error("GENERATED should follow by ALWAYS");if(t.next(),!t.match("AS"))throw Error("GENERATED ALWAYS should follow by AS");t.next();let a=t.read();return t.next(),{generatedType:t.matchKeyword("STORED")?"STORED":"VIRTUAL",generatedExpression:a,...lN(e,t)}}}function lw(e,t){let a;let n=N.language.parser.parse(t).cursor();n.firstChild(),n.firstChild();let s=new ly(n,t);s.expectKeyword("CREATE"),s.expectKeywordOptional("TEMP"),s.expectKeywordOptional("TEMPORARY"),s.expectKeywordOptional("VIRTUAL"),s.expectKeyword("TABLE"),s.expectKeywordsOptional(["IF","NOT","EXIST"]);let r=s.consumeIdentifier();s.match("USING")&&(s.next(),s.match("FTS5")&&(s.next(),a=function(e){let t,a;if(!e)return{};for(;!e.end();)e.match("content")?(e.next(),e.match("=")&&(e.next(),e.end()||(t=ek(e.read()),e.next()))):e.match("content_rowid")&&(e.next(),e.match("=")&&(e.next(),e.end()||(a=ek(e.read()),e.next()))),e.next();return{content:t,contentRowId:a}}(s.enterParens()),s.next()));let l=s.enterParens(),i=l?function(e,t){let a=!0,n=[],s=[];for(;a;){if(a=!1,t.matchKeywords(["CONSTRAINT","PRIMARY","UNIQUE","CHECK","FOREIGN"])){let n=lN(e,t);n&&(s.push(n),a=!0)}else{let s=function(e,t){let a=t.consumeIdentifier();if(!a)return null;let n=t.read();t.next(),"Parens"===t.type()&&(n+=t.read(),t.next());let s=lN(e,t);return{name:a,pk:null==s?void 0:s.primaryKey,constraint:s,type:n}}(e,t);s&&(n.push(s),a=!0)}for(;","!==t.read()&&!t.end();)t.next();if(t.end())break;t.next()}for(let e of s)if(e.primaryKey&&e.primaryColumns)for(let t of e.primaryColumns){let e=n.find(e=>t.toLowerCase()===e.name.toLowerCase());e&&(e.pk=!0)}for(let e of n){var r;let t=null===(r=e.constraint)||void 0===r?void 0:r.foreignKey;(null==t?void 0:t.foreignColumns)&&0===t.foreignColumns.length&&(t.foreignColumns=[e.name])}return{columns:n,constraints:s}}(e,l):{columns:[],constraints:[]};s.next();let o=i.columns.filter(e=>e.pk).map(e=>e.name),d=i.columns.some(e=>{var t;return!!(null===(t=e.constraint)||void 0===t?void 0:t.autoIncrement)});return{tableName:r,schemaName:e,...i,pk:o,autoIncrement:d,fts5:a,...function e(t){if(t.match("WITHOUT")){if(t.next(),t.match("ROWID"))return(t.next(),t.match(","))?(t.next(),{withoutRowId:!0,...e(t)}):{withoutRowId:!0}}else if(t.match("STRICT"))return(t.next(),t.match(","))?(t.next(),{strict:!0,...e(t)}):{strict:!0}}(s)}}class lC{}function lk(e,t){let a=Object.entries(t).map(t=>{let[a,n]=t;return"".concat(e.escapeId(a)," = ").concat(e.escapeValue(n))}).join(" AND ");return a.length>0?"WHERE "+a:null}class lS extends lC{validateUpdateOperation(e,t){for(let a of e){let{valid:e,reason:n}=function(e,t){let a=e.operation,n=t.pk,s="INSERT"!==e.operation?e.where:{},r="DELETE"!==e.operation?e.values:{},l=t.autoIncrement,i=n.map(e=>s[e]).some(e=>null==e),o=n.map(e=>void 0===r[e]?s[e]:r[e]).some(e=>null==e);if(0===n.length)return{valid:!1,reason:"This table does not have any primary key. It is not safe to perform any update/delete/insert operation."};if("DELETE"===a){if(i)return{valid:!1,reason:"It is not safe to remove row with NULL in primary key column"}}else if("UPDATE"===a){if(i)return{valid:!1,reason:"It is not safe to update row with NULL in primary key column"};if(o)return{valid:!1,reason:"It is not safe to update row to NULL in primary key column"}}else if(l&&n[0]&&null===r[n[0]]||!l&&o)return{valid:!1,reason:"It is not safe to insert row with NULL in primary key column"};return{valid:!0}}(a,t);if(!e)throw Error(n)}}async getCurrentSchema(){return null}async batch(e){let t=[];for(let a of e)t.push(await this.query(a));return t}getCollationList(){return[]}async updateTableData(e,t,a,n){n&&this.validateUpdateOperation(a,n);let s=a.map(a=>{var n,s,r,l,i,o,d,c,u;return"INSERT"===a.operation?(n=a.values,s=this.getFlags().supportInsertReturning,r=this.getFlags().supportRowId,["INSERT INTO","".concat(this.escapeId(e),".").concat(this.escapeId(t)),function(e,t){let a=[],n=[];for(let[s,r]of Object.entries(t))a.push(e.escapeId(s)),n.push(e.escapeValue(r));return"(".concat(a.join(", "),") VALUES(").concat(n.join(", "),")")}(this,n),s?"RETURNING ".concat(r?"rowid, ":"","*"):""].join(" ")):"DELETE"===a.operation?(l=a.where,["DELETE FROM","".concat(this.escapeId(e),".").concat(this.escapeId(t)),lk(this,l)].filter(Boolean).join(" ")):(i=a.values,o=a.where,d=this.getFlags().supportInsertReturning,c=this.getFlags().supportRowId,["UPDATE","".concat(this.escapeId(e),".").concat(this.escapeId(t)),"SET",(u=this,Object.entries(i).map(e=>{let[t,a]=e;return"".concat(u.escapeId(t)," = ").concat(u.escapeValue(a))}).join(", ")),lk(this,o),d?"RETURNING ".concat(c?"rowid, ":"","*"):""].filter(Boolean).join(" "))}),r=await this.transaction(s),l=[];for(let n=0;n<r.length;n++){let s=r[n],i=a[n];if(!s||!i){l.push({});continue}if("UPDATE"===i.operation){if(1===s.rows.length)l.push({record:s.rows[0]});else{let a=await this.findFirst(e,t,i.where);l.push({lastId:s.lastInsertRowid,record:a.rows[0]})}}else if("INSERT"===i.operation){if(1===s.rows.length)l.push({record:s.rows[0]});else if(i.autoIncrementPkColumn){let a=await this.findFirst(e,t,{[i.autoIncrementPkColumn]:s.lastInsertRowid});l.push({record:a.rows[0],lastId:s.lastInsertRowid})}else if(i.pk&&i.pk.length>0){let a=await this.findFirst(e,t,i.pk.reduce((e,t)=>(e[t]=i.values[t],e),{}));l.push({record:a.rows[0],lastId:s.lastInsertRowid})}else l.push({})}else l.push({})}return l}async findFirst(e,t,a){let n=Object.entries(a).map(e=>{let[t,a]=e;return"".concat(this.escapeId(t)," = ").concat(eE(a))}).join(" AND "),s="SELECT * FROM ".concat(this.escapeId(e),".").concat(this.escapeId(t)," ").concat(n?"WHERE "+n:""," LIMIT 1 OFFSET 0");return this.query(s)}async selectTable(e,t,a){var n;let s=null===(n=a.whereRaw)||void 0===n?void 0:n.trim(),r=a.orderBy&&a.orderBy.length>0?a.orderBy.map(e=>"".concat(this.escapeId(e.columnName)," ").concat(e.by)).join(", "):"",l="SELECT * FROM ".concat(this.escapeId(e),".").concat(this.escapeId(t)).concat(s?" WHERE ".concat(s," "):""," ").concat(r?" ORDER BY ".concat(r):""," LIMIT ").concat(eE(a.limit)," OFFSET ").concat(eE(a.offset),";");return{data:await this.query(l),schema:await this.tableSchema(e,t)}}async dropTable(e,t){await this.query("DROP TABLE ".concat(this.escapeId(e),".").concat(this.escapeId(t),";"))}async emptyTable(e,t){await this.query("DELETE FROM ".concat(this.escapeId(e),".").concat(this.escapeId(t),";"))}}var lE=a(31561),lR=a.n(lE);function lT(e){return e.length>=2&&e.startsWith("(")&&e.endsWith(")")?e:"("+e+")"}function lA(e){var t,a,n,s,r,l,i,o,d,c,u,m;let h=[eC(e.name),e.type];(null===(t=e.constraint)||void 0===t?void 0:t.primaryKey)&&h.push(["PRIMARY KEY",e.constraint.primaryKeyOrder,e.constraint.primaryKeyConflict?"ON CONFLICT ".concat(e.constraint.primaryKeyConflict):void 0,e.constraint.autoIncrement?"AUTOINCREMENT":void 0].filter(Boolean).join(" ")),(null===(a=e.constraint)||void 0===a?void 0:a.unique)&&h.push(["UNIQUE",e.constraint.uniqueConflict?"ON CONFLICT ".concat(e.constraint.uniqueConflict):void 0].filter(Boolean).join(" ")),(null===(n=e.constraint)||void 0===n?void 0:n.notNull)&&h.push(["NOT NULL",e.constraint.notNullConflict?"ON CONFLICT ".concat(e.constraint.notNullConflict):void 0].filter(Boolean).join(" ")),(null===(s=e.constraint)||void 0===s?void 0:s.defaultValue)&&h.push(["DEFAULT",eE(e.constraint.defaultValue)].join(" ")),(null===(r=e.constraint)||void 0===r?void 0:r.defaultExpression)&&h.push(["DEFAULT",lT(e.constraint.defaultExpression)].join(" ")),(null===(l=e.constraint)||void 0===l?void 0:l.generatedExpression)&&h.push(["GENERATED ALWAYS AS",lT(e.constraint.generatedExpression),e.constraint.generatedType].join(" ")),(null===(i=e.constraint)||void 0===i?void 0:i.checkExpression)&&h.push("CHECK "+lT(e.constraint.checkExpression));let x=null===(d=e.constraint)||void 0===d?void 0:null===(o=d.foreignKey)||void 0===o?void 0:o.foreignTableName,p=(null!==(m=null===(u=e.constraint)||void 0===u?void 0:null===(c=u.foreignKey)||void 0===c?void 0:c.foreignColumns)&&void 0!==m?m:[void 0])[0];return x&&p&&h.push(["REFERENCES",eC(x)+"(".concat(eC(p),")")].join(" ")),h.join(" ")}class l_ extends lS{escapeId(e){return'"'.concat(e.replace(/"/g,'""'),'"')}escapeValue(e){return eE(e)}getFlags(){return{supportRowId:!0,supportBigInt:!1,supportModifyColumn:!1,supportInsertReturning:!0,supportUpdateReturning:!0,defaultSchema:"main",optionalSchema:!0,supportCreateUpdateTable:!0,supportCreateUpdateDatabase:!1,supportCreateUpdateTrigger:!0,dialect:"sqlite"}}getSchemaList(e,t){let a=[];for(let n of e.rows)if("table"===n.type)try{a.push({type:"table",schemaName:t,name:n.name,tableSchema:lw(t,n.sql)})}catch(e){a.push({type:"table",name:n.name,schemaName:t})}else"trigger"===n.type?a.push({type:"trigger",name:n.name,tableName:n.tbl_name,schemaName:t}):"view"===n.type&&a.push({type:"view",name:n.name,schemaName:t});return a}async legacyTableSchema(e,t){let a="SELECT * FROM ".concat(this.escapeId(e),".pragma_table_info(").concat(this.escapeValue(t),");"),n=(await this.query(a)).rows.map(e=>({name:e.name,type:e.type,pk:!!e.pk})),s=!1;try{var r;let a=(await this.query("SELECT COUNT(*) AS total FROM ".concat(this.escapeId(e),".sqlite_sequence WHERE name=").concat(eE(t),";"))).rows[0];a&&Number(null!==(r=a[0])&&void 0!==r?r:0)>0&&(s=!0)}catch(e){console.error(e)}return{columns:n,schemaName:e,pk:n.filter(e=>e.pk).map(e=>e.name),autoIncrement:s}}async schemas(){let e=[{name:"main"}];try{this.supportPragmaList&&(e=(await this.query("PRAGMA database_list;")).rows)}catch(e){console.error("PRAGMA database_list statement is not supported")}return(await this.transaction(e.map(e=>"SELECT * FROM ".concat(this.escapeId(e.name),".sqlite_schema;")))).reduce((t,a,n)=>{let s=e[n].name;return t[e[n].name]=this.getSchemaList(a,s),t},{})}async trigger(e,t){let a=(await this.query("SELECT * FROM ".concat(this.escapeId(e),".sqlite_schema WHERE \"type\"='trigger' AND name=").concat(eE(t),";"))).rows[0];if(!a)throw Error("Trigger does not exist");return function(e,t){var a,n,s,r;let l,i,o;let d=N.language.parser.parse(t).cursor();d.firstChild(),d.firstChild();let c=new ly(d,t);c.expectKeyword("CREATE"),c.expectKeywordOptional("TEMP"),c.expectKeywordOptional("TEMPORARY"),c.expectKeyword("TRIGGER"),c.expectKeywordsOptional(["IF","NOT","EXIST"]);let u=c.consumeIdentifier(),m="BEFORE";c.matchKeyword("BEFORE")?c.next():c.matchKeyword("AFTER")?(m="AFTER",c.next()):c.matchKeywords(["INSTEAD","OF"])&&(m="INSTEAD_OF",c.next(),c.next());let h="INSERT";c.matchKeyword("DELETE")?(h="DELETE",c.next()):c.matchKeyword("INSERT")?(h="INSERT",c.next()):c.matchKeyword("UPDATE")&&(h="UPDATE",c.next(),c.matchKeyword("OF")&&(c.next(),l=lj(c))),c.expectKeyword("ON");let x=c.consumeIdentifier();c.expectKeywordsOptional(["FOR","EACH","ROW"]);let p="",f=null===(a=c.node())||void 0===a?void 0:a.from;if(c.matchKeyword("WHEN"))for(c.next();!c.end()&&(i=null===(s=c.node())||void 0===s?void 0:s.to,!c.matchKeyword("BEGIN"));)c.next();f&&(p=t.substring(f,i)),c.expectKeyword("BEGIN");let g="",v=null===(n=c.node())||void 0===n?void 0:n.from;for(;!c.end()&&(o=null===(r=c.node())||void 0===r?void 0:r.to,!c.matchKeyword(";"));)c.next();return v&&(g=t.substring(v,o)),{name:u,operation:h,when:m,tableName:x,schemaName:e,columnNames:l,whenExpression:p,statement:g}}(e,a.sql)}close(){}inferTypeFromHeader(e){if(e)return eR(e.type)}async tableSchema(e,t){let a="SELECT * FROM ".concat(this.escapeId(e),".sqlite_schema WHERE tbl_name = ").concat(eE(t),";"),n=await this.query(a);try{try{let a=n.rows.find(e=>"table"===e.type);if(a){let t=a.sql;return{...lw(e,t),createScript:t,schemaName:e,type:"table"}}throw Error("Unexpected error finding table "+t)}catch(e){throw Error("Unexpected error while parsing")}}catch(a){return await this.legacyTableSchema(e,t)}}createUpdateTableSchema(e){return function(e){var t,a,n,s,r;let l=!e.name.old,i=[];for(let a of e.columns)null===a.new?i.push("DROP COLUMN ".concat(null===(t=a.old)||void 0===t?void 0:t.name)):null===a.old?l?i.push(lA(a.new)):i.push("ADD "+lA(a.new)):(a.new.name!==a.old.name&&i.push("RENAME COLUMN ".concat(eC(a.old.name)," TO ").concat(eC(a.new.name))),rm()(lR()(a.old,["name"]),lR()(a.new,["name"]))||i.push("ALTER COLUMN ".concat(eC(a.new.name)," TO ").concat(lA(a.new))));for(let t of e.constraints)t.new&&l&&i.push(function(e){var t,a,n,s,r;return e.primaryKey?"PRIMARY KEY (".concat(null===(t=e.primaryColumns)||void 0===t?void 0:t.map(eC).join(", "),")"):e.unique?"UNIQUE (".concat(null===(a=e.uniqueColumns)||void 0===a?void 0:a.map(eC).join(", "),")"):void 0!==e.checkExpression?"CHECK (".concat(e.checkExpression,")"):e.foreignKey?"FOREIGN KEY (".concat(null===(n=e.foreignKey.columns)||void 0===n?void 0:n.map(eC).join(", "),") ")+"REFERENCES ".concat(eC(null!==(r=e.foreignKey.foreignTableName)&&void 0!==r?r:"")," ")+"(".concat(null===(s=e.foreignKey.foreignColumns)||void 0===s?void 0:s.map(eC).join(", "),")"):void 0}(t.new));if(l||e.name.new===e.name.old||i.push("RENAME TO ".concat(eC(null!==(a=e.name.new)&&void 0!==a?a:""))),l)return["CREATE TABLE ".concat(eC(null!==(n=e.schemaName)&&void 0!==n?n:"main"),".").concat(eC(e.name.new||"no_table_name"),"(\n").concat(i.map(e=>"  "+e).join(",\n"),"\n)")];{let t="ALTER TABLE ".concat(eC(null!==(s=e.schemaName)&&void 0!==s?s:"main"),".").concat(eC(null!==(r=e.name.old)&&void 0!==r?r:"")," ");return i.map(e=>t+e)}}(e)}createUpdateDatabaseSchema(){throw Error("Not implemented")}createTrigger(e){var t;return"CREATE TRIGGER ".concat(eC(null!==(t=e.name)&&void 0!==t?t:"")," \n").concat(e.when," ").concat(e.operation," ON ").concat(eC(e.tableName)," \nFOR EACH ROW \nBEGIN \n	").concat(e.statement," \nEND")}dropTrigger(e,t){return"DROP TRIGGER IF EXISTS ".concat(this.escapeId(e),".").concat(this.escapeId(t))}async view(e,t){let a="SELECT * FROM ".concat(this.escapeId(e),".sqlite_schema WHERE type = 'view' AND name = ").concat(this.escapeValue(t),";"),n=(await this.query(a)).rows[0];if(!n)throw Error("View dose not exist");return function(e,t){var a,n;let s;let r=N.language.parser.parse(t).cursor();r.firstChild(),r.firstChild();let l=new ly(r,t);l.expectKeyword("CREATE"),l.expectKeywordOptional("TEMP"),l.expectKeywordOptional("TEMPORARY"),l.expectKeyword("VIEW"),l.expectKeywordsOptional(["IF","NOT","EXIST"]);let i=l.consumeIdentifier();l.expectKeyword("AS");let o="",d=null===(a=l.node())||void 0===a?void 0:a.from;for(;!l.end()&&(s=null===(n=l.node())||void 0===n?void 0:n.to,!l.matchKeyword(";"));)l.next();return d&&(o=t.substring(d,s)),{schemaName:e,name:i,statement:o}}(e,n.sql)}createView(e){return"CREATE VIEW ".concat(this.escapeId(e.schemaName),".").concat(this.escapeId(e.name)," AS ").concat(e.statement)}dropView(e,t){return"DROP VIEW IF EXISTS ".concat(this.escapeId(e),".").concat(this.escapeId(t))}async findFirst(e,t,a){let n=Object.entries(a).map(e=>{let[t,a]=e;return"".concat(this.escapeId(t)," = ").concat(eE(a))}).join(", "),s=!!a.rowid,r="SELECT ".concat(s?"rowid, ":"","* FROM ").concat(this.escapeId(e),".").concat(this.escapeId(t)," ").concat(n?"WHERE "+n:""," LIMIT 1 OFFSET 0");return this.query(r)}async selectTable(e,t,a){var n;let s=await this.tableSchema(e,t),r=!1;0!==s.pk.length||s.withoutRowId||s.columns.find(e=>"rowid"===e.name)||"table"!==s.type||(r=!0,s.columns=[{name:"rowid",type:"INTEGER",constraint:{primaryKey:!0,autoIncrement:!0}},...s.columns],s.pk=["rowid"],s.autoIncrement=!0);let l=null===(n=a.whereRaw)||void 0===n?void 0:n.trim(),i=a.orderBy&&a.orderBy.length>0?a.orderBy.map(e=>"".concat(this.escapeId(e.columnName)," ").concat(e.by)).join(", "):"",o="SELECT ".concat(r?"rowid, ":"","* FROM ").concat(this.escapeId(e),".").concat(this.escapeId(t)).concat(l?" WHERE ".concat(l," "):""," ").concat(i?" ORDER BY ".concat(i):""," LIMIT ").concat(eE(a.limit)," OFFSET ").concat(eE(a.offset),";");return{data:await this.query(o),schema:s}}constructor(...e){super(...e),this.supportPragmaList=!0,this.columnTypeSelector={type:"dropdown",dropdownNormalized:e=>{let t=eR(e);return void 0===t?"TEXT":t===ew.$C.INTEGER?"INTEGER":t===ew.$C.REAL?"REAL":t===ew.$C.BLOB?"BLOB":"TEXT"},dropdownOptions:[{text:"Integer",value:"INTEGER"},{text:"Real",value:"REAL"},{text:"Text",value:"TEXT"},{text:"Blob",value:"BLOB"}]}}}class lL extends l_{reload(e){this.db=e,this.hasRowsChanged=!1}async transaction(e){let t=[];for(let a of e)t.push(await this.query(a));return t}async saveToOPFS(){var e;let t=await navigator.storage.getDirectory(),a=await t.getDirectoryHandle("data",{create:!0}),n=await a.getDirectoryHandle("Default",{create:!0}),s=await n.getFileHandle(null!==(e=this.dbName)&&void 0!==e?e:"",{create:!1}),r=await s.createWritable(),l=this.db.export();return await r.write(l),await r.close(),{fileHandle:s,writable:r}}async query(e){let t="string"==typeof e?e:e.sql,a="string"==typeof e?void 0:e.args,n=Date.now(),s=this.db.prepare(t,a),r=Date.now(),l=s.getColumnNames(),i=new Set,o=l.map(e=>{let t=e;for(let a=0;a<20&&i.has(t);a++)t="__".concat(e,"_").concat(a);return{name:t,displayName:e,originalType:null,type:void 0}}),d=[];for(;s.step();){let e=s.get();d.push(o.reduce((t,a,n)=>(t[a.name]=e[n],t),{}))}this.db.getRowsModified()>0&&(this.hasRowsChanged=!0);let c=0===o.length?this.db.getRowsModified():0;return"select "!=t.trim().substring(0,7).toLowerCase()&&this.dbName&&await this.saveToOPFS(),{headers:o,rows:d,stat:{rowsAffected:c,rowsRead:null,rowsWritten:null,queryDurationMs:r-n}}}async executeScript(e){let t=Date.now(),a=[];try{for(let n of this.db.exec(e)){let e=n.columns.map(e=>({name:e,displayName:e,originalType:null,type:void 0})),s=n.values.map(t=>e.reduce((e,a,n)=>(e[a.name]=t[n],e),{}));a.push({headers:e,rows:s,stat:{rowsAffected:n.values.length,rowsRead:n.values.length,rowsWritten:null,queryDurationMs:Date.now()-t}})}return await this.saveToOPFS(),a}catch(e){throw console.error("Error executing SQL script:",e),Error("Failed to execute SQL script")}}resetChange(){this.hasRowsChanged=!1}hasChanged(){return this.hasRowsChanged}close(){}constructor(e,t){super(),this.hasRowsChanged=!1,this.db=e,this.dbName=t}}var lI=a(64517),lF=a(76046),lM=a(54203);async function lD(e){let t=await navigator.storage.getDirectory();try{let a=await t.getDirectoryHandle("data",{create:!0}),n=await a.getDirectoryHandle("Default",{create:!0}),s=await n.getFileHandle(e,{create:!1}),r=await s.getFile(),l=await r.arrayBuffer();return console.log("Existing database found, loading it.",l),l}catch(e){return console.log("No existing database found, creating a new one."),null}}let lO=new URLSearchParams(window.location.search).get("modelName");async function lq(){let e=localStorage.getItem("Projects"),t=[];if(e){let a=JSON.parse(e);for(let e in a)if("Active"===a[e].status)for(let n in a[e].Models)"Active"===a[e].Models[n].status&&t.push([n,a[e].Models[n].templateName,e,"SQLITE"])}return t}function lU(){let[e,t]=(0,s.useState)(),a=(0,lF.useSearchParams)(),[r,l]=(0,s.useState)(),[i,o]=(0,s.useState)(""),[d,c]=(0,s.useState)(lO),u=(0,s.useCallback)(()=>{window.initSqlJs({locateFile:e=>"/SQLiteStudio/sqljs/".concat(e)}).then(t)},[]),m=(0,s.useCallback)(async function(e){let t=e.model_name,a=e.project_name;localStorage.getItem("Projects")||localStorage.setItem("Projects",JSON.stringify({}));let n=await navigator.storage.getDirectory(),s=await n.getDirectoryHandle("data",{create:!0}),l=await s.getDirectoryHandle(a,{create:!0});await l.getFileHandle("".concat(t,".sqlite3"),{create:!0});let i=localStorage.getItem("Projects"),o=i?JSON.parse(i):{};if(Object.keys(o).includes(a)){if(t in o[a].Models)return{msg:"Model already exists with the same name"};o[a].Models[t]={templateName:"Sample DB",status:"Active"}}else o[a]={Models:{[t]:{templateName:"Sample DB",status:"Active"}},status:"Active"};localStorage.setItem("Projects",JSON.stringify(o));let d="Success";try{let e=await fetch("/sample_db.sql");e.ok||(d="Failed to load SQL script: ".concat(e.statusText));let t=await e.text();try{r&&await r.executeScript(t)}catch(e){console.error("Error executing SQL script:",e),d=String(e)}}catch(e){console.error(e),d="Error fetching SQL script"}return{msg:d}},[r]);(0,s.useEffect)(()=>{e&&(async()=>{let t=null,a="Default_DB";d&&(a=d);try{t=await lD("".concat(a,".sqlite3"))}catch(e){console.error("Error loading database:",e)}let n="".concat(a,".sqlite3");t?(o(n),l(new lL(new e.Database(new Uint8Array(t)),n))):(console.log("No database provided"),d||(await lq()).some(e=>e[0]===a)||(o(n),l(new lL(new e.Database,n))))})()},[e,a,d]),(0,s.useEffect)(()=>{if(r){let t=async()=>{console.log("add new model hits");let t=null,a="Default_DB";c(a);let n=await m({model_name:a,model_template:"Sample DB",project_name:"Default",db_user:"",password:"",host:"",port:0,db_type:"SQLITE"});if(n&&"Success"==n.msg){if(!e)return;try{t=await lD("".concat(a,".sqlite3"))}catch(e){console.error("Error loading database:",e)}if(t){let a=new e.Database(new Uint8Array(t));r.reload(a)}}};d||t();let a=e=>{if(r.hasChanged())return e.preventDefault(),"Are you sure you want to close without change?"};return window.addEventListener("beforeunload",a),()=>window.removeEventListener("beforeunload",a)}},[r,m,e,d]);let h=(0,s.useMemo)(()=>new ei([new lm,new lv,new rB,new lc(new lu({},[],{delay:1e3})),new ry]),[]),x=(0,s.useMemo)(()=>r?(0,n.jsx)(rz,{extensions:h,color:"gray",name:"Playground",driver:r,containerClassName:"w-full h-full"}):(0,n.jsx)("div",{}),[r,h]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(lM.default,{src:"/SQLiteStudio/sqljs/sql-wasm.js",onReady:u}),(0,n.jsxs)("div",{className:"flex h-screen w-screen flex-col",children:[(0,n.jsx)("div",{className:"border-b p-1",children:(0,n.jsx)(nO,{children:i&&(0,n.jsxs)("div",{className:"flex items-center gap-1 rounded bg-yellow-300 p-2 text-xs text-black",children:[(0,n.jsx)(lI.A,{className:"h-4 w-4"}),(0,n.jsxs)("span",{children:["Editing ",(0,n.jsx)("strong",{children:i})]})]})})}),(0,n.jsx)("div",{className:"flex-1 overflow-hidden",children:x})]})]})}},33820:(e,t,a)=>{"use strict";a.d(t,{default:()=>h});var n=a(95155),s=a(91890),r=a(76046),l=a(12115);function i(){let e=(0,r.usePathname)();return(0,l.useEffect)(()=>{let t=(0,s.i)(e);(0,s.z)([{name:"page_view",data:{path:t,full_path:e===t?void 0:e}}])},[e]),(0,l.useEffect)(()=>{let e=e=>{var t;"string"==typeof e.reason?(0,s.z)([{name:"unhandledrejection",data:{message:e.reason,path:window.location.pathname}}]):(null===(t=e.reason)||void 0===t?void 0:t.message)?(0,s.z)([{name:"unhandledrejection",data:{message:e.reason.message,stack:e.reason.stack,path:window.location.pathname}}]):(0,s.z)([{name:"unhandledrejection",data:{message:e.toString()}}])};return window.addEventListener("unhandledrejection",e),()=>{window.removeEventListener("unhandledrejection",e)}},[]),(0,l.useEffect)(()=>{let e=e=>{(0,s.z)([{name:"error",data:{message:e.message,filename:e.filename,lineno:e.lineno,colno:e.colno}}])};return window.addEventListener("error",e),()=>{window.removeEventListener("error",e)}},[]),null}var o=a(67113),d=a(30814);let c=e=>{let{...t}=e,{resolvedTheme:a}=(0,o.D)();return(0,n.jsx)(d.l$,{theme:a,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground",success:"*:data-icon:text-green-500",error:"*:data-icon:text-red-500"}},...t})};var u=a(19710),m=a(54203);function h(e){let{children:t,overrideTheme:a,overrideThemeVariables:s}=e;return(0,l.useEffect)(()=>{},[s]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(o.N,{forcedTheme:a,enableColorScheme:!0,attribute:"class",children:[(0,n.jsx)(u.Bc,{children:(0,n.jsx)(l.Fragment,{children:t})}),(0,n.jsx)(c,{})]}),(0,n.jsx)(i,{}),(0,n.jsx)(m.default,{async:!0,defer:!0,src:"https://buttons.github.io/buttons.js"})]})}},43517:(e,t,a)=>{"use strict";a.d(t,{default:()=>s});var n=a(12115);function s(e){let[t,a]=(0,n.useState)(!1);return((0,n.useEffect)(()=>{a(!0)},[]),t)?e.children:null}},91890:(e,t,a)=>{"use strict";a.d(t,{i:()=>l,z:()=>i});let n={},s={};var r=a(2818);function l(e){for(let[t,a]of Object.entries({"/playground/mysql/[roomName]":/\/playground\/mysql\/(\w)+/i}))if(a.test(e))return t;return e}function i(e){if(!r.env.NEXT_PUBLIC_ANALYTIC_ENABLED)return;let t=e.filter(e=>{var t,a,r,l,i;return!["unhandledrejection","error"].includes(e.name)||((console.log("throttleEvent",n,s,t=e.name,(null!==(a=n[t])&&void 0!==a?a:0)>5),Date.now()-(null!==(r=s[t])&&void 0!==r?r:0)<5e3)?(n[t]=(null!==(l=n[t])&&void 0!==l?l:0)+1,(null!==(i=n[t])&&void 0!==i?i:0)>5):(n[t]=0,s[t]=Date.now(),!1))});if(0===t.length)return;let a=localStorage.getItem("od-id");a||(a=crypto.randomUUID(),localStorage.setItem("od-id",a)),fetch("/api/events",{method:"POST",body:JSON.stringify({events:t}),headers:{"Content-Type":"application/json","x-od-id":a}}).then().catch()}}},e=>{var t=t=>e(e.s=t);e.O(0,[946,147,79,862,105,982,441,517,358],()=>t(98425)),_N_E=e.O()}]);