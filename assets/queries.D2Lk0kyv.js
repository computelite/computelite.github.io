import"./pixel.CyAMObzi.js";/* empty css              */import{T as pe,M as ut}from"./bootstrap.esm.BAnKzilB.js";import{e as H,b as S,c as T}from"./scc.C0KxU-5h.js";import"https://webr.r-wasm.org/latest/webr.mjs";/**!
 * Sortable 1.15.6
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function Mt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,o)}return n}function ee(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Mt(Object(n),!0).forEach(function(o){vn(t,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Mt(Object(n)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(n,o))})}return t}function Ue(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ue=function(e){return typeof e}:Ue=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ue(t)}function vn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oe(){return oe=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},oe.apply(this,arguments)}function bn(t,e){if(t==null)return{};var n={},o=Object.keys(t),i,a;for(a=0;a<o.length;a++)i=o[a],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function _n(t,e){if(t==null)return{};var n=bn(t,e),o,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)o=a[i],!(e.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(t,o)&&(n[o]=t[o])}return n}var En="1.15.6";function ne(t){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(t)}var ie=ne(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),$e=ne(/Edge/i),Rt=ne(/firefox/i),Me=ne(/safari/i)&&!ne(/chrome/i)&&!ne(/android/i),xt=ne(/iP(ad|od|hone)/i),Zt=ne(/chrome/i)&&ne(/android/i),Ut={capture:!1,passive:!1};function E(t,e,n){t.addEventListener(e,n,!ie&&Ut)}function _(t,e,n){t.removeEventListener(e,n,!ie&&Ut)}function tt(t,e){if(e){if(e[0]===">"&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch{return!1}return!1}}function Vt(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function U(t,e,n,o){if(t){n=n||document;do{if(e!=null&&(e[0]===">"?t.parentNode===n&&tt(t,e):tt(t,e))||o&&t===n)return t;if(t===n)break}while(t=Vt(t))}return null}var Ft=/\s+/g;function j(t,e,n){if(t&&e)if(t.classList)t.classList[n?"add":"remove"](e);else{var o=(" "+t.className+" ").replace(Ft," ").replace(" "+e+" "," ");t.className=(o+(n?" "+e:"")).replace(Ft," ")}}function y(t,e,n){var o=t&&t.style;if(o){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),e===void 0?n:n[e];!(e in o)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),o[e]=n+(typeof n=="string"?"":"px")}}function Ce(t,e){var n="";if(typeof t=="string")n=t;else do{var o=y(t,"transform");o&&o!=="none"&&(n=o+" "+n)}while(!e&&(t=t.parentNode));var i=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return i&&new i(n)}function Jt(t,e,n){if(t){var o=t.getElementsByTagName(e),i=0,a=o.length;if(n)for(;i<a;i++)n(o[i],i);return o}return[]}function K(){var t=document.scrollingElement;return t||document.documentElement}function B(t,e,n,o,i){if(!(!t.getBoundingClientRect&&t!==window)){var a,r,l,s,c,u,d;if(t!==window&&t.parentNode&&t!==K()?(a=t.getBoundingClientRect(),r=a.top,l=a.left,s=a.bottom,c=a.right,u=a.height,d=a.width):(r=0,l=0,s=window.innerHeight,c=window.innerWidth,u=window.innerHeight,d=window.innerWidth),(e||n)&&t!==window&&(i=i||t.parentNode,!ie))do if(i&&i.getBoundingClientRect&&(y(i,"transform")!=="none"||n&&y(i,"position")!=="static")){var h=i.getBoundingClientRect();r-=h.top+parseInt(y(i,"border-top-width")),l-=h.left+parseInt(y(i,"border-left-width")),s=r+a.height,c=l+a.width;break}while(i=i.parentNode);if(o&&t!==window){var p=Ce(i||t),g=p&&p.a,b=p&&p.d;p&&(r/=b,l/=g,d/=g,u/=b,s=r+u,c=l+d)}return{top:r,left:l,bottom:s,right:c,width:d,height:u}}}function Yt(t,e,n){for(var o=ce(t,!0),i=B(t)[e];o;){var a=B(o)[n],r=void 0;if(r=i>=a,!r)return o;if(o===K())break;o=ce(o,!1)}return!1}function Ne(t,e,n,o){for(var i=0,a=0,r=t.children;a<r.length;){if(r[a].style.display!=="none"&&r[a]!==m.ghost&&(o||r[a]!==m.dragged)&&U(r[a],n.draggable,t,!1)){if(i===e)return r[a];i++}a++}return null}function At(t,e){for(var n=t.lastElementChild;n&&(n===m.ghost||y(n,"display")==="none"||e&&!tt(n,e));)n=n.previousElementSibling;return n||null}function Q(t,e){var n=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)t.nodeName.toUpperCase()!=="TEMPLATE"&&t!==m.clone&&(!e||tt(t,e))&&n++;return n}function Ht(t){var e=0,n=0,o=K();if(t)do{var i=Ce(t),a=i.a,r=i.d;e+=t.scrollLeft*a,n+=t.scrollTop*r}while(t!==o&&(t=t.parentNode));return[e,n]}function wn(t,e){for(var n in t)if(t.hasOwnProperty(n)){for(var o in e)if(e.hasOwnProperty(o)&&e[o]===t[n][o])return Number(n)}return-1}function ce(t,e){if(!t||!t.getBoundingClientRect)return K();var n=t,o=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var i=y(n);if(n.clientWidth<n.scrollWidth&&(i.overflowX=="auto"||i.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(i.overflowY=="auto"||i.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return K();if(o||e)return n;o=!0}}while(n=n.parentNode);return K()}function Sn(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function ht(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}var Re;function Kt(t,e){return function(){if(!Re){var n=arguments,o=this;n.length===1?t.call(o,n[0]):t.apply(o,n),Re=setTimeout(function(){Re=void 0},e)}}}function Tn(){clearTimeout(Re),Re=void 0}function en(t,e,n){t.scrollLeft+=e,t.scrollTop+=n}function tn(t){var e=window.Polymer,n=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):n?n(t).clone(!0)[0]:t.cloneNode(!0)}function nn(t,e,n){var o={};return Array.from(t.children).forEach(function(i){var a,r,l,s;if(!(!U(i,e.draggable,t,!1)||i.animated||i===n)){var c=B(i);o.left=Math.min((a=o.left)!==null&&a!==void 0?a:1/0,c.left),o.top=Math.min((r=o.top)!==null&&r!==void 0?r:1/0,c.top),o.right=Math.max((l=o.right)!==null&&l!==void 0?l:-1/0,c.right),o.bottom=Math.max((s=o.bottom)!==null&&s!==void 0?s:-1/0,c.bottom)}}),o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}var z="Sortable"+new Date().getTime();function In(){var t=[],e;return{captureAnimationState:function(){if(t=[],!!this.options.animation){var o=[].slice.call(this.el.children);o.forEach(function(i){if(!(y(i,"display")==="none"||i===m.ghost)){t.push({target:i,rect:B(i)});var a=ee({},t[t.length-1].rect);if(i.thisAnimationDuration){var r=Ce(i,!0);r&&(a.top-=r.f,a.left-=r.e)}i.fromRect=a}})}},addAnimationState:function(o){t.push(o)},removeAnimationState:function(o){t.splice(wn(t,{target:o}),1)},animateAll:function(o){var i=this;if(!this.options.animation){clearTimeout(e),typeof o=="function"&&o();return}var a=!1,r=0;t.forEach(function(l){var s=0,c=l.target,u=c.fromRect,d=B(c),h=c.prevFromRect,p=c.prevToRect,g=l.rect,b=Ce(c,!0);b&&(d.top-=b.f,d.left-=b.e),c.toRect=d,c.thisAnimationDuration&&ht(h,d)&&!ht(u,d)&&(g.top-d.top)/(g.left-d.left)===(u.top-d.top)/(u.left-d.left)&&(s=Dn(g,h,p,i.options)),ht(d,u)||(c.prevFromRect=u,c.prevToRect=d,s||(s=i.options.animation),i.animate(c,g,d,s)),s&&(a=!0,r=Math.max(r,s),clearTimeout(c.animationResetTimer),c.animationResetTimer=setTimeout(function(){c.animationTime=0,c.prevFromRect=null,c.fromRect=null,c.prevToRect=null,c.thisAnimationDuration=null},s),c.thisAnimationDuration=s)}),clearTimeout(e),a?e=setTimeout(function(){typeof o=="function"&&o()},r):typeof o=="function"&&o(),t=[]},animate:function(o,i,a,r){if(r){y(o,"transition",""),y(o,"transform","");var l=Ce(this.el),s=l&&l.a,c=l&&l.d,u=(i.left-a.left)/(s||1),d=(i.top-a.top)/(c||1);o.animatingX=!!u,o.animatingY=!!d,y(o,"transform","translate3d("+u+"px,"+d+"px,0)"),this.forRepaintDummy=Cn(o),y(o,"transition","transform "+r+"ms"+(this.options.easing?" "+this.options.easing:"")),y(o,"transform","translate3d(0,0,0)"),typeof o.animated=="number"&&clearTimeout(o.animated),o.animated=setTimeout(function(){y(o,"transition",""),y(o,"transform",""),o.animated=!1,o.animatingX=!1,o.animatingY=!1},r)}}}}function Cn(t){return t.offsetWidth}function Dn(t,e,n,o){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))*o.animation}var _e=[],mt={initializeByDefault:!0},ze={mount:function(e){for(var n in mt)mt.hasOwnProperty(n)&&!(n in e)&&(e[n]=mt[n]);_e.forEach(function(o){if(o.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),_e.push(e)},pluginEvent:function(e,n,o){var i=this;this.eventCanceled=!1,o.cancel=function(){i.eventCanceled=!0};var a=e+"Global";_e.forEach(function(r){n[r.pluginName]&&(n[r.pluginName][a]&&n[r.pluginName][a](ee({sortable:n},o)),n.options[r.pluginName]&&n[r.pluginName][e]&&n[r.pluginName][e](ee({sortable:n},o)))})},initializePlugins:function(e,n,o,i){_e.forEach(function(l){var s=l.pluginName;if(!(!e.options[s]&&!l.initializeByDefault)){var c=new l(e,n,e.options);c.sortable=e,c.options=e.options,e[s]=c,oe(o,c.defaults)}});for(var a in e.options)if(e.options.hasOwnProperty(a)){var r=this.modifyOption(e,a,e.options[a]);typeof r<"u"&&(e.options[a]=r)}},getEventProperties:function(e,n){var o={};return _e.forEach(function(i){typeof i.eventProperties=="function"&&oe(o,i.eventProperties.call(n[i.pluginName],e))}),o},modifyOption:function(e,n,o){var i;return _e.forEach(function(a){e[a.pluginName]&&a.optionListeners&&typeof a.optionListeners[n]=="function"&&(i=a.optionListeners[n].call(e[a.pluginName],o))}),i}};function Nn(t){var e=t.sortable,n=t.rootEl,o=t.name,i=t.targetEl,a=t.cloneEl,r=t.toEl,l=t.fromEl,s=t.oldIndex,c=t.newIndex,u=t.oldDraggableIndex,d=t.newDraggableIndex,h=t.originalEvent,p=t.putSortable,g=t.extraEventProperties;if(e=e||n&&n[z],!!e){var b,k=e.options,q="on"+o.charAt(0).toUpperCase()+o.substr(1);window.CustomEvent&&!ie&&!$e?b=new CustomEvent(o,{bubbles:!0,cancelable:!0}):(b=document.createEvent("Event"),b.initEvent(o,!0,!0)),b.to=r||n,b.from=l||n,b.item=i||n,b.clone=a,b.oldIndex=s,b.newIndex=c,b.oldDraggableIndex=u,b.newDraggableIndex=d,b.originalEvent=h,b.pullMode=p?p.lastPutMode:void 0;var A=ee(ee({},g),ze.getEventProperties(o,e));for(var I in A)b[I]=A[I];n&&n.dispatchEvent(b),k[q]&&k[q].call(e,b)}}var xn=["evt"],$=function(e,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=o.evt,a=_n(o,xn);ze.pluginEvent.bind(m)(e,n,ee({dragEl:f,parentEl:x,ghostEl:v,rootEl:C,nextEl:ge,lastDownEl:Ve,cloneEl:D,cloneHidden:se,dragStarted:ke,putSortable:P,activeSortable:m.active,originalEvent:i,oldIndex:Te,oldDraggableIndex:Fe,newIndex:G,newDraggableIndex:le,hideGhostForTarget:ln,unhideGhostForTarget:sn,cloneNowHidden:function(){se=!0},cloneNowShown:function(){se=!1},dispatchSortableEvent:function(l){F({sortable:n,name:l,originalEvent:i})}},a))};function F(t){Nn(ee({putSortable:P,cloneEl:D,targetEl:f,rootEl:C,oldIndex:Te,oldDraggableIndex:Fe,newIndex:G,newDraggableIndex:le},t))}var f,x,v,C,ge,Ve,D,se,Te,G,Fe,le,Ge,P,we=!1,nt=!1,ot=[],he,Z,pt,gt,Xt,$t,ke,Ee,Ye,He=!1,We=!1,Je,M,yt=[],Tt=!1,it=[],dt=typeof document<"u",Qe=xt,zt=$e||ie?"cssFloat":"float",An=dt&&!Zt&&!xt&&"draggable"in document.createElement("div"),on=function(){if(dt){if(ie)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto",t.style.pointerEvents==="auto"}}(),an=function(e,n){var o=y(e),i=parseInt(o.width)-parseInt(o.paddingLeft)-parseInt(o.paddingRight)-parseInt(o.borderLeftWidth)-parseInt(o.borderRightWidth),a=Ne(e,0,n),r=Ne(e,1,n),l=a&&y(a),s=r&&y(r),c=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+B(a).width,u=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+B(r).width;if(o.display==="flex")return o.flexDirection==="column"||o.flexDirection==="column-reverse"?"vertical":"horizontal";if(o.display==="grid")return o.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(a&&l.float&&l.float!=="none"){var d=l.float==="left"?"left":"right";return r&&(s.clear==="both"||s.clear===d)?"vertical":"horizontal"}return a&&(l.display==="block"||l.display==="flex"||l.display==="table"||l.display==="grid"||c>=i&&o[zt]==="none"||r&&o[zt]==="none"&&c+u>i)?"vertical":"horizontal"},Ln=function(e,n,o){var i=o?e.left:e.top,a=o?e.right:e.bottom,r=o?e.width:e.height,l=o?n.left:n.top,s=o?n.right:n.bottom,c=o?n.width:n.height;return i===l||a===s||i+r/2===l+c/2},Bn=function(e,n){var o;return ot.some(function(i){var a=i[z].options.emptyInsertThreshold;if(!(!a||At(i))){var r=B(i),l=e>=r.left-a&&e<=r.right+a,s=n>=r.top-a&&n<=r.bottom+a;if(l&&s)return o=i}}),o},rn=function(e){function n(a,r){return function(l,s,c,u){var d=l.options.group.name&&s.options.group.name&&l.options.group.name===s.options.group.name;if(a==null&&(r||d))return!0;if(a==null||a===!1)return!1;if(r&&a==="clone")return a;if(typeof a=="function")return n(a(l,s,c,u),r)(l,s,c,u);var h=(r?l:s).options.group.name;return a===!0||typeof a=="string"&&a===h||a.join&&a.indexOf(h)>-1}}var o={},i=e.group;(!i||Ue(i)!="object")&&(i={name:i}),o.name=i.name,o.checkPull=n(i.pull,!0),o.checkPut=n(i.put),o.revertClone=i.revertClone,e.group=o},ln=function(){!on&&v&&y(v,"display","none")},sn=function(){!on&&v&&y(v,"display","")};dt&&!Zt&&document.addEventListener("click",function(t){if(nt)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),nt=!1,!1},!0);var me=function(e){if(f){e=e.touches?e.touches[0]:e;var n=Bn(e.clientX,e.clientY);if(n){var o={};for(var i in e)e.hasOwnProperty(i)&&(o[i]=e[i]);o.target=o.rootEl=n,o.preventDefault=void 0,o.stopPropagation=void 0,n[z]._onDragOver(o)}}},On=function(e){f&&f.parentNode[z]._isOutsideThisEl(e.target)};function m(t,e){if(!(t&&t.nodeType&&t.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=oe({},e),t[z]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return an(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(r,l){r.setData("Text",l.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:m.supportPointer!==!1&&"PointerEvent"in window&&(!Me||xt),emptyInsertThreshold:5};ze.initializePlugins(this,t,n);for(var o in n)!(o in e)&&(e[o]=n[o]);rn(e);for(var i in this)i.charAt(0)==="_"&&typeof this[i]=="function"&&(this[i]=this[i].bind(this));this.nativeDraggable=e.forceFallback?!1:An,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?E(t,"pointerdown",this._onTapStart):(E(t,"mousedown",this._onTapStart),E(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(E(t,"dragover",this),E(t,"dragenter",this)),ot.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),oe(this,In())}m.prototype={constructor:m,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(Ee=null)},_getDirection:function(e,n){return typeof this.options.direction=="function"?this.options.direction.call(this,e,n,f):this.options.direction},_onTapStart:function(e){if(e.cancelable){var n=this,o=this.el,i=this.options,a=i.preventOnFilter,r=e.type,l=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,s=(l||e).target,c=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||s,u=i.filter;if(Hn(o),!f&&!(/mousedown|pointerdown/.test(r)&&e.button!==0||i.disabled)&&!c.isContentEditable&&!(!this.nativeDraggable&&Me&&s&&s.tagName.toUpperCase()==="SELECT")&&(s=U(s,i.draggable,o,!1),!(s&&s.animated)&&Ve!==s)){if(Te=Q(s),Fe=Q(s,i.draggable),typeof u=="function"){if(u.call(this,e,s,this)){F({sortable:n,rootEl:c,name:"filter",targetEl:s,toEl:o,fromEl:o}),$("filter",n,{evt:e}),a&&e.preventDefault();return}}else if(u&&(u=u.split(",").some(function(d){if(d=U(c,d.trim(),o,!1),d)return F({sortable:n,rootEl:d,name:"filter",targetEl:s,fromEl:o,toEl:o}),$("filter",n,{evt:e}),!0}),u)){a&&e.preventDefault();return}i.handle&&!U(c,i.handle,o,!1)||this._prepareDragStart(e,l,s)}}},_prepareDragStart:function(e,n,o){var i=this,a=i.el,r=i.options,l=a.ownerDocument,s;if(o&&!f&&o.parentNode===a){var c=B(o);if(C=a,f=o,x=f.parentNode,ge=f.nextSibling,Ve=o,Ge=r.group,m.dragged=f,he={target:f,clientX:(n||e).clientX,clientY:(n||e).clientY},Xt=he.clientX-c.left,$t=he.clientY-c.top,this._lastX=(n||e).clientX,this._lastY=(n||e).clientY,f.style["will-change"]="all",s=function(){if($("delayEnded",i,{evt:e}),m.eventCanceled){i._onDrop();return}i._disableDelayedDragEvents(),!Rt&&i.nativeDraggable&&(f.draggable=!0),i._triggerDragStart(e,n),F({sortable:i,name:"choose",originalEvent:e}),j(f,r.chosenClass,!0)},r.ignore.split(",").forEach(function(u){Jt(f,u.trim(),vt)}),E(l,"dragover",me),E(l,"mousemove",me),E(l,"touchmove",me),r.supportPointer?(E(l,"pointerup",i._onDrop),!this.nativeDraggable&&E(l,"pointercancel",i._onDrop)):(E(l,"mouseup",i._onDrop),E(l,"touchend",i._onDrop),E(l,"touchcancel",i._onDrop)),Rt&&this.nativeDraggable&&(this.options.touchStartThreshold=4,f.draggable=!0),$("delayStart",this,{evt:e}),r.delay&&(!r.delayOnTouchOnly||n)&&(!this.nativeDraggable||!($e||ie))){if(m.eventCanceled){this._onDrop();return}r.supportPointer?(E(l,"pointerup",i._disableDelayedDrag),E(l,"pointercancel",i._disableDelayedDrag)):(E(l,"mouseup",i._disableDelayedDrag),E(l,"touchend",i._disableDelayedDrag),E(l,"touchcancel",i._disableDelayedDrag)),E(l,"mousemove",i._delayedDragTouchMoveHandler),E(l,"touchmove",i._delayedDragTouchMoveHandler),r.supportPointer&&E(l,"pointermove",i._delayedDragTouchMoveHandler),i._dragStartTimer=setTimeout(s,r.delay)}else s()}},_delayedDragTouchMoveHandler:function(e){var n=e.touches?e.touches[0]:e;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){f&&vt(f),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;_(e,"mouseup",this._disableDelayedDrag),_(e,"touchend",this._disableDelayedDrag),_(e,"touchcancel",this._disableDelayedDrag),_(e,"pointerup",this._disableDelayedDrag),_(e,"pointercancel",this._disableDelayedDrag),_(e,"mousemove",this._delayedDragTouchMoveHandler),_(e,"touchmove",this._delayedDragTouchMoveHandler),_(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,n){n=n||e.pointerType=="touch"&&e,!this.nativeDraggable||n?this.options.supportPointer?E(document,"pointermove",this._onTouchMove):n?E(document,"touchmove",this._onTouchMove):E(document,"mousemove",this._onTouchMove):(E(f,"dragend",this),E(C,"dragstart",this._onDragStart));try{document.selection?Ke(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,n){if(we=!1,C&&f){$("dragStarted",this,{evt:n}),this.nativeDraggable&&E(document,"dragover",On);var o=this.options;!e&&j(f,o.dragClass,!1),j(f,o.ghostClass,!0),m.active=this,e&&this._appendGhost(),F({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(Z){this._lastX=Z.clientX,this._lastY=Z.clientY,ln();for(var e=document.elementFromPoint(Z.clientX,Z.clientY),n=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(Z.clientX,Z.clientY),e!==n);)n=e;if(f.parentNode[z]._isOutsideThisEl(e),n)do{if(n[z]){var o=void 0;if(o=n[z]._onDragOver({clientX:Z.clientX,clientY:Z.clientY,target:e,rootEl:n}),o&&!this.options.dragoverBubble)break}e=n}while(n=Vt(n));sn()}},_onTouchMove:function(e){if(he){var n=this.options,o=n.fallbackTolerance,i=n.fallbackOffset,a=e.touches?e.touches[0]:e,r=v&&Ce(v,!0),l=v&&r&&r.a,s=v&&r&&r.d,c=Qe&&M&&Ht(M),u=(a.clientX-he.clientX+i.x)/(l||1)+(c?c[0]-yt[0]:0)/(l||1),d=(a.clientY-he.clientY+i.y)/(s||1)+(c?c[1]-yt[1]:0)/(s||1);if(!m.active&&!we){if(o&&Math.max(Math.abs(a.clientX-this._lastX),Math.abs(a.clientY-this._lastY))<o)return;this._onDragStart(e,!0)}if(v){r?(r.e+=u-(pt||0),r.f+=d-(gt||0)):r={a:1,b:0,c:0,d:1,e:u,f:d};var h="matrix(".concat(r.a,",").concat(r.b,",").concat(r.c,",").concat(r.d,",").concat(r.e,",").concat(r.f,")");y(v,"webkitTransform",h),y(v,"mozTransform",h),y(v,"msTransform",h),y(v,"transform",h),pt=u,gt=d,Z=a}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!v){var e=this.options.fallbackOnBody?document.body:C,n=B(f,!0,Qe,!0,e),o=this.options;if(Qe){for(M=e;y(M,"position")==="static"&&y(M,"transform")==="none"&&M!==document;)M=M.parentNode;M!==document.body&&M!==document.documentElement?(M===document&&(M=K()),n.top+=M.scrollTop,n.left+=M.scrollLeft):M=K(),yt=Ht(M)}v=f.cloneNode(!0),j(v,o.ghostClass,!1),j(v,o.fallbackClass,!0),j(v,o.dragClass,!0),y(v,"transition",""),y(v,"transform",""),y(v,"box-sizing","border-box"),y(v,"margin",0),y(v,"top",n.top),y(v,"left",n.left),y(v,"width",n.width),y(v,"height",n.height),y(v,"opacity","0.8"),y(v,"position",Qe?"absolute":"fixed"),y(v,"zIndex","100000"),y(v,"pointerEvents","none"),m.ghost=v,e.appendChild(v),y(v,"transform-origin",Xt/parseInt(v.style.width)*100+"% "+$t/parseInt(v.style.height)*100+"%")}},_onDragStart:function(e,n){var o=this,i=e.dataTransfer,a=o.options;if($("dragStart",this,{evt:e}),m.eventCanceled){this._onDrop();return}$("setupClone",this),m.eventCanceled||(D=tn(f),D.removeAttribute("id"),D.draggable=!1,D.style["will-change"]="",this._hideClone(),j(D,this.options.chosenClass,!1),m.clone=D),o.cloneId=Ke(function(){$("clone",o),!m.eventCanceled&&(o.options.removeCloneOnHide||C.insertBefore(D,f),o._hideClone(),F({sortable:o,name:"clone"}))}),!n&&j(f,a.dragClass,!0),n?(nt=!0,o._loopId=setInterval(o._emulateDragOver,50)):(_(document,"mouseup",o._onDrop),_(document,"touchend",o._onDrop),_(document,"touchcancel",o._onDrop),i&&(i.effectAllowed="move",a.setData&&a.setData.call(o,i,f)),E(document,"drop",o),y(f,"transform","translateZ(0)")),we=!0,o._dragStartId=Ke(o._dragStarted.bind(o,n,e)),E(document,"selectstart",o),ke=!0,window.getSelection().removeAllRanges(),Me&&y(document.body,"user-select","none")},_onDragOver:function(e){var n=this.el,o=e.target,i,a,r,l=this.options,s=l.group,c=m.active,u=Ge===s,d=l.sort,h=P||c,p,g=this,b=!1;if(Tt)return;function k(Oe,gn){$(Oe,g,ee({evt:e,isOwner:u,axis:p?"vertical":"horizontal",revert:r,dragRect:i,targetRect:a,canSort:d,fromSortable:h,target:o,completed:A,onMove:function(qt,yn){return Ze(C,n,f,i,qt,B(qt),e,yn)},changed:I},gn))}function q(){k("dragOverAnimationCapture"),g.captureAnimationState(),g!==h&&h.captureAnimationState()}function A(Oe){return k("dragOverCompleted",{insertion:Oe}),Oe&&(u?c._hideClone():c._showClone(g),g!==h&&(j(f,P?P.options.ghostClass:c.options.ghostClass,!1),j(f,l.ghostClass,!0)),P!==g&&g!==m.active?P=g:g===m.active&&P&&(P=null),h===g&&(g._ignoreWhileAnimating=o),g.animateAll(function(){k("dragOverAnimationComplete"),g._ignoreWhileAnimating=null}),g!==h&&(h.animateAll(),h._ignoreWhileAnimating=null)),(o===f&&!f.animated||o===n&&!o.animated)&&(Ee=null),!l.dragoverBubble&&!e.rootEl&&o!==document&&(f.parentNode[z]._isOutsideThisEl(e.target),!Oe&&me(e)),!l.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),b=!0}function I(){G=Q(f),le=Q(f,l.draggable),F({sortable:g,name:"change",toEl:n,newIndex:G,newDraggableIndex:le,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),o=U(o,l.draggable,n,!0),k("dragOver"),m.eventCanceled)return b;if(f.contains(e.target)||o.animated&&o.animatingX&&o.animatingY||g._ignoreWhileAnimating===o)return A(!1);if(nt=!1,c&&!l.disabled&&(u?d||(r=x!==C):P===this||(this.lastPutMode=Ge.checkPull(this,c,f,e))&&s.checkPut(this,c,f,e))){if(p=this._getDirection(e,o)==="vertical",i=B(f),k("dragOverValid"),m.eventCanceled)return b;if(r)return x=C,q(),this._hideClone(),k("revert"),m.eventCanceled||(ge?C.insertBefore(f,ge):C.appendChild(f)),A(!0);var w=At(n,l.draggable);if(!w||Mn(e,p,this)&&!w.animated){if(w===f)return A(!1);if(w&&n===e.target&&(o=w),o&&(a=B(o)),Ze(C,n,f,i,o,a,e,!!o)!==!1)return q(),w&&w.nextSibling?n.insertBefore(f,w.nextSibling):n.appendChild(f),x=n,I(),A(!0)}else if(w&&qn(e,p,this)){var N=Ne(n,0,l,!0);if(N===f)return A(!1);if(o=N,a=B(o),Ze(C,n,f,i,o,a,e,!1)!==!1)return q(),n.insertBefore(f,N),x=n,I(),A(!0)}else if(o.parentNode===n){a=B(o);var X=0,W,de=f.parentNode!==n,R=!Ln(f.animated&&f.toRect||i,o.animated&&o.toRect||a,p),Ae=p?"top":"left",ae=Yt(o,"top","top")||Yt(f,"top","top"),Le=ae?ae.scrollTop:void 0;Ee!==o&&(W=a[Ae],He=!1,We=!R&&l.invertSwap||de),X=Rn(e,o,a,p,R?1:l.swapThreshold,l.invertedSwapThreshold==null?l.swapThreshold:l.invertedSwapThreshold,We,Ee===o);var te;if(X!==0){var fe=Q(f);do fe-=X,te=x.children[fe];while(te&&(y(te,"display")==="none"||te===v))}if(X===0||te===o)return A(!1);Ee=o,Ye=X;var Be=o.nextElementSibling,re=!1;re=X===1;var je=Ze(C,n,f,i,o,a,e,re);if(je!==!1)return(je===1||je===-1)&&(re=je===1),Tt=!0,setTimeout(Pn,30),q(),re&&!Be?n.appendChild(f):o.parentNode.insertBefore(f,re?Be:o),ae&&en(ae,0,Le-ae.scrollTop),x=f.parentNode,W!==void 0&&!We&&(Je=Math.abs(W-B(o)[Ae])),I(),A(!0)}if(n.contains(f))return A(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){_(document,"mousemove",this._onTouchMove),_(document,"touchmove",this._onTouchMove),_(document,"pointermove",this._onTouchMove),_(document,"dragover",me),_(document,"mousemove",me),_(document,"touchmove",me)},_offUpEvents:function(){var e=this.el.ownerDocument;_(e,"mouseup",this._onDrop),_(e,"touchend",this._onDrop),_(e,"pointerup",this._onDrop),_(e,"pointercancel",this._onDrop),_(e,"touchcancel",this._onDrop),_(document,"selectstart",this)},_onDrop:function(e){var n=this.el,o=this.options;if(G=Q(f),le=Q(f,o.draggable),$("drop",this,{evt:e}),x=f&&f.parentNode,G=Q(f),le=Q(f,o.draggable),m.eventCanceled){this._nulling();return}we=!1,We=!1,He=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),It(this.cloneId),It(this._dragStartId),this.nativeDraggable&&(_(document,"drop",this),_(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Me&&y(document.body,"user-select",""),y(f,"transform",""),e&&(ke&&(e.cancelable&&e.preventDefault(),!o.dropBubble&&e.stopPropagation()),v&&v.parentNode&&v.parentNode.removeChild(v),(C===x||P&&P.lastPutMode!=="clone")&&D&&D.parentNode&&D.parentNode.removeChild(D),f&&(this.nativeDraggable&&_(f,"dragend",this),vt(f),f.style["will-change"]="",ke&&!we&&j(f,P?P.options.ghostClass:this.options.ghostClass,!1),j(f,this.options.chosenClass,!1),F({sortable:this,name:"unchoose",toEl:x,newIndex:null,newDraggableIndex:null,originalEvent:e}),C!==x?(G>=0&&(F({rootEl:x,name:"add",toEl:x,fromEl:C,originalEvent:e}),F({sortable:this,name:"remove",toEl:x,originalEvent:e}),F({rootEl:x,name:"sort",toEl:x,fromEl:C,originalEvent:e}),F({sortable:this,name:"sort",toEl:x,originalEvent:e})),P&&P.save()):G!==Te&&G>=0&&(F({sortable:this,name:"update",toEl:x,originalEvent:e}),F({sortable:this,name:"sort",toEl:x,originalEvent:e})),m.active&&((G==null||G===-1)&&(G=Te,le=Fe),F({sortable:this,name:"end",toEl:x,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){$("nulling",this),C=f=x=v=ge=D=Ve=se=he=Z=ke=G=le=Te=Fe=Ee=Ye=P=Ge=m.dragged=m.ghost=m.clone=m.active=null,it.forEach(function(e){e.checked=!0}),it.length=pt=gt=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":f&&(this._onDragOver(e),kn(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],n,o=this.el.children,i=0,a=o.length,r=this.options;i<a;i++)n=o[i],U(n,r.draggable,this.el,!1)&&e.push(n.getAttribute(r.dataIdAttr)||Yn(n));return e},sort:function(e,n){var o={},i=this.el;this.toArray().forEach(function(a,r){var l=i.children[r];U(l,this.options.draggable,i,!1)&&(o[a]=l)},this),n&&this.captureAnimationState(),e.forEach(function(a){o[a]&&(i.removeChild(o[a]),i.appendChild(o[a]))}),n&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,n){return U(e,n||this.options.draggable,this.el,!1)},option:function(e,n){var o=this.options;if(n===void 0)return o[e];var i=ze.modifyOption(this,e,n);typeof i<"u"?o[e]=i:o[e]=n,e==="group"&&rn(o)},destroy:function(){$("destroy",this);var e=this.el;e[z]=null,_(e,"mousedown",this._onTapStart),_(e,"touchstart",this._onTapStart),_(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(_(e,"dragover",this),_(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),ot.splice(ot.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!se){if($("hideClone",this),m.eventCanceled)return;y(D,"display","none"),this.options.removeCloneOnHide&&D.parentNode&&D.parentNode.removeChild(D),se=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(se){if($("showClone",this),m.eventCanceled)return;f.parentNode==C&&!this.options.group.revertClone?C.insertBefore(D,f):ge?C.insertBefore(D,ge):C.appendChild(D),this.options.group.revertClone&&this.animate(f,D),y(D,"display",""),se=!1}}};function kn(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault()}function Ze(t,e,n,o,i,a,r,l){var s,c=t[z],u=c.options.onMove,d;return window.CustomEvent&&!ie&&!$e?s=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(s=document.createEvent("Event"),s.initEvent("move",!0,!0)),s.to=e,s.from=t,s.dragged=n,s.draggedRect=o,s.related=i||e,s.relatedRect=a||B(e),s.willInsertAfter=l,s.originalEvent=r,t.dispatchEvent(s),u&&(d=u.call(c,s,r)),d}function vt(t){t.draggable=!1}function Pn(){Tt=!1}function qn(t,e,n){var o=B(Ne(n.el,0,n.options,!0)),i=nn(n.el,n.options,v),a=10;return e?t.clientX<i.left-a||t.clientY<o.top&&t.clientX<o.right:t.clientY<i.top-a||t.clientY<o.bottom&&t.clientX<o.left}function Mn(t,e,n){var o=B(At(n.el,n.options.draggable)),i=nn(n.el,n.options,v),a=10;return e?t.clientX>i.right+a||t.clientY>o.bottom&&t.clientX>o.left:t.clientY>i.bottom+a||t.clientX>o.right&&t.clientY>o.top}function Rn(t,e,n,o,i,a,r,l){var s=o?t.clientY:t.clientX,c=o?n.height:n.width,u=o?n.top:n.left,d=o?n.bottom:n.right,h=!1;if(!r){if(l&&Je<c*i){if(!He&&(Ye===1?s>u+c*a/2:s<d-c*a/2)&&(He=!0),He)h=!0;else if(Ye===1?s<u+Je:s>d-Je)return-Ye}else if(s>u+c*(1-i)/2&&s<d-c*(1-i)/2)return Fn(e)}return h=h||r,h&&(s<u+c*a/2||s>d-c*a/2)?s>u+c/2?1:-1:0}function Fn(t){return Q(f)<Q(t)?1:-1}function Yn(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,o=0;n--;)o+=e.charCodeAt(n);return o.toString(36)}function Hn(t){it.length=0;for(var e=t.getElementsByTagName("input"),n=e.length;n--;){var o=e[n];o.checked&&it.push(o)}}function Ke(t){return setTimeout(t,0)}function It(t){return clearTimeout(t)}dt&&E(document,"touchmove",function(t){(m.active||we)&&t.cancelable&&t.preventDefault()});m.utils={on:E,off:_,css:y,find:Jt,is:function(e,n){return!!U(e,n,e,!1)},extend:Sn,throttle:Kt,closest:U,toggleClass:j,clone:tn,index:Q,nextTick:Ke,cancelNextTick:It,detectDirection:an,getChild:Ne,expando:z};m.get=function(t){return t[z]};m.mount=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e[0].constructor===Array&&(e=e[0]),e.forEach(function(o){if(!o.prototype||!o.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(o));o.utils&&(m.utils=ee(ee({},m.utils),o.utils)),ze.mount(o)})};m.create=function(t,e){return new m(t,e)};m.version=En;var L=[],Pe,Ct,Dt=!1,bt,_t,at,qe;function Xn(){function t(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return t.prototype={dragStarted:function(n){var o=n.originalEvent;this.sortable.nativeDraggable?E(document,"dragover",this._handleAutoScroll):this.options.supportPointer?E(document,"pointermove",this._handleFallbackAutoScroll):o.touches?E(document,"touchmove",this._handleFallbackAutoScroll):E(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var o=n.originalEvent;!this.options.dragOverBubble&&!o.rootEl&&this._handleAutoScroll(o)},drop:function(){this.sortable.nativeDraggable?_(document,"dragover",this._handleAutoScroll):(_(document,"pointermove",this._handleFallbackAutoScroll),_(document,"touchmove",this._handleFallbackAutoScroll),_(document,"mousemove",this._handleFallbackAutoScroll)),jt(),et(),Tn()},nulling:function(){at=Ct=Pe=Dt=qe=bt=_t=null,L.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,o){var i=this,a=(n.touches?n.touches[0]:n).clientX,r=(n.touches?n.touches[0]:n).clientY,l=document.elementFromPoint(a,r);if(at=n,o||this.options.forceAutoScrollFallback||$e||ie||Me){Et(n,this.options,l,o);var s=ce(l,!0);Dt&&(!qe||a!==bt||r!==_t)&&(qe&&jt(),qe=setInterval(function(){var c=ce(document.elementFromPoint(a,r),!0);c!==s&&(s=c,et()),Et(n,i.options,c,o)},10),bt=a,_t=r)}else{if(!this.options.bubbleScroll||ce(l,!0)===K()){et();return}Et(n,this.options,ce(l,!1),!1)}}},oe(t,{pluginName:"scroll",initializeByDefault:!0})}function et(){L.forEach(function(t){clearInterval(t.pid)}),L=[]}function jt(){clearInterval(qe)}var Et=Kt(function(t,e,n,o){if(e.scroll){var i=(t.touches?t.touches[0]:t).clientX,a=(t.touches?t.touches[0]:t).clientY,r=e.scrollSensitivity,l=e.scrollSpeed,s=K(),c=!1,u;Ct!==n&&(Ct=n,et(),Pe=e.scroll,u=e.scrollFn,Pe===!0&&(Pe=ce(n,!0)));var d=0,h=Pe;do{var p=h,g=B(p),b=g.top,k=g.bottom,q=g.left,A=g.right,I=g.width,w=g.height,N=void 0,X=void 0,W=p.scrollWidth,de=p.scrollHeight,R=y(p),Ae=p.scrollLeft,ae=p.scrollTop;p===s?(N=I<W&&(R.overflowX==="auto"||R.overflowX==="scroll"||R.overflowX==="visible"),X=w<de&&(R.overflowY==="auto"||R.overflowY==="scroll"||R.overflowY==="visible")):(N=I<W&&(R.overflowX==="auto"||R.overflowX==="scroll"),X=w<de&&(R.overflowY==="auto"||R.overflowY==="scroll"));var Le=N&&(Math.abs(A-i)<=r&&Ae+I<W)-(Math.abs(q-i)<=r&&!!Ae),te=X&&(Math.abs(k-a)<=r&&ae+w<de)-(Math.abs(b-a)<=r&&!!ae);if(!L[d])for(var fe=0;fe<=d;fe++)L[fe]||(L[fe]={});(L[d].vx!=Le||L[d].vy!=te||L[d].el!==p)&&(L[d].el=p,L[d].vx=Le,L[d].vy=te,clearInterval(L[d].pid),(Le!=0||te!=0)&&(c=!0,L[d].pid=setInterval((function(){o&&this.layer===0&&m.active._onTouchMove(at);var Be=L[this.layer].vy?L[this.layer].vy*l:0,re=L[this.layer].vx?L[this.layer].vx*l:0;typeof u=="function"&&u.call(m.dragged.parentNode[z],re,Be,t,at,L[this.layer].el)!=="continue"||en(L[this.layer].el,re,Be)}).bind({layer:d}),24))),d++}while(e.bubbleScroll&&h!==s&&(h=ce(h,!1)));Dt=c}},30),cn=function(e){var n=e.originalEvent,o=e.putSortable,i=e.dragEl,a=e.activeSortable,r=e.dispatchSortableEvent,l=e.hideGhostForTarget,s=e.unhideGhostForTarget;if(n){var c=o||a;l();var u=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,d=document.elementFromPoint(u.clientX,u.clientY);s(),c&&!c.el.contains(d)&&(r("spill"),this.onSpill({dragEl:i,putSortable:o}))}};function Lt(){}Lt.prototype={startIndex:null,dragStart:function(e){var n=e.oldDraggableIndex;this.startIndex=n},onSpill:function(e){var n=e.dragEl,o=e.putSortable;this.sortable.captureAnimationState(),o&&o.captureAnimationState();var i=Ne(this.sortable.el,this.startIndex,this.options);i?this.sortable.el.insertBefore(n,i):this.sortable.el.appendChild(n),this.sortable.animateAll(),o&&o.animateAll()},drop:cn};oe(Lt,{pluginName:"revertOnSpill"});function Bt(){}Bt.prototype={onSpill:function(e){var n=e.dragEl,o=e.putSortable,i=o||this.sortable;i.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),i.animateAll()},drop:cn};oe(Bt,{pluginName:"removeOnSpill"});m.mount(new Xn);m.mount(Bt,Lt);function ft(t,e,n,o,i,a,r,l,s,c){this.x_columns=t,this.x_data=e,this.y_columns=n,this.y_data=o,this.z_columns=i,this.z_data=a,this.series_dict=l,this.table_name=s,this.worksheet_name=c,this.selected_cord=[0,0],this.area_cordinates=[1,1,1,1],this.cell_grid=[],this.x_list=[],this.y_list=[],this.pivot_data=r,this.row_len=r.length,this.col_len=r[0].length,this.tbl=document.createElement("table"),this.tbl.classList.add("scc_core")}ft.prototype.populateTable=function(){const t=document.createElement("thead"),e=document.createElement("tbody"),n=this.x_data.length,o=this.y_data[0].length,i=this.pivot_data.length+n,a=this.pivot_data[0].length+o;for(let l=0;l<i;l++){const s=document.createElement("tr");for(let c=0;c<a;c++){const[u,d]=[l-n+1,c-o+1];var r=document.createElement("th");if(c<o&&l<n)l===0?r.textContent=this.y_columns[c]:r.textContent="",r.classList.add("STX",`R${l}C${c}`);else if(c<o)r.textContent=this.y_data[l-n][c],r.classList.add("STX",`C${c}`);else if(l<n)r.textContent=this.x_data[l][c-o],r.classList.add("STX",`R${l}`);else{var r=document.createElement("td");r.textContent=this.pivot_data[l-n][c-o]}u>=0&&d>=0&&(r.setAttribute("x-data",u),r.setAttribute("y-data",d)),s.appendChild(r)}l<n?t.appendChild(s):e.appendChild(s)}return this.tbl.appendChild(t),this.tbl.appendChild(e),this.mergeSpan(),this.tbl};ft.prototype.mergeSpan=function(){const t=this.x_data.length,e=this.y_data[0].length,n=this.pivot_data.length+t,o=this.pivot_data[0].length+e;if(t>0)for(let i=0;i<t;i++)for(let a=0;a<e;a++)i===0&&this.tbl.rows[0].cells[a].setAttribute("rowspan",t),this.tbl.rows[i].setAttribute("this_delete","true");for(let i=0;i<t-1;i++)for(let a=e;a<o;a++){let r=1;for(let l=a+1;l<o&&this.tbl.rows[i].cells[l].textContent===this.tbl.rows[i].cells[a].textContent;l++)r++,this.tbl.rows[i].cells[l].setAttribute("this_delete","true");this.tbl.rows[i].cells[a].setAttribute("colspan",r)}for(let i=t;i<n;i++)for(let a=0;a<e-1;a++){let r=1;for(let l=i+1;l<n&&this.tbl.rows[l].cells[a].textContent===this.tbl.rows[i].cells[a].textContent;l++)r++,this.tbl.rows[l].cells[a].setAttribute("this_delete","true");this.tbl.rows[i].cells[a].setAttribute("rowspan",r)}for(let i=0;i<n;i++)for(let a=0;a<o;a++)(i<t||a<e)&&this.tbl.rows[i].cells[a]&&this.tbl.rows[i].cells[a].getAttribute("this_delete")==="true"&&(this.tbl.rows[i].deleteCell(a),a--)};let ye=[],ve=[],Se=[],be="",Ot=[],De={};const Nt="another_wk",$n=new URLSearchParams(window.location.search),xe=$n.get("modelName"),zn=async(t,e,n,o,i,a)=>{const r=`TW_${a}`,l=`DROP TABLE IF EXISTS [${r}]`,s=[...t,...e,...n],c=s.indexOf("Series");c!==-1&&s.splice(c,1);var u=`CREATE TABLE [${r}] AS SELECT [${s.join("], [")}] `;for(let d in o){let h=o[d].Agg||"sum";u+=`, ${h}([${d}]) AS [${d}] `}u+=` FROM [${i}] GROUP BY [${s.join("], [")}]`,await H("executeQuery",xe,l),await H("executeQuery",xe,u)},jn=async(t,e)=>{let n=document.getElementById("ZLayoutContentDiv").querySelector("select");if(e.length>0){const o=`SELECT DISTINCT [${e.join("], [")}] FROM [${t}]`,i=await H("fetchData",xe,o);for(const a of i)for(const r of a)n.appendChild(Qn(r,r))}};async function Gn(t,e,n){let o=document.getElementById("zContent");if(o.style.display="none",sessionStorage.qr_name&&n.length>0){o.style.display="";{let i=document.getElementById("ZLayoutContentDiv");i.innerHTML="";let a=[...t,...e];for(let r of n)a.indexOf(r)===-1&&i.appendChild(Wn(r))}}}function Wn(t){let e=S("div","form-group mb-0 ps-2 z_el",null,S("select","form-control form-select py-1 pe-4 moduleForm-feild"));return e.setAttribute("level_name",t),e.style.maxWidth="240px",e}function Qn(t,e){let n=S("option",null,null,document.createTextNode(e));return n.setAttribute("value",t),n}const un=async(t,e,n,o,i,a,r)=>{let l=!1,s=[...e],c=[...n],u=s.indexOf("Series");if(u!==-1)s.splice(u,1);else if(u=c.indexOf("Series"),u!==-1)c.splice(u,1),l=!0,[s,c]=[c,s];else return console.error("Series not part of x_columns or y_columns"),[[],[],[]];let d=[];if(s.length>0){const I=`SELECT DISTINCT [${s.join("], [")}] FROM [${t}]`,w=await H("fetchData",xe,I);for(const N of w)for(const X of a){const W=[...N];W.splice(u,0,X),d.push(W)}}else d.push([...a]);let h=`SELECT [${c.join("], [")}]`,p=d[0].map((I,w)=>d.map(N=>N[w]));for(const I of d){const w=[...I],N=w[u],X=r[N]&&r[N].Agg||"sum",W=`[${w.join(", ")}]`;w.splice(u,1),h+=`, ${X}([${N}]) FILTER (WHERE 1=1`,w.forEach((de,R)=>{h+=` AND [${s[R]}] = '${de}'`}),h+=`) AS ${W}`}let g="";o&&o.length>0&&(g=`WHERE ${o.map((w,N)=>`[${w}] = '${i}'`).join(" AND ")}`),h+=` FROM [${t}] ${g} GROUP BY [${c.join("], [")}]`;const b=await H("fetchData",xe,h),k=c.length;let q=b.map(I=>I.slice(0,k)),A=b.map(I=>I.slice(k));return l&&(A=A[0].map((I,w)=>A.map(N=>N[w])),[q,p]=[p,q],q=q[0].map((I,w)=>q.map(N=>N[w])),p=p[0].map((I,w)=>p.map(N=>N[w]))),[p,q,A]},Zn=async()=>{const e=await H("fetchData",xe,"SELECT TableName, Layout, Series, SeriesProperties FROM S_Queries WHERE Name = ?",[sessionStorage.qr_name]);if(e.length===0){T("Alert!","No data found.");return}const[n,o,i,a]=e[0],r=JSON.parse(o),l=r.layoutX||[],s=r.layoutY||[],c=r.layoutZ||[];be=n,ye=l,ve=s,Se=c,Ot=JSON.parse(i),De=JSON.parse(a)},dn=function(){let t=S("div","h-100 w-100 d-flex justify-content-center align-items-center"),e=`<button class="btn btn-primary h-25 btn-lg" type="button" disabled>
                    <span class="spinner-grow spinner-grow-lg" role="status" aria-hidden="true"></span>
                    Loading...
                </button>`;return t.innerHTML=e,t};async function kt(){const t=document.getElementById("table_container");t.innerHTML="",t.appendChild(dn());try{await Zn(),await Gn(ye,ve,Se),await jn(be,Se),await zn(ye,ve,Se,De,be,Nt);let e=document.getElementById("ZLayoutContentDiv").querySelector("select").value;const[n,o,i]=await un(be,ye,ve,Se,e,Ot,De),r=new ft(ye,n,ve,o,Se,[],i,De,be,Nt).populateTable();t.innerHTML="",t.appendChild(r)}catch(e){console.log("Error","Error loading data.",e)}}async function Pt(t){const e=document.getElementById("table_container");e.innerHTML="",e.appendChild(dn());let n=document.getElementById("ZLayoutContentDiv").querySelector("select").value;const[o,i,a]=await un(be,ye,ve,[t],n,Ot,De),l=new ft(ye,o,ve,i,[t],[],a,De,be,Nt).populateTable();e.innerHTML="",e.appendChild(l)}const Un=new URLSearchParams(window.location.search),ue=Un.get("modelName");let O=new Object;const Vn=["layoutX","layoutY","layoutZ"];var Gt,Jn=300;let V=[],J=[],Y={layoutX:[],layoutY:[],layoutZ:[]},Xe="";window.onload=async function(){let t=await H("init");if(!t||t.msg!=="Success"){T("Alert!","Some error occurred while initializing SQLite.");return}if(oo(),await Kn(),document.getElementById("addAllAggregation").onclick=Wt.bind(null,"availableLevel","selectedLevel","addAll"),document.getElementById("removeAllAggregation").onclick=Wt.bind(null,"selectedLevel","availableLevel","removeAll"),document.getElementById("searchQuery").onkeyup=pn,document.getElementById("aggregation-new").addEventListener("shown.bs.tab",async function(){const n=document.getElementById("queryNm").value,o=document.getElementById("tableNm").value;if(n===""){T("Alert!","Please enter a name for the query.");return}if(o===""){T("Alert!","Please select a table name.");return}document.getElementById("tableNm").disabled||await hn()}),document.getElementById("series-new").addEventListener("shown.bs.tab",async function(){const n=document.getElementById("queryNm").value,o=document.getElementById("tableNm").value;if(n===""){T("Alert!","Please enter a name for the query.");return}if(o===""){T("Alert!","Please select a table name.");return}await mn()}),document.getElementById("layout-new").addEventListener("shown.bs.tab",async function(){const n=document.getElementById("queryNm").value,o=document.getElementById("tableNm").value;if(n===""){T("Alert!","Please enter a name for the query.");return}if(o===""){T("Alert!","Please select a table name.");return}document.getElementById("layoutY").innerHTML="";for(let i of Y.layoutY){let a=S("li",null,null,S("span","fas fa-columns"));a.appendChild(document.createTextNode(i)),a.value=i,document.getElementById("layoutY").appendChild(a)}}),document.getElementById("editQueryBtn").onclick=async function(n){if(Xe=n.target.innerText.trim().toLowerCase(),!sessionStorage.qr_name){T("Alert!","No Selected queries found.");return}await rt(),await lt();const o={edit:"display-new"};o[Xe]&&new pe(document.getElementById(o[Xe])).show(),new ut(document.getElementById("modal-select-column")).show()},sessionStorage.qr_name)await rt();else{T("Alert!","First create a new Query Sheet.");return}await lt(),await kt();const e=document.querySelector("#ZLayoutContentDiv select");e&&e.addEventListener("change",function(){const n=this.closest(".z_el").getAttribute("level_name");Pt(n)})};async function Kn(){let e=await H("fetchData",ue,"SELECT TableName FROM S_TableGroup WHERE Table_Status = 'Active'");const n=document.getElementById("tableNm");for(let o of e){const i=S("option",null,null,document.createTextNode(o));i.setAttribute("value",o),n.appendChild(i)}}document.getElementById("modal-select-column").addEventListener("show.bs.modal",function(t){const e=t.relatedTarget;if(e){let n;e.classList.contains("navIocn")?n=e.getAttribute("title").trim().toLowerCase():n=e.innerText.trim().toLowerCase(),n=="display"?new pe(document.getElementById("display-new")).show():n=="series"?new pe(document.getElementById("series-new")).show():n=="aggregation"?new pe(document.getElementById("aggregation-new")).show():n=="layout"?new pe(document.getElementById("layout-new")).show():n=="new"?(new pe(document.getElementById("display-new")).show(),fn()):n=="save as"&&(new pe(document.getElementById("display-new")).show(),document.getElementById("queryNm").value="",document.getElementById("queryNm").disabled=!1,document.getElementById("tableNm").value="")}});function fn(){document.getElementById("queryNm").value="",document.getElementById("queryNm").disabled=!1,document.getElementById("tableNm").value="",document.getElementById("tableNm").disabled=!1,document.getElementById("showSummary").checked=!0,document.getElementById("graphTypeNew").value="TabularData",document.getElementById("availableLevel").innerHTML="",document.getElementById("selectedLevel").innerHTML="";const t=document.querySelector("#advTable tbody");t&&(t.innerHTML=""),V=[],J=[],Y={layoutX:[],layoutY:[],layoutZ:[]};for(let n of Vn)document.getElementById(n).innerHTML="";let e=S("li",null,null,S("span","fas fa-columns"));e.appendChild(document.createTextNode("Series")),e.value="series",document.getElementById("layoutX").appendChild(e)}async function rt(){let t=["Name","TableName","ShowSummary","HideNullRows","GraphType","SeriesProperties","Series","Layout","Levels"],e=["SeriesProperties","Series","Layout","Levels"],n=`SELECT ${t.join(", ")} FROM S_Queries WHERE Name = ?`,o=await H("fetchData",ue,n,[sessionStorage.qr_name]);o.length!==0&&(t.forEach((i,a)=>{O[i]=o[0][a]}),e.forEach(i=>{try{O[i]=JSON.parse(O[i])}catch{console.warn(`Failed to parse ${i}:`,O[i])}}))}async function lt(){if(Object.keys(O).length!=0){document.getElementById("queryNm").value=O.Name,document.getElementById("queryNm").disabled=!0,document.getElementById("tableNm").disabled=!0,document.getElementById("tableNm").value=O.TableName,O.ShowSummary==1?document.getElementById("showSummary").checked=!0:document.getElementById("showSummary").checked=!1,O.hideNullRows==1?document.getElementById("hideNullRows").checked=!0:document.getElementById("hideNullRows").checked=!1,document.getElementById("layoutX").innerHTML="",document.getElementById("layoutY").innerHTML="",document.getElementById("layoutZ").innerHTML="";for(let t of O.Layout.layoutX){let e=S("li",null,null,S("span","fas fa-columns"));e.appendChild(document.createTextNode(t)),e.value=t,document.getElementById("layoutX").appendChild(e)}for(let t of O.Layout.layoutY){let e=S("li",null,null,S("span","fas fa-columns"));e.appendChild(document.createTextNode(t)),e.value=t,document.getElementById("layoutY").appendChild(e)}for(let t of O.Layout.layoutZ){let e=S("li",null,null,S("span","fas fa-columns"));e.appendChild(document.createTextNode(t)),e.value=t,document.getElementById("layoutZ").appendChild(e)}document.getElementById("graphTypeNew").value=O.GraphType,J=O.Series,V=O.Levels,O.SeriesProperties,Y=O.Layout,await hn(),await mn()}}async function hn(){const t=document.getElementById("queryNm").value,e=document.getElementById("tableNm").value;if(t===""){T("Alert!","Please enter a name for the query.");return}if(e===""){T("Alert!","Please select a table name.");return}try{const n=`PRAGMA table_info(${e});`,o=await H("fetchData",ue,n),{numericColumns:i,stringColumns:a}=eo(o);await to(i,a)}catch(n){console.error("Error executing query:",n),T("Error",n)}}async function mn(){const t=document.getElementById("advTable");let e=t.querySelector("tbody");e?e.innerHTML="":(e=S("tbody"),t.appendChild(e));const n=document.getElementById("availableLevel");for(let o of n.childNodes)if(o.childNodes[0].checked&&o.nodeType===Node.ELEMENT_NODE){const i=o.innerText;no(i,"0,0.00",e)}}function eo(t){const e=t.map(r=>{const[l,s,c]=r;return{column:s,type:c.toUpperCase()}}),n=["INTEGER","REAL","NUMERIC","FLOAT","DOUBLE","DECIMAL"],o=["TEXT","VARCHAR","CHAR","BLOB"],i=e.filter(r=>n.includes(r.type)).map(r=>r.column),a=e.filter(r=>o.includes(r.type)).map(r=>r.column);return{numericColumns:i,stringColumns:a}}async function to(t,e){const n=document.getElementById("availableLevel"),o=document.getElementById("selectedLevel");n.innerHTML="",o.innerHTML="";const i=new Set(J||[]),a=new Set(V||[]),r=new Set(e),l=new Set(t);let s=[...t.filter(u=>!r.has(u)),...[...i].filter(u=>!l.has(u)&&!r.has(u)),...[...i].filter(u=>r.has(u)&&!l.has(u))],c=[...e.filter(u=>!l.has(u)),...[...a].filter(u=>!r.has(u)&&!l.has(u)),...[...a].filter(u=>l.has(u)&&!r.has(u))];c=c.filter(u=>!s.includes(u)),s=s.filter(u=>!c.includes(u));for(let u of s){let d=Qt(u,"fas fa-file-alt");i.has(u)&&(d.firstChild.checked=!0),n.appendChild(d),d.onclick=function(h){if(h.target.tagName.toLowerCase()!=="input"){const p=this.querySelector("input[type='checkbox']");p.checked=!p.checked;const g=this.innerText;if(p.checked)J.includes(g)||J.push(g);else{const b=J.indexOf(g);b!==-1&&J.splice(b,1)}}h.preventDefault()},d.ondblclick=function(h){let p=this.parentNode.getAttribute("dest");const g=document.getElementById(p);if(this.classList.remove("selectedValue"),g.appendChild(this),h.target.tagName.toLowerCase()!=="input"){const b=this.querySelector("input[type='checkbox']");b.checked=!1}p==="selectedLevel"?(this.onclick=st,this.ondblclick=Ie):p==="availableLevel"&&(this.onclick=ct,this.ondblclick=Ie)}}for(let u of c){let d=Qt(u,"fas fa-file-alt");a.has(u)&&(d.firstChild.checked=!0),o.appendChild(d),d.onclick=function(h){if(h.target.tagName.toLowerCase()!=="input"){const p=this.querySelector("input[type='checkbox']");p.checked=!p.checked;const g=this.innerText;if(p.checked)V.includes(g)||V.push(g),Y.layoutY.includes(g)||Y.layoutY.push(g);else{const b=V.indexOf(g),k=Y.layoutY.indexOf(g);b!==-1&&V.splice(b,1),k!==-1&&Y.layoutY.splice(k,1)}}h.preventDefault()},d.ondblclick=function(h){let p=this.parentNode.getAttribute("dest");const g=document.getElementById(p);if(this.classList.remove("selectedValue"),g.appendChild(this),h.target.tagName.toLowerCase()!=="input"){const b=this.querySelector("input[type='checkbox']");b.checked=!1}p==="selectedLevel"?(this.onclick=st,this.ondblclick=Ie):p==="availableLevel"&&(this.onclick=ct,this.ondblclick=Ie)}}}function st(t){if(t.target.tagName.toLowerCase()!=="input"){const e=this.querySelector("input[type='checkbox']");e.checked=!e.checked;const n=this.innerText.trim();if(e.checked)V.includes(n)||V.push(n),Y.layoutY.includes(n)||Y.layoutY.push(n);else{const o=V.indexOf(n),i=Y.layoutY.indexOf(n);o!==-1&&V.splice(o,1),i!==-1&&Y.layoutY.splice(i,1)}}t.preventDefault()}function ct(t){if(t.target.tagName.toLowerCase()!=="input"){const e=this.querySelector("input[type='checkbox']");e.checked=!e.checked;const n=this.innerText.trim();if(e.checked)J.includes(n)||J.push(n);else{const o=J.indexOf(n);o!==-1&&J.splice(o,1)}}t.preventDefault()}function Ie(t){let e=this.parentNode.getAttribute("dest");const n=document.getElementById(e);if(n){if(this.classList.remove("selectedValue"),n.appendChild(this),t.target.tagName.toLowerCase()!=="input"){const o=this.querySelector("input[type='checkbox']");o&&(o.checked=!1)}e==="selectedLevel"?this.onclick=st:e==="availableLevel"&&(this.onclick=ct),this.ondblclick=Ie,t.preventDefault()}}function no(t,e,n){const o=S("tr"),i=S("td","td-size");i.innerText=t,o.appendChild(i);const a=S("td"),r=S("select","form-control form-select py-1 moduleForm-feild");["sum","min","max","avg","count","group_concat"].forEach(c=>{const u=S("option");u.setAttribute("value",c),u.innerText=c,r.appendChild(u)}),a.appendChild(r),o.appendChild(a);const l=S("td"),s=S("input","form-control form-control-sm");s.type="text",s.value=e,l.appendChild(s),o.appendChild(l),n.appendChild(o)}function oo(){m.create(document.getElementById("layoutY"),{group:"words",animation:150,onSort:wt,onAdd:function(t){var e=0;for(let n of t.target.childNodes)if(n.innerText==t.item.innerText)if(e==0)e=1;else{n.remove();break}for(let n of document.getElementById("layoutX").childNodes)if(n.innerText==t.item.innerText){n.remove();break}}}),m.create(document.getElementById("layoutZ"),{group:"words",animation:150,onSort:wt,onAdd:function(t){if(t.originalEvent.ctrlKey){const n=t.item.cloneNode(!0);t.from.insertBefore(n,t.from.children[t.oldIndex])}var e=0;for(let n of t.target.childNodes)if(n.innerText==t.item.innerText)if(e==0)e=1;else{n.remove();break}}}),m.create(document.getElementById("layoutX"),{group:"words",animation:150,onSort:wt,onAdd:function(t){var e=0;for(let n of t.target.childNodes)if(n.innerText==t.item.innerText)if(e==0)e=1;else{n.remove();break}for(let n of document.getElementById("layoutY").childNodes)if(n.innerText==t.item.innerText){n.remove();break}}}),m.create(document.getElementById("selectedLevel"),{group:"words",animation:150,onAdd:function(t){var e=0;for(let n of t.target.childNodes)if(n.innerText==t.item.innerText)if(e==0)e=1;else{n.remove();break}for(let n of document.getElementById("availableLevel").childNodes)if(n.innerText==t.item.innerText){n.remove();break}}}),m.create(document.getElementById("availableLevel"),{group:"words",animation:150,onAdd:function(t){var e=0;for(let n of t.target.childNodes)if(n.innerText==t.item.innerText)if(e==0)e=1;else{n.remove();break}for(let n of document.getElementById("selectedLevel").childNodes)if(n.innerText==t.item.innerText){const o=n.querySelector("input[type='checkbox']");o.checked&&(o.checked=!1),n.remove();break}}})}function wt(){Y&&(Y.layoutX=St("layoutX"),Y.layoutY=St("layoutY"),Y.layoutZ=St("layoutZ"))}function St(t){const e=document.getElementById(t);return Array.from(e.children).map(n=>n.innerText.trim())}function Wt(t,e,n){if(n!=="addAll"&&n!=="removeAll")return;const o=document.getElementById(t),i=document.getElementById(e);if(!(!o||!i))for(let a of o.querySelectorAll("li")){i.appendChild(a),a.classList.remove("selectedValue");const r=a.querySelector("input[type='checkbox']");r&&(r.checked=!1),a.onclick=e==="selectedLevel"?st:ct,a.ondblclick=Ie}}document.getElementById("deleteQueryBtn").onclick=async function(){const t=sessionStorage.qr_name;if((await H("fetchData",ue,"SELECT Name FROM S_Queries WHERE Name = ?",[t])).length===0){T("Alert!","No query found with the given name.");return}T("Alert!",`Are you sure you want to delete ${t}?`,async function(){await H("deleteData",ue,"DELETE FROM S_Queries WHERE Name = ?",[sessionStorage.qr_name]),T("Success","Query Sheet deleted successfully!");for(let a of document.getElementById("selectQueries-table").childNodes)if(a.innerText==t){a.remove();break}const i=document.getElementById("table_container");i.innerHTML="",sessionStorage.removeItem("qr_name"),document.getElementById("zContent").style.display="none",O={},fn()},1)};document.getElementById("openModalBtn").onclick=async function(t){let e=document.getElementById("selectQueries-table");e.innerHTML="",document.getElementById("searchQuery").value="",document.getElementById("searchQuery").style.display="none";let o=await H("fetchData",ue,"SELECT QueryId, Name FROM S_Queries");if(o.length===0){T("Alert!","No queries found.");return}for(let a of o)e.appendChild(io(a[1],a[0]));e.firstChild&&e.firstChild.click(),new ut(document.getElementById("select-querySheet")).show()};document.getElementById("selectQuery-ok").onclick=async function(){let t=document.getElementById("selectQueries-table").querySelector("tr.selectedValue").innerText;ut.getInstance(document.getElementById("select-querySheet")).hide(),t!==sessionStorage.qr_name&&(sessionStorage.qr_name=t,await rt(),await lt(),await kt());const n=document.querySelector("#ZLayoutContentDiv select");n&&n.addEventListener("change",function(){const o=this.closest(".z_el").getAttribute("level_name");Pt(o)})};function io(t,e="xx"){let n=document.createElement("tr");return n.setAttribute("colname",e),n.appendChild(document.createElement("td")),n.firstChild.classList.add("border-remove"),n.style.userSelect="none",n.style.borderBottom="thin solid #89CFF0",n.firstChild.innerText=t,t==sessionStorage.qr_name&&n.classList.add("selectedValue"),n.onclick=function(o){if(!o.ctrlKey)for(let i of this.parentNode.querySelectorAll("tr.selectedValue"))i.classList.remove("selectedValue");this.classList.add("selectedValue"),o.preventDefault()},n}document.getElementById("search_qr").onclick=function(){let t=document.getElementById("searchQuery");t.style.display=="none"?(t.style.display="",t.focus()):t.style.display="none"};const pn=function(t,e=null){if(e===null){clearTimeout(Gt),Gt=setTimeout(function(){pn(t,"zz")},Jn);return}let n=t.target,o=n.getAttribute("colname"),i="selectQueries-table",a=n.value;if(o)for(let r of document.getElementById(i).querySelectorAll(`tr[colname="${o}"]`))r.firstChild.innerText.toLowerCase().indexOf(a.toLowerCase())>-1?r.style.display="":r.style.display="none";else{let r=0;for(let l of document.getElementById(i).childNodes)l.firstChild.innerText.toLowerCase().indexOf(a.toLowerCase())>-1?(r==0&&(r=1,l.click()),l.style.display=""):l.style.display="none"}};document.getElementById("save_qr").onclick=async function(){let t={};if(t.Name=document.getElementById("queryNm").value,t.tableName=document.getElementById("tableNm").value,t.GraphType=document.getElementById("graphTypeNew").value,t.Name.trim()===""){T("Alert","Please enter query name");return}if(t.tableName===""){T("Alert","Please select a table name");return}document.getElementById("showSummary").checked?t.ShowSummary=1:t.ShowSummary=0,document.getElementById("hideNullRows").checked?t.hide_nullRows=1:t.hide_nullRows=0,t.SelectedLevels=[];for(let l of document.getElementById("selectedLevel").childNodes)l.firstChild.checked&&t.SelectedLevels.push(l.innerText);if(t.SelectedLevels.length==0){T("Alert!","Please select atleast one level");return}t.AvailableLevels=[];for(let l of document.getElementById("availableLevel").childNodes)l.firstChild.checked&&t.AvailableLevels.push(l.innerText);if(t.AvailableLevels.length==0){T("Alert!","Please select atleast one series");return}t.layoutX=[],t.layoutY=[],t.layoutZ=[];for(let l of document.getElementById("layoutX").childNodes)l.textContent.trim()!==""&&t.layoutX.push(l.textContent.trim());if(t.layoutX.length==0){T("Alert!","Please select atleast one level in layout X");return}for(let l of document.getElementById("layoutY").childNodes)l.textContent.trim()!==""&&t.layoutY.push(l.textContent.trim());if(t.layoutY.length==0){T("Alert!","Please select atleast one level in layout Y");return}for(let l of document.getElementById("layoutZ").childNodes)l.textContent.trim()!==""&&t.layoutZ.push(l.textContent.trim());t.Layout={layoutX:t.layoutX,layoutY:t.layoutY,layoutZ:t.layoutZ};const e=document.getElementById("advTable"),n={};for(let l of e.querySelectorAll("tbody tr")){const s=l.querySelectorAll("td"),c=s[0].textContent.trim(),u=s[1].querySelector("select").value,d=s[2].querySelector("input").value.trim();c&&(n[c]={Agg:u,Format:d})}if(t.SeriesProperties=n,Xe!=="edit"&&(await H("fetchData",ue,"SELECT Name FROM S_Queries WHERE Name = ? AND TableName = ?",[t.Name,t.tableName])).length>0){T("Alert!","Query name already exists! Please choose a different name.");return}Xe="";const o=ao();await H("insertData",ue,`INSERT INTO S_Queries (Name, TableName, ShowSummary, HideNullRows, Levels, Series, SeriesProperties, Layout, GraphType) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)
        ON CONFLICT(Name) DO UPDATE SET Name = ?, TableName = ?, ShowSummary = ?, HideNullRows = ?, Levels = ?, Series = ?, SeriesProperties = ?, Layout = ?, GraphType = ?, LastUpdateDate = ?`,[t.Name,t.tableName,t.ShowSummary,t.hide_nullRows,JSON.stringify(t.SelectedLevels),JSON.stringify(t.AvailableLevels),JSON.stringify(t.SeriesProperties),JSON.stringify(t.Layout),t.GraphType,t.Name,t.tableName,t.ShowSummary,t.hide_nullRows,JSON.stringify(t.SelectedLevels),JSON.stringify(t.AvailableLevels),JSON.stringify(t.SeriesProperties),JSON.stringify(t.Layout),t.GraphType,o]),document.getElementById("queryNm").value="",document.getElementById("tableNm").value="",document.getElementById("showSummary").checked=!0,document.getElementById("hideNullRows").checked=!1,sessionStorage.qr_name=t.Name,ut.getInstance(document.getElementById("modal-select-column")).hide(),T("Success","Query saved successfully!"),await rt(),await lt(),await kt();const r=document.querySelector("#ZLayoutContentDiv select");r&&r.addEventListener("change",function(){const l=this.closest(".z_el").getAttribute("level_name");Pt(l)})};function ao(){const t=new Date,e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0"),i=String(t.getHours()).padStart(2,"0"),a=String(t.getMinutes()).padStart(2,"0"),r=String(t.getSeconds()).padStart(2,"0");return`${e}-${n}-${o} ${i}:${a}:${r}`}function Qt(t,e){const n=S("input","inputcheckbox");n.setAttribute("type","checkbox");const o=S("span",e),i=S("label","checkBox-label",null,o),a=S("span","aggrigation-point",null,document.createTextNode(t));i.appendChild(a);const r=S("li",null,null,n);return r.appendChild(i),r}
